import{d as s}from"./app.c4a25f51.js";import{_ as a}from"./plugin-vue_export-helper.21dcd24c.js";const n={},e=s(`<h2 id="\u7B2C1\u7AE0-node\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#\u7B2C1\u7AE0-node\u7B80\u4ECB" aria-hidden="true">#</a> \u7B2C1\u7AE0 Node\u7B80\u4ECB</h2><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJCh6.jpg" alt="gjJCh6.jpg"></p><h3 id="_1-1-node\u7279\u70B9" tabindex="-1"><a class="header-anchor" href="#_1-1-node\u7279\u70B9" aria-hidden="true">#</a> 1.1 node\u7279\u70B9</h3><ul><li><p>\u5F02\u6B65I/O</p></li><li><p>\u4E8B\u4EF6\u4E0E\u56DE\u8C03\u51FD\u6570</p></li><li><p>\u5355\u7EBF\u7A0B \u4E0E\u5176\u4F59\u7EBF\u7A0B\u662F\u65E0\u6CD5\u5171\u4EAB\u4EFB\u4F55\u72B6\u6001\u7684 \u5F31\u70B9\uFF1A</p><ol><li>\u65E0\u6CD5\u5229\u7528\u591A\u6838Cpu\u3002</li><li>\u9519\u8BEF\u4F1A\u5F15\u8D77\u6574\u4E2A\u5E94\u7528\u9000\u51FA\uFF0C\u5E94\u7528\u7684\u5065\u58EE\u6027\u503C\u5F97\u8003\u9A8C\u3002</li><li>\u5927\u91CF\u8BA1\u7B97\u5360\u7528cpu\u5BFC\u81F4\u65E0\u6CD5\u7EE7\u7EED\u8C03\u7528\u5F02\u6B65I/O\u3002</li></ol><p><code>child_process</code>\u89E3\u51B3\u5355\u7EBF\u7A0B\u5927\u8BA1\u7B97\u91CF\u7684\u95EE\u9898\u3002</p></li><li><p>\u8DE8\u5E73\u53F0</p></li></ul><h3 id="_1-2-node\u7684\u5E94\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#_1-2-node\u7684\u5E94\u7528\u573A\u666F" aria-hidden="true">#</a> 1.2 Node\u7684\u5E94\u7528\u573A\u666F</h3><ul><li><p>I/O\u5BC6\u96C6\u578B</p></li><li><p>CPU\u5BC6\u96C6\u578B\u4E1A\u52A1</p></li><li><p>\u4E0E\u9057\u7559\u7CFB\u7EDF\u548C\u5E73\u5171\u5904</p><p>\u53D6\u957F\u8865\u77ED</p></li><li><p>\u5206\u5E03\u5F0F\u5E94\u7528</p></li></ul><h2 id="\u7B2C2\u7AE0-\u6A21\u5757\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#\u7B2C2\u7AE0-\u6A21\u5757\u673A\u5236" aria-hidden="true">#</a> \u7B2C2\u7AE0 \u6A21\u5757\u673A\u5236</h2><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJAje.jpg" alt="gjJAje.jpg"></p><h3 id="_2-1-commonjs\u6A21\u5757\u89C4\u8303" tabindex="-1"><a class="header-anchor" href="#_2-1-commonjs\u6A21\u5757\u89C4\u8303" aria-hidden="true">#</a> 2.1 CommonJS\u6A21\u5757\u89C4\u8303</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">math</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">math</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">function</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#81A1C1;">...</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#8FBCBB;">module</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">xxx</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-2-node\u6A21\u5757\u7684\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#_2-2-node\u6A21\u5757\u7684\u5B9E\u73B0" aria-hidden="true">#</a> 2.2 Node\u6A21\u5757\u7684\u5B9E\u73B0</h3><p>\u5728Node\u4E2D\u5F15\u5165\u6A21\u5757\u7ECF\u53863\u4E2A\u6B65\u9AA4</p><ol><li>\u8DEF\u5F84\u5206\u6790</li><li>\u6587\u4EF6\u5B9A\u4F4D</li><li>\u7F16\u8BD1\u6267\u884C</li></ol><p>\u6A21\u5757\u5206\u4E3A\u4E24\u7C7B\uFF0C\u4E00\u7C7B\u662FNode\u63D0\u4F9B\u7684\u6A21\u5757\uFF0C\u79F0\u4E3A\u6838\u5FC3\u6A21\u5757\uFF1B\u53E6\u4E00\u7C7B\u662F\u7528\u6237\u7F16\u5199\u7684\u6A21\u5757\uFF0C\u79F0\u4E3A\u6587\u4EF6\u6A21\u5757\u3002</p><p>\u6838\u5FC3\u6A21\u5757\u88AB\u76F4\u63A5\u52A0\u8F7D\u8FDB\u5185\u5B58\u4E2D\uFF0C\u6587\u4EF6\u6A21\u5757\u52A0\u8F7D\u901F\u5EA6\u6BD4\u6838\u5FC3\u6A21\u5757\u52A0\u8F7D\u901F\u5EA6\u6162\u3002</p><h4 id="\u4F18\u5148\u4ECE\u7F13\u5B58\u52A0\u8F7D" tabindex="-1"><a class="header-anchor" href="#\u4F18\u5148\u4ECE\u7F13\u5B58\u52A0\u8F7D" aria-hidden="true">#</a> \u4F18\u5148\u4ECE\u7F13\u5B58\u52A0\u8F7D</h4><p>\u6D4F\u89C8\u5668\u4EC5\u7F13\u5B58\u6587\u4EF6\uFF0C\u800CNode\u7F13\u5B58\u7684\u662F\u7F16\u8BD1\u548C\u6267\u884C\u4E4B\u540E\u7684\u5BF9\u8C61\u3002</p><p>\u6838\u5FC3\u6A21\u5757\u7684\u7F13\u5B58\u68C0\u67E5\u5148\u4E8E\u6587\u4EF6\u6A21\u5757\u7684\u7F13\u5B58\u68C0\u67E5\u3002</p><h4 id="\u8DEF\u5F84\u5206\u6790\u548C\u6587\u4EF6\u5B9A\u4F4D" tabindex="-1"><a class="header-anchor" href="#\u8DEF\u5F84\u5206\u6790\u548C\u6587\u4EF6\u5B9A\u4F4D" aria-hidden="true">#</a> \u8DEF\u5F84\u5206\u6790\u548C\u6587\u4EF6\u5B9A\u4F4D</h4><ol><li><p>\u6A21\u5757\u6807\u8BC6\u7B26\u5206\u6790</p><ul><li><p>\u6838\u5FC3\u6A21\u5757\uFF0C\u5982http\u3001fs\u3001path\u7B49\u3002</p><p>\u6838\u5FC3\u6A21\u5757\u7684\u4F18\u5148\u7EA7\u4EC5\u6B21\u4E8E\u7F13\u5B58\u52A0\u8F7D\u3002</p></li><li><p>.\u6216..\u5F00\u59CB\u7684\u76F8\u5BF9\u8DEF\u5F84\u6587\u4EF6\u6A21\u5757\u3002</p><p>require()\u65B9\u6CD5\u4F1A\u5C06\u8DEF\u5F84\u8F6C\u4E3A\u771F\u5B9E\u8DEF\u5F84\uFF0C\u5E76\u4EE5\u771F\u5B9E\u8DEF\u5F84\u4F5C\u4E3A\u7D22\u5F15\u3002</p></li><li><p>\u4EE5/\u5F00\u59CB\u7684\u7EDD\u5BF9\u8DEF\u5F84\u6587\u4EF6\u6A21\u5757\u3002</p></li><li><p>\u975E\u8DEF\u5F84\u5F62\u5F0F\u7684\u6587\u4EF6\u6A21\u5757\u3002</p><p>\u67E5\u627E\u6700\u6162\u6700\u8D39\u65F6\u3002</p></li></ul></li><li><p>\u6587\u4EF6\u5B9A\u4F4D</p><p>\u4ECE\u7F13\u5B58\u52A0\u8F7D\u7684\u4F18\u5316\u7B56\u7565\u4F7F\u5F97\u4E8C\u6B21\u5F15\u5165\u65F6\u4E0D\u9700\u8981\u8DEF\u5F84\u5206\u6790\u3001\u6587\u4EF6\u5B9A\u4F4D\u548C\u7F16\u8BD1\u6267\u884C\u7684\u8FC7\u7A0B\uFF0C\u5927\u5927\u63D0\u9AD8\u4E86\u518D\u6B21\u52A0\u8F7D\u6A21\u5757\u65F6\u7684\u6548\u7387\u3002</p><ul><li><p>\u6587\u4EF6\u62D3\u5C55\u540D\u5206\u6790</p><p>\u5728\u4E0D\u5305\u542B\u6587\u4EF6\u6269\u5C55\u540D\u7684\u60C5\u51B5\u4E0B\uFF0CNode\u4F1A\u6309.js\u3001.json\u3001.node\u7684\u6B21\u5E8F\u8865\u8DB3\u62D3\u5C55\u540D\uFF0C\u4F9D\u6B21\u5C1D\u8BD5\u3002</p><p>\u5728\u5C1D\u8BD5\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u9700\u8981\u8C03\u7528fs\u6A21\u5757\u540C\u6B65\u963B\u585E\u5730\u5224\u65AD\u6587\u4EF6\u662F\u5426\u5B58\u5728\u3002\u5C0F\u8BC0\u7A8D\u662F\uFF1A1.\u5982\u679C\u662F.node\u548C.json\u6587\u4EF6\uFF0C\u5728\u4F20\u9012\u7ED9require()\u7684\u6807\u8BC6\u7B26\u4E2D\u5E26\u4E0A\u62D3\u5C55\u540D\uFF0C\u4F1A\u52A0\u5FEB\u4E00\u70B9\u901F\u5EA6\u30022.\u540C\u6B65\u914D\u5408\u7F13\u5B58\uFF0C\u53EF\u4EE5\u5927\u5E45\u5EA6\u7F13\u89E3Node\u5355\u7EBF\u7A0B\u4E2D\u963B\u585E\u5F0F\u8C03\u7528\u7684\u7F3A\u9677\u3002</p></li><li><p>\u76EE\u5F55\u5206\u6790\u548C\u5305</p><p>\u5982\u679C\u5F15\u5165\u7684\u8DEF\u5F84\u5F97\u5230\u4E00\u4E2A\u76EE\u5F55\uFF0C\u9996\u5148\uFF0CNode\u5728\u5F53\u524D\u76EE\u5F55\u4E0B\u67E5\u627Epackage.json\uFF0C\u901A\u8FC7JSON.parse()\u89E3\u6790\u51FA\u5305\u63CF\u8FF0\u5BF9\u8C61\uFF0C\u4ECE\u4E2D\u53D6\u51FAmain\u5C5E\u6027\u6307\u5B9A\u7684\u6587\u4EF6\u540D\u8FDB\u884C\u5B9A\u4F4D\u3002\u5982\u679C\u6587\u4EF6\u540D\u7F3A\u5C11\u62D3\u5C55\u540D\uFF0C\u5C06\u4F1A\u8FDB\u5165\u62D3\u5C55\u540D\u5206\u6790\u7684\u6B65\u9AA4\u3002</p><p>\u800C\u5982\u679Cmain\u5C5E\u6027\u6307\u5B9A\u7684\u6587\u4EF6\u540D\u9519\u8BEF\uFF0C\u6216\u8005\u538B\u6839\u6CA1\u6709package.json\u6587\u4EF6\uFF0CNode\u4F1A\u5C06index\u5F53\u505A\u9ED8\u8BA4\u6587\u4EF6\u540D\uFF0C\u7136\u540E\u4F9D\u6B21\u67E5\u627Eindex.js\uFF0Cindex.json\uFF0Cindex.node\u3002</p></li></ul></li></ol><h4 id="\u6A21\u5757\u7F16\u8BD1" tabindex="-1"><a class="header-anchor" href="#\u6A21\u5757\u7F16\u8BD1" aria-hidden="true">#</a> \u6A21\u5757\u7F16\u8BD1</h4><p>\u5BF9\u4E8E\u4E0D\u540C\u7684\u6587\u4EF6\u62D3\u5C55\u540D\uFF0C\u5176\u8F7D\u5165\u65B9\u6CD5\u4E5F\u6709\u6240\u4E0D\u540C</p><ul><li><strong>.js\u6587\u4EF6</strong>\u3002\u901A\u8FC7fs\u6A21\u5757<strong>\u540C\u6B65</strong>\u8BFB\u53D6\u6587\u4EF6\u540E\u7F16\u8BD1\u6267\u884C\u3002</li><li><strong>.node\u6587\u4EF6</strong>\u3002\u8FD9\u662F\u7528C/C++\u7F16\u5199\u7684\u6269\u5C55\u6587\u4EF6\uFF0C\u901A\u8FC7dlopen()\u65B9\u6CD5\u52A0\u8F7D\u6700\u540E\u7F16\u8BD1\u751F\u6210\u7684\u6587\u4EF6\u3002</li><li><strong>.json\u6587\u4EF6</strong>\u3002\u901A\u8FC7fs\u6A21\u5757\u540C\u6B65\u8BFB\u53D6\u6587\u4EF6\u540E\uFF0C\u7528JSON.parse()\u89E3\u6790\u8FD4\u56DE\u7ED3\u679C\u3002</li><li>\u5176\u4F59\u6269\u5C55\u540D\u6587\u4EF6\u3002\u4ED6\u4EEC\u90FD\u88AB\u5F53\u505A.js\u6587\u4EF6\u8F7D\u5165\u3002</li></ul><p>\u7F16\u8BD1\u65B9\u5F0F</p><ol><li><p>JavaScript\u6A21\u5757\u7684\u7F16\u8BD1</p><p>\u5728\u7F16\u8BD1\u8FC7\u7A0B\u4E2D\uFF0CNode\u5BF9\u83B7\u53D6\u7684JavaScript\u6587\u4EF6\u5185\u5BB9\u8FDB\u884C\u4E86\u5934\u5C3E\u5305\u88C5\u3002\u5728\u5934\u90E8\u6DFB\u52A0\u4E86(function (exports, require, module, __filename, __dirname){\\n\uFF0C\u5728\u5C3E\u90E8\u6DFB\u52A0\u4E86\\n});</p><p>\u5728\u6267\u884C\u4E4B\u540E\uFF0C\u6A21\u5757\u7684exports\u5C5E\u6027\u88AB\u8FD4\u56DE\u7ED9\u4E86\u8C03\u7528\u65B9\u3002exports\u5C5E\u6027\u4E0A\u7684\u4EFB\u4F55\u65B9\u6CD5\u548C\u5C5E\u6027\u90FD\u53EF\u4EE5\u88AB\u5916\u90E8\u8C03\u7528\u5230\uFF0C\u6A21\u5757\u4E2D\u7684\u5176\u4F59\u53D8\u91CF\u6216\u5C5E\u6027\u5219\u4E0D\u53EF\u76F4\u63A5\u88AB\u8C03\u7528\u3002</p></li><li><p>C/C++\u6A21\u5757\u7684\u7F16\u8BD1</p><p>Node\u8C03\u7528process.dlopen()\u65B9\u6CD5\u8FDB\u884C\u52A0\u8F7D\u548C\u6267\u884C\u3002</p></li><li><p>JSON\u6587\u4EF6\u7684\u7F16\u8BD1</p><p>Node\u5229\u7528fs\u6A21\u5757\u540C\u6B65\u8BFB\u53D6JSON\u6587\u4EF6\u7684\u5185\u5BB9\u4E4B\u540E\uFF0C\u8C03\u7528JSON.parse()\u65B9\u6CD5\u5F97\u5230\u5BF9\u8C61\uFF0C\u7136\u540E\u5C06\u5B83\u8D4B\u7ED9\u6A21\u5757\u5BF9\u8C61\u7684exports\uFF0C\u4EE5\u4F9B\u5916\u90E8\u8C03\u7528\u3002</p></li></ol><h3 id="_2-3-\u6838\u5FC3\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#_2-3-\u6838\u5FC3\u6A21\u5757" aria-hidden="true">#</a> 2.3 \u6838\u5FC3\u6A21\u5757</h3><p>\u6838\u5FC3\u6A21\u5757\u5206\u4E3AC/C++\u7F16\u5199\u548CJavaScript\u7F16\u5199\uFF0CC/C++\u6587\u4EF6\u5B58\u653E\u5728src\u76EE\u5F55\u4E0B\uFF0CJavaScript\u6587\u4EF6\u5B58\u653E\u5728lib\u76EE\u5F55\u4E0B\u3002</p><h4 id="javascript\u6838\u5FC3\u6A21\u5757\u7684\u7F16\u8BD1\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#javascript\u6838\u5FC3\u6A21\u5757\u7684\u7F16\u8BD1\u8FC7\u7A0B" aria-hidden="true">#</a> JavaScript\u6838\u5FC3\u6A21\u5757\u7684\u7F16\u8BD1\u8FC7\u7A0B</h4><ol><li><p>\u8F6C\u5B58\u4E3AC/C++\u4EE3\u7801</p><p>\u5728\u542F\u52A8Node\u8FDB\u7A0B\u65F6\uFF0CJavaScript\u4EE3\u7801\u76F4\u63A5\u52A0\u8F7D\u8FDB\u5185\u5B58\u4E2D\u3002</p></li><li><p>\u7F16\u8BD1JavaScript\u6838\u5FC3\u6A21\u5757</p><p>\u5728\u5F15\u5165JavaScript\u6838\u5FC3\u6A21\u5757\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u4E5F\u7ECF\u5386\u4E86\u5934\u5C3E\u5305\u88C5\u7684\u8FC7\u7A0B\uFF0C\u7136\u540E\u624D\u6267\u884C\u548C\u5BFC\u51FA\u4E86exports\u5BF9\u8C61\u3002</p><p>\u4E0E\u6587\u4EF6\u6A21\u5757\u7684\u533A\u522B\u5728\u4E8E\u83B7\u53D6\u6E90\u4EE3\u7801\u7684\u65B9\u5F0F\uFF08\u6838\u5FC3\u6A21\u5757\u4ECE\u5185\u5B58\u4E2D\u52A0\u8F7D\uFF09\u4EE5\u53CA\u7F13\u5B58\u6267\u884C\u7ED3\u679C\u7684\u4F4D\u7F6E\u3002</p></li></ol><h4 id="c-c-\u6A21\u5757\u7684\u7F16\u8BD1\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#c-c-\u6A21\u5757\u7684\u7F16\u8BD1\u8FC7\u7A0B" aria-hidden="true">#</a> C/C++\u6A21\u5757\u7684\u7F16\u8BD1\u8FC7\u7A0B</h4><p>\u7531\u7EAFC/C++\u7F16\u5199\u7684\u90E8\u5206\u79F0\u4E3A\u5185\u5EFA\u6A21\u5757\uFF0C\u4ED6\u4EEC\u901A\u5E38\u4E0D\u88AB\u7528\u6237\u76F4\u63A5\u8C03\u7528\u3002Node\u7684buffer\u3001crypto\u3001evals\u3001fs\u3001os\u7B49\u6A21\u5757\u90FD\u662F\u90E8\u5206\u901A\u8FC7C/C++\u7F16\u5199\u7684\u3002</p><ol><li><p>\u5185\u5EFA\u6A21\u5757\u7684\u7EC4\u7EC7\u5F62\u5F0F</p><p>node_extensions.h\u6587\u4EF6\u5C06\u6563\u5217\u7684\u5185\u5EFA\u6A21\u5757\u7EDF\u4E00\u653E\u8FDBnode_module_list\u6570\u7EC4\u4E2D\u3002</p><p>\u5185\u5EFA\u6A21\u5757\u7684\u4F18\u52BF\uFF1A\u5B83\u4EEC\u672C\u8EAB\u7531C/C++\u7F16\u5199\uFF0C\u6027\u80FD\u4E0A\u4F18\u4E8E\u811A\u672C\u8BED\u8A00\uFF0C\u5728\u8FDB\u884C\u6587\u4EF6\u7F16\u8BD1\u65F6\uFF0C\u5B83\u4EEC\u88AB\u7F16\u8BD1\u8FDB\u4E8C\u8FDB\u5236\u6587\u4EF6\u3002\u4E00\u65E6Node\u5F00\u59CB\u6267\u884C\uFF0C\u5B83\u4EEC\u88AB\u76F4\u63A5\u52A0\u8F7D\u8FDB\u5185\u5B58\u4E2D\uFF0C\u65E0\u987B\u518D\u6B21\u505A\u6807\u8BC6\u7B26\u5B9A\u4F4D\u3001\u6587\u4EF6\u5B9A\u4F4D\u3001\u7F16\u8BD1\u7B49\u8FC7\u7A0B\uFF0C\u76F4\u63A5\u5C31\u53EF\u6267\u884C\u3002</p></li><li><p>\u5185\u5EFA\u6A21\u5757\u7684\u5BFC\u51FA</p><p>\u6587\u4EF6\u6A21\u5757=\u300B\u6838\u5FC3\u6A21\u5757=\u300B\u5185\u5EFA\u6A21\u5757\uFF0C\u6587\u4EF6\u6A21\u5757\u4F9D\u8D56\u6838\u5FC3\u6A21\u5757\u4F9D\u8D56\u5185\u5EFA\u6A21\u5757\u3002</p><p>Node\u5728\u542F\u52A8\u65F6\uFF0C\u4F1A\u751F\u6210\u4E00\u4E2A\u5168\u5C40\u53D8\u91CFprocess\uFF0C\u5E76\u63D0\u4F9BBinding()\u65B9\u6CD5\u6765\u534F\u52A9\u52A0\u8F7D\u5185\u5EFA\u6A21\u5757\u3002</p></li></ol><h4 id="\u6838\u5FC3\u6A21\u5757\u7684\u5F15\u5165\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u6838\u5FC3\u6A21\u5757\u7684\u5F15\u5165\u6D41\u7A0B" aria-hidden="true">#</a> \u6838\u5FC3\u6A21\u5757\u7684\u5F15\u5165\u6D41\u7A0B</h4><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJVnH.jpg" alt="gjJVnH.jpg"></p><h4 id="\u7F16\u5199\u6838\u5FC3\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#\u7F16\u5199\u6838\u5FC3\u6A21\u5757" aria-hidden="true">#</a> \u7F16\u5199\u6838\u5FC3\u6A21\u5757</h4><p>\u7F16\u5199\u5185\u5EFA\u6A21\u5757\u5206\u4E3A\u4E24\u6B65\uFF0C\u7F16\u5199\u5934\u6587\u4EF6\u548C\u7F16\u5199C/C++\u6587\u4EF6\u3002</p><h3 id="_2-4-c-c-\u62D3\u5C55\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#_2-4-c-c-\u62D3\u5C55\u6A21\u5757" aria-hidden="true">#</a> 2.4 C/C++\u62D3\u5C55\u6A21\u5757</h3><p>C/C++\u62D3\u5C55\u6A21\u5757\u5C5E\u4E8E\u6587\u4EF6\u6A21\u5757\u7684\u4E00\u7C7B\u3002</p><p>C/C++\u6A21\u5757\u901A\u8FC7\u9884\u5148\u7F16\u8BD1\u4E3A.node\u6587\u4EF6\uFF0C\u7136\u540E\u8C03\u7528process.dlopen()\u65B9\u6CD5\u52A0\u8F7D\u6267\u884C\u3002</p><p>\u4E00\u4E2A\u5E73\u53F0\u4E0B\u7684.node\u6587\u4EF6\u5728\u53E6\u4E00\u4E2A\u5E73\u53F0\u4E0B\u662F\u65E0\u6CD5\u52A0\u8F7D\u8FD0\u884C\u7684\uFF0C\u5FC5\u987B\u91CD\u65B0\u7528\u5404\u81EA\u5E73\u53F0\u7684\u7F16\u8BD1\u5668\u7F16\u8BD1\u4E3A\u6B63\u786E\u7684.node\u6587\u4EF6\u3002</p><h4 id="\u524D\u63D0\u6761\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u524D\u63D0\u6761\u4EF6" aria-hidden="true">#</a> \u524D\u63D0\u6761\u4EF6</h4><ul><li><p>GYP\u9879\u76EE\u751F\u6210\u5DE5\u5177\u3002</p><p>node-gyp\uFF0C\u4E3ANode\u63D0\u4F9B\u7684\u4E00\u4E2A\u4E13\u95E8\u7684\u6269\u5C55\u6784\u5EFA\u5DE5\u5177\u3002</p></li><li><p>V8\u5F15\u64CEC++\u5E93\u3002</p></li><li><p>libuv\u5E93\u3002</p><p>\u8FD9\u4E2A\u5E93\u662F\u8DE8\u5E73\u53F0\u7684\u4E00\u5C42\u5C01\u88C5\u3002libuv\u5C01\u88C5\u7684\u529F\u80FD\u5305\u62EC\u4E8B\u4EF6\u5FAA\u73AF\u3001\u6587\u4EF6\u64CD\u4F5C\u7B49\u3002</p></li><li><p>Node\u5185\u90E8\u5E93\u3002</p></li><li><p>\u5176\u4ED6\u5E93\u3002</p></li></ul><h4 id="c-c-\u6269\u5C55\u6A21\u5757\u7684\u7F16\u5199" tabindex="-1"><a class="header-anchor" href="#c-c-\u6269\u5C55\u6A21\u5757\u7684\u7F16\u5199" aria-hidden="true">#</a> C/C++\u6269\u5C55\u6A21\u5757\u7684\u7F16\u5199</h4><p>\u666E\u901A\u7684\u6269\u5C55\u6A21\u5757\u4E0E\u5185\u5EFA\u6A21\u5757\u7684\u533A\u522B\u5728\u4E8E\u65E0\u987B\u5C06\u6E90\u4EE3\u7801\u7F16\u8BD1\u8FDBNode\uFF0C\u800C\u662F\u901A\u8FC7dlopen()\u65B9\u6CD5\u52A8\u6001\u52A0\u8F7D\u3002</p><h4 id="c-c-\u6269\u5C55\u6A21\u5757\u7684\u7F16\u8BD1" tabindex="-1"><a class="header-anchor" href="#c-c-\u6269\u5C55\u6A21\u5757\u7684\u7F16\u8BD1" aria-hidden="true">#</a> C/C++\u6269\u5C55\u6A21\u5757\u7684\u7F16\u8BD1</h4><p>\u901A\u8FC7\u8F93\u5165node-gyp build\u8FDB\u884C\u7F16\u8BD1\u3002</p><h4 id="c-c-\u6269\u5C55\u6A21\u5757\u7684\u52A0\u8F7D" tabindex="-1"><a class="header-anchor" href="#c-c-\u6269\u5C55\u6A21\u5757\u7684\u52A0\u8F7D" aria-hidden="true">#</a> C/C++\u6269\u5C55\u6A21\u5757\u7684\u52A0\u8F7D</h4><p>require(&#39;./xx.node&#39;)\u6267\u884C\uFF0C.node\u6269\u5C55\u540D\u7684\u6587\u4EF6\u4F1A\u8C03\u7528process.dlopen()\u65B9\u6CD5\u53BB\u52A0\u8F7D\u6587\u4EF6\u3002</p><p>\u52A0\u8F7D.node\u6587\u4EF6\u5B9E\u9645\u4E0A\u7ECF\u5386\u4E86\u4E24\u4E2A\u6B65\u9AA4\uFF0C\u7B2C\u4E00\u4E2A\u6B65\u9AA4\u662F\u8C03\u7528uv_dlopen()\u6587\u4EF6\u53BB\u6253\u5F00\u52A8\u6001\u94FE\u63A5\u5E93\uFF0C\u7B2C\u4E8C\u4E2A\u6B65\u9AA4\u662F\u8C03\u7528uv_dlsym()\u65B9\u6CD5\u627E\u5230\u52A8\u6001\u94FE\u63A5\u5E93\u4E2D\u901A\u8FC7NODE_MODULE\u5B8F\u5B9A\u4E49\u7684\u65B9\u6CD5\u4F4E\u503C\u3002</p><p>C/C++\u6269\u5C55\u6A21\u5757\u4E0EJavaScript\u6A21\u5757\u7684\u533A\u522B\u5728\u4E8E\u52A0\u8F7D\u4E4B\u540E\u4E0D\u9700\u8981\u7F16\u8BD1\u3002</p><h3 id="_2-5-\u6A21\u5757\u8C03\u7528\u6808" tabindex="-1"><a class="header-anchor" href="#_2-5-\u6A21\u5757\u8C03\u7528\u6808" aria-hidden="true">#</a> 2.5 \u6A21\u5757\u8C03\u7528\u6808</h3><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/2Ckxun.jpg" alt="2Ckxun.jpg"></p><p>C/C++\u5185\u5EFA\u6A21\u5757\u5C5E\u4E8E\u6700\u5E95\u5C42\u7684\u6A21\u5757\uFF0C\u5B83\u5C5E\u4E8E\u6838\u5FC3\u6A21\u5757\uFF0C\u4E3B\u8981\u63D0\u4F9BAPI\u7ED9JavaScript\u6838\u5FC3\u6A21\u5757\u548C\u7B2C\u4E09\u65B9JavaScript\u6587\u4EF6\u6A21\u5757\u8C03\u7528\u3002</p><p>\u5982\u679C\u4E0D\u662F\u975E\u5E38\u4E86\u89E3C/C++\u5185\u5EFA\u6A21\u5757\uFF0C\u5C3D\u91CF\u907F\u514D\u901A\u8FC7process.binding()\u8C03\u7528\u3002</p><p>JavaScript\u6838\u5FC3\u6A21\u5757\u4F5C\u4E3AC/C++\u5185\u5EFA\u6A21\u5757\u7684\u5C01\u88C5\u5C42\u548C\u6865\u63A5\u5C42\uFF0C\u4F9B\u6587\u4EF6\u6A21\u5757\u8C03\u7528\uFF0C\u4E5F\u662F\u7EAF\u7CB9\u7684\u529F\u80FD\u6A21\u5757\uFF0C\u5B83\u4E0D\u9700\u8981\u8DDF\u5E95\u5C42\u6253\u4EA4\u9053\uFF0C\u4F46\u53C8\u5341\u5206\u91CD\u8981\u3002</p><h3 id="_2-6-\u5305\u4E0Enpm" tabindex="-1"><a class="header-anchor" href="#_2-6-\u5305\u4E0Enpm" aria-hidden="true">#</a> 2.6 \u5305\u4E0ENPM</h3><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJeHA.jpg" alt="gjJeHA.jpg"></p><p>CommonJS\u7684\u5305\u89C4\u8303\u7684\u5B9A\u4E49\u5176\u5B9E\u4E5F\u5341\u5206\u7B80\u5355\uFF0C\u5B83\u7531\u5305\u7ED3\u6784\u548C\u5305\u63CF\u8FF0\u6587\u4EF6\u4E24\u4E2A\u90E8\u5206\u7EC4\u6210\uFF0C\u524D\u8005\u7528\u4E8E\u7EC4\u7EC7\u5305\u4E2D\u7684\u5404\u79CD\u6587\u4EF6\uFF0C\u540E\u8005\u5219\u7528\u4E8E\u63CF\u8FF0\u5305\u7684\u76F8\u5173\u4FE1\u606F\uFF0C\u4EE5\u4F9B\u5916\u90E8\u8BFB\u53D6\u5206\u6790\u3002</p><h4 id="\u5305\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u5305\u7ED3\u6784" aria-hidden="true">#</a> \u5305\u7ED3\u6784</h4><p>\u5305\u5B9E\u9645\u4E0A\u662F\u4E00\u4E2A\u5B58\u6863\u6587\u4EF6\uFF0C\u5373\u4E00\u4E2A\u76EE\u5F55\u76F4\u63A5\u6253\u5305\u4E3A.zip\u6216tag.gz\u683C\u5F0F\u7684\u6587\u4EF6\u3002</p><p>\u5B8C\u5168\u7B26\u5408CommonJS\u89C4\u8303\u7684\u5305\u76EE\u5F55\u5305\u542B\u5982\u4E0B\u6587\u4EF6\uFF1A</p><ul><li>package.json\uFF1A\u5305\u63CF\u8FF0\u6587\u4EF6\u3002</li><li>bin\uFF1A\u7528\u4E8E\u5B58\u653E\u53EF\u6267\u884C\u4E8C\u8FDB\u5236\u6587\u4EF6\u7684\u76EE\u5F55\u3002</li><li>lib\uFF1A\u7528\u4E8E\u5B58\u653EJavaScript\u4EE3\u7801\u7684\u76EE\u5F55\u3002</li><li>doc\uFF1A\u7528\u4E8E\u5B58\u653E\u6587\u6863\u7684\u76EE\u5F55\u3002</li><li>test\uFF1A\u7528\u4E8E\u5B58\u653E\u5355\u5143\u6D4B\u8BD5\u7528\u4F8B\u7684\u4EE3\u7801\u3002</li></ul><h4 id="\u5305\u63CF\u8FF0\u6587\u4EF6\u4E0Enpm" tabindex="-1"><a class="header-anchor" href="#\u5305\u63CF\u8FF0\u6587\u4EF6\u4E0Enpm" aria-hidden="true">#</a> \u5305\u63CF\u8FF0\u6587\u4EF6\u4E0ENPM</h4><p>CommonJS\u4E3A<strong>package.json</strong>\u6587\u4EF6\u5B9A\u4E49\u4E86\u5982\u4E0B\u4E00\u4E9B\u5FC5\u9700\u7684\u5B57\u6BB5\u3002</p><ul><li>name\u3002\u5305\u540D\u3002</li><li>description\u3002\u5305\u7B80\u4ECB\u3002</li><li>version\u3002\u7248\u672C\u53F7\u3002\u901A\u5E38\u4E3Amajor.minor.revision\u683C\u5F0F\u3002</li><li>keywords\u3002\u5173\u952E\u8BCD\u6570\u7EC4\uFF0CNPM\u4E2D\u4E3B\u8981\u7528\u6765\u505A\u5206\u7C7B\u641C\u7D22\u3002</li><li>maintainers\u3002\u5305\u7EF4\u62A4\u8005\u5217\u8868\u3002</li><li>contributors\u3002\u8D21\u732E\u503C\u5217\u8868\u3002</li><li>bugs\u3002\u4E00\u4E2A\u53EF\u4EE5\u53CD\u9988bug\u7684\u7F51\u9875\u5730\u5740\u6216\u90AE\u4EF6\u5730\u5740\u3002</li><li>licenses\u3002\u5F53\u524D\u5305\u6240\u4F7F\u7528\u7684\u8BB8\u53EF\u8BC1\u5217\u8868\uFF0C\u8868\u793A\u8FD9\u4E2A\u5305\u53EF\u4EE5\u5728\u54EA\u4E9B\u8BB8\u53EF\u8BC1\u4E0B\u4F7F\u7528\u3002</li><li>repositories\u3002\u6258\u7BA1\u6E90\u4EE3\u7801\u7684\u4F4D\u7F6E\u5217\u8868\uFF0C\u8868\u660E\u53EF\u4EE5\u901A\u8FC7\u54EA\u4E9B\u65B9\u5F0F\u548C\u5730\u5740\u8BBF\u95EE\u5305\u7684\u6E90\u7801\u3002</li><li>dependencies\u3002\u4F7F\u7528\u5F53\u524D\u5305\u6240\u9700\u8981\u4F9D\u8D56\u7684\u5305\u5217\u8868\u3002</li></ul><p>\u53EF\u9009\u5B57\u6BB5\uFF1A</p><ul><li>homepage\u3002\u5F53\u524D\u5305\u7684\u7F51\u7AD9\u5730\u5740\u3002</li><li>os\u3002\u64CD\u4F5C\u7CFB\u7EDF\u652F\u6301\u5217\u8868\u3002</li><li>cpu\u3002CPU\u67B6\u6784\u7684\u652F\u6301\u5217\u8868\u3002</li><li>engines\u3002\u652F\u6301\u7684JavaScript\u5F15\u64CE\u5217\u8868\u3002</li><li>builtin\u3002\u6807\u5FD7\u5F53\u524D\u5305\u662F\u5426\u662F\u5185\u5EFA\u5728\u5E95\u5C42\u7CFB\u7EDF\u7684\u6807\u51C6\u7EC4\u4EF6\u3002</li><li>directories\u3002\u5305\u76EE\u5F55\u8BF4\u660E\u3002</li><li>implements\u3002\u5B9E\u73B0\u89C4\u8303\u7684\u5217\u8868\u3002\u6807\u5FD7\u5F53\u524D\u5305\u5B9E\u73B0\u4E86CommonJS\u7684\u54EA\u4E9B\u89C4\u8303</li><li>scripts\u3002\u811A\u672C\u8BF4\u660E\u5BF9\u8C61\u3002</li></ul><p>\u5728\u5305\u63CF\u8FF0\u6587\u4EF6\u7684\u89C4\u8303\u4E2D\uFF0CNPM\u5B9E\u9645\u9700\u8981\u7684\u5B57\u6BB5\u4E3B\u8981\u6709name\u3001version\u3001description\u3001keywords\u3001repositories\u3001author\u3001bin\u3001main\u3001scripts\u3001engines\u3001dependencies\u3001devDependencies\u3002</p><ul><li>author\u3002\u5305\u4F5C\u8005\u3002</li><li>bin\u3002\u4E00\u4E9B\u5305\u4F5C\u8005\u5E0C\u671B\u5305\u53EF\u4EE5\u4F5C\u4E3A\u547D\u4EE4\u884C\u5DE5\u5177\u4F7F\u7528\u3002</li><li>main\u3002\u6A21\u5757\u5F15\u5165\u65B9\u6CD5require()\u5728\u5F15\u5165\u5305\u65F6\uFF0C\u4F1A\u4F18\u5148\u68C0\u67E5\u8FD9\u4E2A\u5B57\u6BB5\uFF0C\u5E76\u5C06\u5176\u4F5C\u4E3A\u5305\u4E2D\u5176\u4F59\u6A21\u5757\u7684\u5165\u53E3\u3002</li><li>devDependencies\u3002\u4E00\u4E9B\u6A21\u5757\u53EA\u5728\u5F00\u53D1\u65F6\u9700\u8981\u4F9D\u8D56\u3002</li></ul><h4 id="npm\u5E38\u7528\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#npm\u5E38\u7528\u529F\u80FD" aria-hidden="true">#</a> NPM\u5E38\u7528\u529F\u80FD</h4><ol><li><p>\u67E5\u770B\u5E2E\u52A9</p><p>npm help &lt;common&gt;</p></li><li><p>\u5B89\u88C5\u4F9D\u8D56\u5305</p><p>\u6267\u884Cnpm install xxx\uFF0CNPM\u4F1A\u5728\u5F53\u524D\u76EE\u5F55\u4E0B\u521B\u5EFAnode_modules\u76EE\u5F55\uFF0C\u7136\u540E\u5728\u8BE5\u76EE\u5F55\u4E0B\u521B\u5EFAxxx\u76EE\u5F55\uFF0C\u63A5\u7740\u5C06\u5305\u89E3\u538B\u5230\u8FD9\u4E2A\u76EE\u5F55\u4E0B\u3002</p><ul><li><p>\u5168\u5C40\u6A21\u5F0F\u5B89\u88C5</p><p>npm install -g xxx\u4F1A\u5C06\u5305\u5B89\u88C5\u7684node\u76EE\u5F55/lib/node_modules\u76EE\u5F55\u4E0B\u3002</p></li><li><p>\u4ECE\u672C\u5730\u5B89\u88C5</p><p>\u672C\u5730\u5B89\u88C5\u53EA\u9700\u4E3ANPM\u6307\u660Epackage.json\u6587\u4EF6\u6240\u5728\u7684\u4F4D\u7F6E\u5373\u53EF\uFF0C\u5B83\u53EF\u4EE5\u662F\u4E00\u4E2A\u5305\u542Bpackage.json\u7684\u5B58\u6863\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u662F\u4E00\u4E2AURL\u5730\u5740\uFF0C\u4E5F\u53EF\u4EE5\u662F\u4E00\u4E2A\u76EE\u5F55\u4E0B\u6709package.json\u6587\u4EF6\u7684\u76EE\u5F55\u4F4D\u7F6E\u3002</p></li><li><p>\u4ECE\u975E\u5B98\u65B9\u6E90\u5B89\u88C5</p></li></ul></li><li><p>NPM\u94A9\u5B50\u547D\u4EE4</p><p>scripts\u5B57\u6BB5\u8BA9\u5305\u5728\u5B89\u88C5\u6216\u8005\u5378\u8F7D\u7B49\u8FC7\u7A0B\u4E2D\u63D0\u4F9B\u94A9\u5B50\u673A\u5236\u3002</p></li><li><p>\u53D1\u5E03\u5305</p><ul><li><p>\u7F16\u5199\u6A21\u5757</p></li><li><p>\u521D\u59CB\u5316\u5305\u63CF\u8FF0\u6587\u4EF6</p></li><li><p>\u6CE8\u518C\u5305\u4ED3\u5E93\u8D26\u53F7</p><p>npm adduser</p></li><li><p>\u4E0A\u4F20\u5305</p><p>npm publish &lt;folder&gt;</p></li><li><p>\u5B89\u88C5\u5305</p></li><li><p>\u7BA1\u7406\u5305\u6743\u9650</p><p>npm ower \u7BA1\u7406\u5305\u7684\u6240\u6709\u8005</p></li><li><p>\u5206\u6790\u5305</p><p>npm ls\u5206\u6790\u5305</p></li></ul></li></ol><h4 id="\u5C40\u90E8npm" tabindex="-1"><a class="header-anchor" href="#\u5C40\u90E8npm" aria-hidden="true">#</a> \u5C40\u90E8NPM</h4><p>\u642D\u5EFA\u81EA\u5DF1\u7684NPM\u4ED3\u5E93\uFF0C\u53C2\u8003\u9644\u5F55D</p><h4 id="npm\u6F5C\u5728\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#npm\u6F5C\u5728\u95EE\u9898" aria-hidden="true">#</a> NPM\u6F5C\u5728\u95EE\u9898</h4><p>\u5305\u8D28\u91CF\u826F\u83A0\u4E0D\u9F50\u3002\u5B89\u5168\u95EE\u9898\u3002</p><p>\u7B26\u5408Kwalitee\u7684\u6A21\u5757\u8981\u6EE1\u8DB3\u7684\u6761\u4EF6\uFF1A</p><ul><li>\u5177\u5907\u826F\u597D\u7684\u6D4B\u8BD5\u3002</li><li>\u5177\u5907\u826F\u597D\u7684\u6587\u6863\uFF08README\u3001API\uFF09</li><li>\u5177\u5907\u826F\u597D\u7684\u6D4B\u8BD5\u8986\u76D6\u7387\u3002</li><li>\u5177\u5907\u826F\u597D\u7684\u7F16\u7801\u89C4\u8303\u3002</li><li>\u66F4\u591A\u6761\u4EF6\u3002</li></ul><h3 id="_2-7-\u524D\u540E\u7AEF\u5171\u7528\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#_2-7-\u524D\u540E\u7AEF\u5171\u7528\u6A21\u5757" aria-hidden="true">#</a> 2.7 \u524D\u540E\u7AEF\u5171\u7528\u6A21\u5757</h3><p>\u524D\u540E\u7AEF\u7684\u73AF\u5883\u7565\u6709\u5DEE\u522B\u3002</p><h4 id="\u6A21\u5757\u7684\u4FA7\u91CD\u70B9" tabindex="-1"><a class="header-anchor" href="#\u6A21\u5757\u7684\u4FA7\u91CD\u70B9" aria-hidden="true">#</a> \u6A21\u5757\u7684\u4FA7\u91CD\u70B9</h4><p>\u6D4F\u89C8\u5668\u7AEFJavaScript\uFF1A\u9700\u8981\u7ECF\u5386\u4ECE\u540C\u4E00\u4E2A\u670D\u52A1\u5668\u7AEF\u5206\u53D1\u5230\u591A\u4E2A\u5BA2\u6237\u7AEF\u6267\u884C\u3002\u74F6\u9888\u5728\u4E8E\u5E26\u5BBD\u3002\u9700\u8981\u901A\u8FC7\u7F51\u7EDC\u52A0\u8F7D\u4EE3\u7801\u3002</p><p>\u670D\u52A1\u5668\u7AEFJavaScript\uFF1A\u76F8\u540C\u7684\u4EE3\u7801\u9700\u8981\u591A\u6B21\u6267\u884C\u3002\u74F6\u9888\u5728\u4E8ECPU\u548C\u5185\u5B58\u7B49\u8D44\u6E90\u3002\u4ECE\u78C1\u76D8\u4E2D\u52A0\u8F7D\uFF0C\u4E24\u8005\u7684\u52A0\u8F7D\u901F\u5EA6\u4E0D\u5728\u4E00\u4E2A\u6570\u91CF\u7EA7\u4E0A\u3002</p><h4 id="amd\u89C4\u8303" tabindex="-1"><a class="header-anchor" href="#amd\u89C4\u8303" aria-hidden="true">#</a> AMD\u89C4\u8303</h4><p>AMD\u89C4\u8303\u662FCommonJS\u6A21\u5757\u89C4\u8303\u7684\u4E00\u4E2A\u5EF6\u4F38\u3002\u5B83\u662F\u5F02\u6B65\u52A0\u8F7D\u6A21\u5757\u3002</p><h4 id="cmd\u89C4\u8303" tabindex="-1"><a class="header-anchor" href="#cmd\u89C4\u8303" aria-hidden="true">#</a> CMD\u89C4\u8303</h4><p>\u7531\u56FD\u5185\u7684\u7389\u4F2F\u63D0\u51FA\u3002\u4E0EAMD\u89C4\u8303\u7684\u533A\u522B\u5728\u4E8E\u5B9A\u4E49\u6A21\u5757\u548C\u4F9D\u8D56\u5F15\u5165\u7684\u90E8\u5206\u3002</p><h4 id="\u517C\u5BB9\u591A\u79CD\u6A21\u5757\u89C4\u8303" tabindex="-1"><a class="header-anchor" href="#\u517C\u5BB9\u591A\u79CD\u6A21\u5757\u89C4\u8303" aria-hidden="true">#</a> \u517C\u5BB9\u591A\u79CD\u6A21\u5757\u89C4\u8303</h4><p>\u7C7B\u5E93\u5F00\u53D1\u8005\u9700\u8981\u5C06\u7C7B\u5E93\u4EE3\u7801\u5305\u88C5\u5728\u4E00\u4E2A\u95ED\u5305\u5185\u3002</p><h2 id="\u7B2C3\u7AE0-\u5F02\u6B65i-o" tabindex="-1"><a class="header-anchor" href="#\u7B2C3\u7AE0-\u5F02\u6B65i-o" aria-hidden="true">#</a> \u7B2C3\u7AE0 \u5F02\u6B65I/O</h2><p>Node\u662F\u9996\u4E2A\u5C06\u5F02\u6B65\u4F5C\u4E3A\u4E3B\u8981\u7F16\u7A0B\u65B9\u5F0F\u548C\u8BBE\u8BA1\u7406\u5FF5\u3002</p><p>Node\u65E2\u53EF\u4EE5\u4F5C\u4E3A\u670D\u52A1\u5668\u7AEF\u53BB\u5904\u7406\u5BA2\u6237\u7AEF\u5E26\u6765\u7684\u5927\u91CF\u5E76\u53D1\u8BF7\u6C42\uFF0C\u4E5F\u80FD\u4F5C\u4E3A\u5BA2\u6237\u7AEF\u5411\u7F51\u7EDC\u4E2D\u7684\u5404\u4E2A\u5E94\u7528\u8FDB\u884C\u5E76\u53D1\u8BF7\u6C42\u3002</p><h3 id="_3-1-\u4E3A\u4EC0\u4E48\u8981\u5F02\u6B65i-o" tabindex="-1"><a class="header-anchor" href="#_3-1-\u4E3A\u4EC0\u4E48\u8981\u5F02\u6B65i-o" aria-hidden="true">#</a> 3.1 \u4E3A\u4EC0\u4E48\u8981\u5F02\u6B65I/O</h3><h4 id="\u7528\u6237\u4F53\u9A8C" tabindex="-1"><a class="header-anchor" href="#\u7528\u6237\u4F53\u9A8C" aria-hidden="true">#</a> \u7528\u6237\u4F53\u9A8C</h4><p>\u91C7\u7528\u5F02\u6B65\u8BF7\u6C42\uFF0C\u5728\u4E0B\u8F7D\u8D44\u6E90\u671F\u95F4\uFF0CJavaScript\u548CUI\u7684\u6267\u884C\u90FD\u4E0D\u4F1A\u5904\u4E8E\u7B49\u5F85\u72B6\u6001\uFF0C\u53EF\u4EE5\u7EE7\u7EED\u54CD\u5E94\u7528\u6237\u7684\u4EA4\u4E92\u884C\u4E3A\uFF0C\u7ED9\u7528\u6237\u4E00\u4E2A\u9C9C\u6D3B\u7684\u9875\u9762\u3002</p><p>\u53EA\u6709\u540E\u7AEF\u80FD\u591F\u5FEB\u901F\u54CD\u5E94\u8D44\u6E90\uFF0C\u624D\u80FD\u8BA9\u524D\u7AEF\u7684\u4F53\u9A8C\u53D8\u597D\u3002</p><h4 id="\u8D44\u6E90\u5206\u914D" tabindex="-1"><a class="header-anchor" href="#\u8D44\u6E90\u5206\u914D" aria-hidden="true">#</a> \u8D44\u6E90\u5206\u914D</h4><p>\u591A\u7EBF\u7A0B\u7F16\u7A0B\u7ECF\u5E38\u9762\u4E34\u9501\u3001\u72B6\u6001\u540C\u6B65\u7B49\u95EE\u9898\uFF0C\u4F46\u662F\u591A\u7EBF\u7A0B\u5728\u591A\u6838CPU\u4E0A\u80FD\u591F\u6709\u6548\u63D0\u5347CPU\u7684\u5229\u7528\u7387\u3002</p><p>\u5355\u7EBF\u7A0B\u540C\u6B65\u7F16\u7A0B\u6A21\u578B\u4F1A\u56E0\u963B\u585EI/O\u5BFC\u81F4\u786C\u4EF6\u8D44\u6E90\u5F97\u4E0D\u5230\u66F4\u4F18\u7684\u4F7F\u7528\u3002</p><p>Node\u7684\u4F18\u70B9\u662F\u5229\u7528\u5355\u7EBF\u7A0B\uFF0C\u8FDC\u79BB\u591A\u7EBF\u7A0B\u6B7B\u9501\u3001\u72B6\u6001\u540C\u6B65\u7B49\u95EE\u9898\uFF1B\u5229\u7528\u5F02\u6B65I/O\uFF0C\u8BA9\u5355\u7EBF\u7A0B\u4E0A\u5C06\u8D44\u6E90\u5206\u914D\u5F97\u66F4\u9AD8\u6548\u3002</p><p>Node\u63D0\u4F9B\u4E86\u7C7B\u4F3C\u524D\u7AEF\u6D4F\u89C8\u5668\u4E2DWeb Workers\u7684\u5B50\u8FDB\u7A0B\uFF0C\u8BE5\u5B50\u8FDB\u7A0B\u53EF\u4EE5\u901A\u8FC7\u5DE5\u4F5C\u8FDB\u7A0B\u9AD8\u6548\u5730\u5229\u7528CPU\u548CI/O\u3002</p><h3 id="_3-2-\u5F02\u6B65i-o\u5B9E\u73B0\u73B0\u72B6" tabindex="-1"><a class="header-anchor" href="#_3-2-\u5F02\u6B65i-o\u5B9E\u73B0\u73B0\u72B6" aria-hidden="true">#</a> 3.2 \u5F02\u6B65I/O\u5B9E\u73B0\u73B0\u72B6</h3><h4 id="\u5F02\u6B65i-o\u4E0E\u975E\u963B\u585Ei-o" tabindex="-1"><a class="header-anchor" href="#\u5F02\u6B65i-o\u4E0E\u975E\u963B\u585Ei-o" aria-hidden="true">#</a> \u5F02\u6B65I/O\u4E0E\u975E\u963B\u585EI/O</h4><p>\u64CD\u4F5C\u7CFB\u7EDF\u5185\u6838\u5BF9\u4E8EI/O\u53EA\u6709\u4E24\u79CD\u65B9\u5F0F\uFF1A\u963B\u585E\u4E0E\u975E\u963B\u585E\u3002</p><p>\u963B\u585EI/O\u7684\u4E00\u4E2A\u7279\u70B9\u662F\u8C03\u7528\u4E4B\u540E\u4E00\u5B9A\u8981\u7B49\u5230\u7CFB\u7EDF\u5185\u6838\u5C42\u9762\u5B8C\u6210\u6240\u6709\u64CD\u4F5C\u540E\uFF0C\u8C03\u7528\u624D\u7ED3\u675F\u3002</p><p>\u975E\u963B\u585EI/O\u8DDF\u963B\u585EI/O\u5730\u5DEE\u522B\u4E3A\u8C03\u7528\u4E4B\u540E\u4F1A\u7ACB\u5373\u8FD4\u56DE\u3002</p><p>\u91CD\u590D\u8C03\u7528\u5224\u65AD\u64CD\u4F5C\u662F\u5426\u5B8C\u6210\u7684\u6280\u672F\u53EB\u505A\u8F6E\u8BE2\u3002</p><p>\u73B0\u5B58\u7684\u8F6E\u8BE2\u6280\u672F\u6709\u4EE5\u4E0B\uFF1A</p><ul><li>read\u3002\u5B83\u662F\u6700\u539F\u59CB\u3001\u6027\u80FD\u6700\u4F4E\u7684\u4E00\u79CD\uFF0C\u901A\u8FC7\u91CD\u590D\u8C03\u7528\u6765\u68C0\u67E5I/O\u7684\u72B6\u6001\u6765\u5B8C\u6210\u5B8C\u6574\u6570\u636E\u7684\u8BFB\u53D6\u3002</li><li>select\u3002\u901A\u8FC7\u5BF9\u6587\u4EF6\u63CF\u8FF0\u7B26\u4E0A\u7684\u4E8B\u4EF6\u72B6\u6001\u6765\u8FDB\u884C\u5224\u65AD\uFF0C\u6700\u591A\u53EF\u4EE5\u540C\u65F6\u68C0\u67E51024\u4E2A\u6587\u4EF6\u63CF\u8FF0\u7B26\u3002</li><li>poll\u3002\u91C7\u7528\u94FE\u8868\u7684\u65B9\u5F0F\u907F\u514D\u6570\u7EC4\u957F\u5EA6\u7684\u9650\u5236\uFF0C\u80FD\u907F\u514D\u4E0D\u9700\u8981\u7684\u68C0\u67E5\uFF0C\u4F46\u5F53\u6587\u4EF6\u63CF\u8FF0\u7B26\u8F83\u591A\u7684\u65F6\u5019\uFF0C\u5B83\u7684\u6027\u80FD\u8FD8\u662F\u5341\u5206\u4F4E\u4E0B\u7684\u3002</li><li>epoll\u3002\u5728Linux\u4E0B\u6548\u7387\u6700\u9AD8\u7684I/O\u4E8B\u4EF6\u901A\u77E5\u673A\u5236\uFF0C\u5229\u7528\u4E8B\u4EF6\u901A\u77E5\u3001\u6267\u884C\u56DE\u8C03\u7684\u65B9\u5F0F\uFF0C\u800C\u4E0D\u662F\u904D\u5386\u67E5\u8BE2\uFF0C\u6240\u4EE5\u4E0D\u4F1A\u6D6A\u8D39CPU\uFF0C\u6267\u884C\u6548\u7387\u9AD8\u3002</li><li>kqueue\u3002\u5B9E\u73B0\u65B9\u5F0F\u4E0Eepoll\u7C7B\u4F3C\uFF0C\u4E0D\u8FC7\u5B83\u4EC5\u5728FreeBSD\u7CFB\u7EDF\u4E0B\u5B58\u5728\u3002</li></ul><p>\u8F6E\u8BE2\u6280\u672F\u6EE1\u8DB3\u4E86\u975E\u963B\u585EI/O\u786E\u4FDD\u83B7\u53D6\u5B8C\u6574\u6570\u636E\u7684\u9700\u6C42\u3002</p><h4 id="\u7406\u60F3\u7684\u975E\u963B\u585E\u5F02\u6B65i-o" tabindex="-1"><a class="header-anchor" href="#\u7406\u60F3\u7684\u975E\u963B\u585E\u5F02\u6B65i-o" aria-hidden="true">#</a> \u7406\u60F3\u7684\u975E\u963B\u585E\u5F02\u6B65I/O</h4><p>\u5B8C\u7F8E\u7684\u5F02\u6B65I/O\u662F\u5E94\u7528\u7A0B\u5E8F\u53D1\u8D77\u975E\u963B\u585E\u8C03\u7528\uFF0C\u65E0\u987B\u901A\u8FC7\u904D\u5386\u6216\u8005\u4E8B\u4EF6\u5524\u9192\u7B49\u65B9\u5F0F\u8F6E\u8BE2\uFF0C\u76F4\u63A5\u5904\u7406\u4E0B\u4E00\u4E2A\u4EFB\u52A1\uFF0C\u7B49I/O\u5B8C\u6210\u540E\u901A\u8FC7\u4FE1\u53F7\u6216\u56DE\u8C03\u5C06\u6570\u636E\u4F20\u9012\u7ED9\u5E94\u7528\u7A0B\u5E8F\u5373\u53EF\u3002</p><h4 id="\u73B0\u5B9E\u7684\u5F02\u6B65i-o" tabindex="-1"><a class="header-anchor" href="#\u73B0\u5B9E\u7684\u5F02\u6B65i-o" aria-hidden="true">#</a> \u73B0\u5B9E\u7684\u5F02\u6B65I/O</h4><p>\u5355\u7EBF\u7A0B\u4EC5\u4EC5\u53EA\u662FJavaScript\u6267\u884C\u7684\u5355\u7EBF\u7A0B\u4E2D\u7F62\u4E86\uFF0C\u5728Node\u4E2D\uFF0C\u65E0\u8BBA\u662F*nix\u8FD8\u662FWindows\u5E73\u53F0\uFF0C\u5185\u90E8\u5B8C\u6210I/O\u4EFB\u52A1\u7684\u53E6\u6709\u7EBF\u7A0B\u6C60\u3002</p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJK4P.jpg" alt="gjJK4P.jpg"></p><h3 id="_3-3-node\u7684\u5F02\u6B65i-o" tabindex="-1"><a class="header-anchor" href="#_3-3-node\u7684\u5F02\u6B65i-o" aria-hidden="true">#</a> 3.3 Node\u7684\u5F02\u6B65I/O</h3><p>\u5B8C\u6210\u6574\u4E2A\u5F02\u6B65I/O\u73AF\u8282\u7684\u6709\u4E8B\u4EF6\u5FAA\u73AF\u3001\u89C2\u5BDF\u8005\u548C\u8BF7\u6C42\u5BF9\u8C61\u7B49\u3002</p><h4 id="\u4E8B\u4EF6\u5FAA\u73AF" tabindex="-1"><a class="header-anchor" href="#\u4E8B\u4EF6\u5FAA\u73AF" aria-hidden="true">#</a> \u4E8B\u4EF6\u5FAA\u73AF</h4><p>\u5728\u8FDB\u7A0B\u542F\u52A8\u65F6\uFF0CNode\u4FBF\u4F1A\u521B\u5EFA\u4E00\u4E2A\u7C7B\u4F3C\u4E8Ewhile(true)\u7684\u5FAA\u73AF\uFF0C\u6BCF\u6267\u884C\u4E00\u6B21\u5FAA\u73AF\u4F53\u7684\u8FC7\u7A0B\u6211\u4EEC\u79F0\u4E3A<strong>Tick</strong>\u3002\u6BCF\u4E2ATick\u7684\u8FC7\u7A0B\u5C31\u662F\u67E5\u770B\u662F\u5426\u6709\u4E8B\u4EF6\u5F85\u5904\u7406\uFF0C\u5982\u679C\u6709\uFF0C\u5C31\u53D6\u51FA\u4E8B\u4EF6\u53CA\u5176\u76F8\u5173\u7684\u56DE\u8C03\u51FD\u6570\u3002\u5982\u679C\u5B58\u5728\u5173\u8054\u7684\u56DE\u8C03\u51FD\u6570\uFF0C\u5C31\u6267\u884C\u4ED6\u4EEC\uFF0C\u7136\u540E\u8FDB\u5165\u4E0B\u4E2A\u5FAA\u73AF\uFF0C\u5982\u679C\u4E0D\u518D\u6709\u4E8B\u4EF6\u5904\u7406\uFF0C\u5C31\u9000\u51FA\u8FDB\u7A0B\u3002</p><h4 id="\u89C2\u5BDF\u8005" tabindex="-1"><a class="header-anchor" href="#\u89C2\u5BDF\u8005" aria-hidden="true">#</a> \u89C2\u5BDF\u8005</h4><p>\u6BCF\u4E2A\u4E8B\u4EF6\u5FAA\u73AF\u4E2D\u6709\u4E00\u4E2A\u6216\u8005\u591A\u4E2A\u89C2\u5BDF\u8005\uFF0C\u800C\u5224\u65AD\u662F\u5426\u6709\u4E8B\u4EF6\u8981\u5904\u7406\u7684\u8FC7\u7A0B\u5C31\u662F\u5411\u8FD9\u4E9B\u89C2\u5BDF\u8005\u8BE2\u95EE\u662F\u5426\u6709\u8981\u5904\u7406\u7684\u4E8B\u4EF6\u3002</p><p>\u5728Windows\u4E0B\uFF0C\u8FD9\u4E2A\u5FAA\u73AF\u57FA\u4E8EIOCP\u521B\u5EFA\uFF0C\u800C\u5728*nix\u4E0B\u5219\u57FA\u4E8E\u591A\u7EBF\u7A0B\u521B\u5EFA\u3002</p><h4 id="\u8BF7\u6C42\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#\u8BF7\u6C42\u5BF9\u8C61" aria-hidden="true">#</a> \u8BF7\u6C42\u5BF9\u8C61</h4><p>\u4ECEJavaScript\u53D1\u8D77\u8C03\u7528\u5230\u5185\u6838\u6267\u884C\u5B8CI/O\u64CD\u4F5C\u7684\u8FC7\u6E21\u8FC7\u7A0B\u4E2D\uFF0C\u5B58\u5728\u4E00\u79CD\u4E2D\u95F4\u4EA7\u7269\uFF0C\u5B83\u53EB\u505A\u8BF7\u6C42\u5BF9\u8C61\u3002</p><p>\u4ECEJavaScript\u8C03\u7528Node\u7684\u6838\u5FC3\u6A21\u5757\uFF0C\u6838\u5FC3\u6A21\u5757\u8C03\u7528C++\u5185\u5EFA\u6A21\u5757\uFF0C\u5185\u5EFA\u6A21\u5757\u901A\u8FC7libuv\u8FDB\u884C\u7CFB\u7EDF\u8C03\u7528\u3002</p><h4 id="\u6267\u884C\u56DE\u8C03" tabindex="-1"><a class="header-anchor" href="#\u6267\u884C\u56DE\u8C03" aria-hidden="true">#</a> \u6267\u884C\u56DE\u8C03</h4><p>\u7EC4\u88C5\u597D\u8BF7\u6C42\u5BF9\u8C61\u3001\u9001\u5165I/O\u7EBF\u7A0B\u6C60\u7B49\u5F85\u6267\u884C\uFF0C\u5B8C\u6210\u4E86\u5F02\u6B65I/O\u7684\u7B2C\u4E00\u90E8\u5206\uFF0C\u56DE\u8C03\u901A\u77E5\u662F\u7B2C\u4E8C\u90E8\u5206\u3002</p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJQ9f.jpg" alt="gjJQ9f.jpg"></p><h4 id="\u5C0F\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u5C0F\u7ED3" aria-hidden="true">#</a> \u5C0F\u7ED3</h4><p>\u5F02\u6B65I/O\u7684\u51E0\u4E2A\u5173\u952E\u8BCD\uFF1A\u5355\u7EBF\u7A0B\u3001\u4E8B\u4EF6\u5FAA\u73AF\u3001\u89C2\u5BDF\u8005\u548CI/O\u7EBF\u7A0B\u6C60\u3002</p><p>\u9664\u4E86\u7528\u6237\u4EE3\u7801\u65E0\u6CD5\u5E76\u884C\u6267\u884C\u5916\uFF0C\u6240\u6709\u7684I/O\u5219\u662F\u53EF\u4EE5\u5E76\u884C\u8D77\u6765\u7684\u3002</p><h3 id="_3-4-\u975Ei-o\u7684\u5F02\u6B65api" tabindex="-1"><a class="header-anchor" href="#_3-4-\u975Ei-o\u7684\u5F02\u6B65api" aria-hidden="true">#</a> 3.4 \u975EI/O\u7684\u5F02\u6B65API</h3><p>setTimeout()\u3001setInterval()\u3001setImmediate()\u548Cprocess.nextTick()\u3002</p><h4 id="\u5B9A\u65F6\u5668" tabindex="-1"><a class="header-anchor" href="#\u5B9A\u65F6\u5668" aria-hidden="true">#</a> \u5B9A\u65F6\u5668</h4><p>setTimeout()\u548CsetInterval()\u7684\u5B9E\u73B0\u539F\u7406\u4E0E\u5F02\u6B65I/O\u6BD4\u8F83\u7C7B\u4F3C\uFF0C\u53EA\u662F\u4E0D\u9700\u8981I/O\u7EBF\u7A0B\u6C60\u7684\u53C2\u4E0E\u3002</p><p>\u521B\u5EFA\u7684\u5B9A\u65F6\u5668\u4F1A\u88AB\u63D2\u5165\u5230\u5B9A\u65F6\u5668\u89C2\u5BDF\u8005\u5185\u90E8\u7684\u4E00\u4E2A\u7EA2\u9ED1\u6811\u4E2D\u3002</p><h4 id="process-nexttick" tabindex="-1"><a class="header-anchor" href="#process-nexttick" aria-hidden="true">#</a> process.nextTick()</h4><p>\u7ACB\u5373\u5F02\u6B65\u6267\u884C\u4E00\u4E2A\u4EFB\u52A1\uFF0CsetTimeout(fn,0)\u7684\u65B9\u5F0F\u8F83\u4E3A\u6D6A\u8D39\u6027\u80FD\u3002</p><p>\u5B9A\u65F6\u5668\u4E2D\u91C7\u7528\u7EA2\u9ED1\u6811\u7684\u64CD\u4F5C\u65F6\u95F4\u590D\u6742\u5EA6\u4E3AO(lg(n))\uFF0CnextTick()\u7684\u4E8B\u4EF6\u590D\u6742\u5EA6\u4E3AO(1)\u3002</p><h4 id="setimmediate" tabindex="-1"><a class="header-anchor" href="#setimmediate" aria-hidden="true">#</a> setImmediate()</h4><p>setImmediate()\u65B9\u6CD5\u548Cproce.nextTick()\u5341\u5206\u7C7B\u4F3C\uFF0Cprocess.nextTIck()\u4E2D\u7684\u56DE\u8C03\u51FD\u6570\u6267\u884C\u4F18\u5148\u7EA7\u9AD8\u4E8EsetImmediate()\u3002</p><p>\u539F\u56E0\u662Fproces.nextTick()\u5C5E\u4E8Eidle\u89C2\u5BDF\u8005\uFF0CsetImmediate()\u5C5E\u4E8Echeck\u89C2\u5BDF\u8005\u3002\u5728\u6BCF\u4E00\u8F6E\u8F6E\u5FAA\u73AF\u68C0\u67E5\u4E2D\uFF0Cidle\u89C2\u5BDF\u8005\u5148\u4E8EI/O\u89C2\u5BDF\u8005\uFF0CI/O\u89C2\u5BDF\u8005\u5148\u4E8Echeck\u89C2\u5BDF\u8005\u3002</p><p>process.nextTick()\u7684\u56DE\u8C03\u51FD\u6570\u4FDD\u5B58\u5728\u4E00\u4E2A\u6570\u7EC4\u4E2D\uFF0CsetImmediate()\u7684\u7ED3\u679C\u5219\u662F\u4FDD\u5B58\u5728\u94FE\u8868\u4E2D\u3002</p><p>process.nextTick()\u5728\u6BCF\u8F6E\u5FAA\u73AF\u4E2D\u4F1A\u5C06\u6570\u7EC4\u4E2D\u7684\u56DE\u8C03\u51FD\u6570\u5168\u90E8\u6267\u884C\u5B8C\uFF0CsetImmediate()\u7684\u6BCF\u8F6E\u5FAA\u73AF\u4E2D\u6267\u884C\u94FE\u8868\u4E2D\u7684\u4E00\u4E2A\u56DE\u8C03\u51FD\u6570\u3002</p><h3 id="_3-5-\u4E8B\u4EF6\u9A71\u52A8\u4E0E\u9AD8\u6027\u80FD\u670D\u52A1\u5668" tabindex="-1"><a class="header-anchor" href="#_3-5-\u4E8B\u4EF6\u9A71\u52A8\u4E0E\u9AD8\u6027\u80FD\u670D\u52A1\u5668" aria-hidden="true">#</a> 3.5 \u4E8B\u4EF6\u9A71\u52A8\u4E0E\u9AD8\u6027\u80FD\u670D\u52A1\u5668</h3><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJl38.jpg" alt="gjJl38.jpg"></p><p>\u96C6\u4E2D\u7ECF\u5178\u7684\u670D\u52A1\u5668\u6A21\u578B\uFF1A</p><ul><li>\u540C\u6B65\u5F0F\u3002\u5BF9\u4E8E\u540C\u6B65\u5F0F\u7684\u670D\u52A1\uFF0C\u4E00\u6B21\u53EA\u80FD\u5904\u7406\u4E00\u4E2A\u8BF7\u6C42\uFF0C\u5E76\u4E14\u5176\u4F59\u8BF7\u6C42\u90FD\u5904\u4E8E\u7B49\u5F85\u72B6\u6001\u3002</li><li>\u6BCF\u8FDB\u7A0B/\u6BCF\u8BF7\u6C42\u3002\u4E3A\u6BCF\u4E2A\u8BF7\u6C42\u542F\u52A8\u4E00\u4E2A\u8FDB\u7A0B\uFF0C\u8FD9\u6837\u53EF\u4EE5\u5904\u7406\u591A\u4E2A\u8BF7\u6C42\uFF0C\u4F46\u662F\u5B83\u4E0D\u5177\u5907\u6269\u5C55\u6027\uFF0C\u56E0\u4E3A\u7CFB\u7EDF\u8D44\u6E90\u53EA\u6709\u90A3\u4E48\u591A\u3002</li><li>\u6BCF\u7EBF\u7A0B/\u6BCF\u8BF7\u6C42\u3002\u4E3A\u6BCF\u4E2A\u8BF7\u6C42\u542F\u52A8\u4E00\u4E2A\u7EBF\u7A0B\u6765\u5904\u7406\u3002\u5F53\u5927\u5E76\u53D1\u8BF7\u6C42\u5230\u6765\u65F6\uFF0C\u5185\u5B58\u5C06\u4F1A\u5F88\u5FEB\u7528\u5149\uFF0C\u5BFC\u81F4\u670D\u52A1\u5668\u7F13\u6162\u3002</li></ul><p>Node\u91C7\u7528\u4E8B\u4EF6\u9A71\u52A8\u7684\u65B9\u5F0F\u5904\u7406\u8BF7\u6C42\uFF0C\u65E0\u987B\u4E3A\u6BCF\u4E2A\u8BF7\u6C42\u521B\u5EFA\u989D\u5916\u7684\u5BF9\u5E94\u7EBF\u7A0B\uFF0C\u53EF\u4EE5\u7701\u6389\u521B\u5EFA\u7EBF\u7A0B\u548C\u9500\u6BC1\u7EBF\u7A0B\u7684\u5F00\u9500\uFF0C\u540C\u65F6\u64CD\u4F5C\u7CFB\u7EDF\u5728\u8C03\u5EA6\u4EFB\u52A1\u65F6\u56E0\u4E3A\u7EBF\u7A0B\u8F83\u5C11\uFF0C\u4E0A\u4E0B\u6587\u5207\u6362\u7684\u4EE3\u4EF7\u5F88\u4F4E\u3002\u5373\u4F7F\u5728\u5927\u91CF\u8FDE\u63A5\u7684\u60C5\u51B5\u4E0B\uFF0C\u4E5F\u4E0D\u53D7\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u5207\u6362\u5F00\u9500\u7684\u5F71\u54CD \uFF0C\u8FD9\u662FNode\u9AD8\u6027\u80FD\u7684\u4E00\u4E2A\u539F\u56E0\u3002</p><h2 id="\u7B2C4\u7AE0-\u5F02\u6B65\u7F16\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u7B2C4\u7AE0-\u5F02\u6B65\u7F16\u7A0B" aria-hidden="true">#</a> \u7B2C4\u7AE0 \u5F02\u6B65\u7F16\u7A0B</h2><h3 id="_4-1-\u51FD\u6570\u5F0F\u7F16\u7A0B" tabindex="-1"><a class="header-anchor" href="#_4-1-\u51FD\u6570\u5F0F\u7F16\u7A0B" aria-hidden="true">#</a> 4.1 \u51FD\u6570\u5F0F\u7F16\u7A0B</h3><h4 id="\u9AD8\u9636\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u9AD8\u9636\u51FD\u6570" aria-hidden="true">#</a> \u9AD8\u9636\u51FD\u6570</h4><p>\u9AD8\u9636\u51FD\u6570\u53EF\u4EE5\u628A\u51FD\u6570\u5F53\u505A\u53C2\u6570\uFF0C\u6216\u662F\u5C06\u51FD\u6570\u4F5C\u4E3A\u8FD4\u56DE\u503C\u7684\u51FD\u6570\u3002</p><h4 id="\u504F\u51FD\u6570\u7528\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u504F\u51FD\u6570\u7528\u6CD5" aria-hidden="true">#</a> \u504F\u51FD\u6570\u7528\u6CD5</h4><p>\u504F\u51FD\u6570\u7528\u6CD5\u662F\u6307\u521B\u5EFA\u4E00\u4E2A\u8C03\u7528\u53E6\u5916\u4E00\u4E2A\u90E8\u5206\u2014\u2014\u53C2\u6570\u6216\u53D8\u91CF\u5DF2\u7ECF\u9884\u7F6E\u7684\u51FD\u6570\u2014\u2014\u7684\u51FD\u6570\u7684\u7528\u6CD5\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">toString</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Object</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">prototype</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">toString</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">isType</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">function</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">type</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">function</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">obj</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">toString</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">call</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">obj</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">[object </span><span style="color:#81A1C1;">\${</span><span style="color:#D8DEE9;">type</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">]</span><span style="color:#ECEFF4;">\`</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">isString</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">isType</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">String</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">isFunction</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">isType</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Function</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_4-2-\u5F02\u6B65\u7F16\u7A0B\u7684\u4F18\u52BF\u4E0E\u96BE\u70B9" tabindex="-1"><a class="header-anchor" href="#_4-2-\u5F02\u6B65\u7F16\u7A0B\u7684\u4F18\u52BF\u4E0E\u96BE\u70B9" aria-hidden="true">#</a> 4.2 \u5F02\u6B65\u7F16\u7A0B\u7684\u4F18\u52BF\u4E0E\u96BE\u70B9</h3><h4 id="\u4F18\u52BF" tabindex="-1"><a class="header-anchor" href="#\u4F18\u52BF" aria-hidden="true">#</a> \u4F18\u52BF</h4><p>Node\u7279\u6027\u662F\u57FA\u4E8E\u4E8B\u4EF6\u9A71\u52A8\u7684\u975E\u963B\u585EI/O\u6A21\u578B\uFF0C\u662F\u7075\u9B42\u6240\u5728\u3002</p><p>\u5EFA\u8BAE\u5BF9CPU\u7684\u8017\u7528\u4E0D\u8981\u8D85\u8FC710ms\uFF0C\u6216\u8005\u5C06\u5927\u91CF\u7684\u8BA1\u7B97\u5206\u89E3\u4E3A\u8BF8\u591A\u7684\u5C0F\u91CF\u8BA1\u7B97\uFF0C\u901A\u8FC7setImmediate()\u8FDB\u884C\u8C03\u5EA6\u3002</p><h4 id="\u96BE\u70B9" tabindex="-1"><a class="header-anchor" href="#\u96BE\u70B9" aria-hidden="true">#</a> \u96BE\u70B9</h4><ol><li><p>\u96BE\u70B91\uFF1A\u5F02\u5E38\u5904\u7406</p><p>\u81EA\u884C\u7F16\u5199\u7684\u5F02\u6B65\u65B9\u6CD5\u9700\u8981\u9075\u5FAA\u8FD9\u4E9B\u539F\u5219\uFF1A<strong>\u5FC5\u987B\u6267\u884C\u8C03\u7528\u8005\u4F20\u5165\u7684\u56DE\u8C03\u51FD\u6570\uFF1B\u6B63\u786E\u4F20\u9012\u56DE\u5F02\u5E38\u4F9B\u8C03\u7528\u8005\u5224\u65AD\u3002</strong></p></li><li><p>\u96BE\u70B92\uFF1A\u51FD\u6570\u5D4C\u5957\u8FC7\u6DF1</p></li><li><p>\u96BE\u70B93\uFF1A\u963B\u585E\u4EE3\u7801</p><p>\u6CA1\u6709\u50CFsleep()\u8FD9\u6837\u7684\u7EBF\u7A0B\u6C89\u7761\u529F\u80FD\u3002</p><p>\u8C03\u7528setTimeout()\u6548\u679C\u4F1A\u66F4\u597D</p></li><li><p>\u96BE\u70B94\uFF1A\u591A\u7EBF\u7A0B\u7F16\u7A0B</p><p>JavaScript\u4E2D\uFF0CWeb Workers\u80FD\u89E3\u51B3\u5229\u7528CPU\u548C\u51CF\u5C11\u963B\u585EUI\u6E32\u67D3\uFF0C\u4F46\u662F\u4E0D\u80FD\u89E3\u51B3UI\u6E32\u67D3\u7684\u6548\u7387\u95EE\u9898\u3002</p><p>Node\u501F\u9274\u4E86\u8FD9\u4E2A\u6A21\u5F0F\uFF0Cchild_process\u662F\u57FA\u7840API\uFF0Ccluster\u6A21\u5757\u662F\u66F4\u6DF1\u5C42\u6B21\u7684\u5E94\u7528\u3002</p></li><li><p>\u96BE\u70B95\uFF1A\u5F02\u6B65\u8F6C\u540C\u6B65</p></li></ol><h3 id="_4-3-\u5F02\u6B65\u7F16\u7A0B\u89E3\u51B3\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#_4-3-\u5F02\u6B65\u7F16\u7A0B\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a> 4.3 \u5F02\u6B65\u7F16\u7A0B\u89E3\u51B3\u65B9\u6848</h3><ul><li>\u4E8B\u4EF6\u53D1\u5E03/\u8BA2\u9605\u6A21\u5F0F\u3002</li><li>Promise/Deferred\u6A21\u5F0F\u3002</li><li>\u6D41\u7A0B\u63A7\u5236\u5E93\u3002</li></ul><h4 id="\u4E8B\u4EF6\u53D1\u5E03-\u8BA2\u9605\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u4E8B\u4EF6\u53D1\u5E03-\u8BA2\u9605\u6A21\u5F0F" aria-hidden="true">#</a> \u4E8B\u4EF6\u53D1\u5E03/\u8BA2\u9605\u6A21\u5F0F</h4><p>Node\u81EA\u8EAB\u63D0\u4F9B\u7684events\u6A21\u5757\u662F\u53D1\u5E03/\u8BA2\u9605\u6A21\u5F0F\u7684\u4E00\u4E2A\u7B80\u5355\u5B9E\u73B0\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#D8DEE9;">emitter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">e1</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;">function</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">mes</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">mes</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">emitter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">emit</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">e1</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">nihao</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u4E8B\u4EF6\u4FA6\u542C\u5668\u6A21\u5F0F\u4E5F\u662F\u4E00\u79CD\u94A9\u5B50\uFF08hook\uFF09\u673A\u5236\uFF0C\u5229\u7528\u94A9\u5B50\u5BFC\u51FA\u5185\u90E8\u6570\u636E\u6216\u72B6\u6001\u7ED9\u5916\u90E8\u7684\u8C03\u7528\u8005\u3002</p><p>Node\u5BF9\u4E8B\u4EF6\u53D1\u5E03/\u8BA2\u9605\u7684\u673A\u5236\u505A\u4E86\u4E00\u4E9B\u989D\u5916\u7684\u5904\u7406</p><ul><li>\u5982\u679C\u5BF9\u4E00\u4E2A\u4E8B\u4EF6\u6DFB\u52A0\u8D85\u8FC710\u4E2A\u4FA6\u542C\u5668\uFF0C\u5C31\u4F1A\u5F97\u5230\u4E00\u6761\u8B66\u544A\uFF0C\u4FA6\u542C\u5668\u592A\u591A\u53EF\u80FD\u5BFC\u81F4\u5185\u5B58\u6CC4\u6F0F\uFF1B\u8C03\u7528emiiter.setMaxListeners(0)\uFF0C\u53EF\u4EE5\u5C06\u9650\u5236\u53BB\u6389\uFF1B\u5982\u679C\u4E8B\u4EF6\u7684\u4FA6\u542C\u5668\u8FC7\u591A\uFF0C\u53EF\u80FD\u5B58\u5728\u8FC7\u591A\u5360\u7528CPU\u7684\u60C5\u666F\u3002</li><li>\u4E3A\u4E86\u5904\u7406\u5F02\u5E38\uFF0CEventEmitter\u5BF9\u8C61\u5BF9error\u4E8B\u4EF6\u8FDB\u884C\u4E86\u7279\u6B8A\u5BF9\u5F85\u3002\u5982\u679C\u8FD0\u884C\u671F\u95F4\u7684\u9519\u8BEF\u89E6\u53D1\u4E86error\u4E8B\u4EF6\uFF0CEventEmitter\u4F1A\u68C0\u67E5\u662F\u5426\u6709\u5BF9error\u4E8B\u4EF6\u6DFB\u52A0\u8FC7\u4FA6\u542C\u5668\uFF0C\u5982\u679C\u6DFB\u52A0\u5219\u5C06\u8FD9\u4E2A\u9519\u8BEF\u4EA4\u7ED9\u4FA6\u542C\u5668\u5904\u7406\uFF0C\u5426\u5219\u4F1A\u4F5C\u4E3A\u5F02\u5E38\u629B\u51FA\uFF1B\u5982\u679C\u5916\u90E8\u6CA1\u6355\u83B7\u5F02\u5E38\u4F1A\u5F15\u8D77\u7EBF\u7A0B\u9000\u51FA\u3002</li></ul><ol><li><p>\u7EE7\u627Fevents\u6A21\u5757</p></li><li><p>\u5229\u7528\u4E8B\u4EF6\u961F\u5217\u89E3\u51B3\u96EA\u5D29\u95EE\u9898</p><p>once()\u65B9\u6CD5\uFF0C\u4FA6\u542C\u5668\u53EA\u80FD\u6267\u884C\u4E00\u6B21\u3002</p><p>\u96EA\u5D29\u95EE\u9898\uFF0C\u5C31\u662F\u5728\u9AD8\u8BBF\u95EE\u91CF\u3001\u5927\u5E76\u53D1\u91CF\u7684\u60C5\u51B5\u4E0B\u7F13\u5B58\u5931\u6548\u7684\u60C5\u666F\u3002</p></li><li><p>\u591A\u5F02\u6B65\u4E4B\u95F4\u7684\u534F\u4F5C\u65B9\u6848</p><p>\u4E00\u822C\u800C\u8A00\uFF0C\u4E8B\u4EF6\u4E0E\u4FA6\u542C\u5668\u7684\u5173\u7CFB\u662F\u4E00\u5BF9\u591A\u3002</p></li><li><p>EventProxy\u7684\u539F\u7406</p></li><li><p>EventProxy\u7684\u5F02\u5E38\u5904\u7406</p></li></ol><h4 id="promise-deferred\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#promise-deferred\u6A21\u5F0F" aria-hidden="true">#</a> Promise/Deferred\u6A21\u5F0F</h4><ol><li><p>Promises/A</p><ul><li>3\u79CD\u72B6\u6001\uFF0C\u672A\u5B8C\u6210\u6001\u3001\u5B8C\u6210\u6001\u548C\u5931\u8D25\u6001\u3002</li><li>\u4ECE\u672A\u5B8C\u6210\u6001\u5411\u5B8C\u6210\u6001\u6216\u5931\u8D25\u6001\u8F6C\u5316\uFF0C\u4E0D\u80FD\u9006\u53CD\u3002</li><li>\u4E00\u65E6\u8F6C\u5316\uFF0C\u4E0D\u80FD\u88AB\u66F4\u6539\u3002</li></ul></li><li><p>Promise\u4E2D\u7684\u591A\u5F02\u6B65\u534F\u4F5C</p></li><li><p>Promise\u7684\u8FDB\u9636\u77E5\u8BC6</p><ul><li><p>\u652F\u6301\u5E8F\u5217\u6267\u884C\u7684Promise</p><p>\u8981Promise\u652F\u6301\u94FE\u5F0F\u6267\u884C\uFF0C\u9700\u8981\u4EE5\u4E0B\u4E24\u4E2A\u6B65\u9AA4</p><p>\uFF081\uFF09\u5C06\u6240\u6709\u7684\u56DE\u8C03\u90FD\u5B58\u5230\u961F\u5217\u4E2D\u3002</p><p>\uFF082\uFF09Promise\u5B8C\u6210\u65F6\uFF0C\u9010\u4E2A\u6267\u884C\u56DE\u8C03\uFF0C\u4E00\u65E6\u68C0\u67E5\u5230\u8FD4\u56DE\u4E86\u65B0\u7684Promise\u5BF9\u8C61\uFF0C\u505C\u6B62\u6267\u884C\uFF0C\u7136\u540E\u5C06\u5F53\u524DDeferred\u5BF9\u8C61\u7684promise\u5F15\u7528\u6539\u53D8\u4E3A\u65B0\u7684Pormise\u5BF9\u8C61\uFF0C\u5E76\u5C06\u961F\u5217\u4E2D\u4F59\u4E0B\u7684\u56DE\u8C03\u8F6C\u4EA4\u7ED9\u5B83\u3002</p></li><li><p>\u5C06API Promise\u5316</p></li></ul></li></ol><h4 id="\u6D41\u7A0B\u63A7\u5236\u5E93" tabindex="-1"><a class="header-anchor" href="#\u6D41\u7A0B\u63A7\u5236\u5E93" aria-hidden="true">#</a> \u6D41\u7A0B\u63A7\u5236\u5E93</h4><ol><li><p>\u5C3E\u89E6\u53D1\u4E0ENext,Connect\u5E93</p><p>\u9700\u8981\u624B\u5DE5\u8C03\u7528\u624D\u80FD\u6301\u7EED\u6267\u884C\u540E\u7EED\u8C03\u7528\u3002</p></li><li><p>async\u5E93</p><ul><li>\u5F02\u6B65\u7684\u4E32\u884C\u6267\u884C</li><li>\u5F02\u6B65\u7684\u5E76\u884C\u6267\u884C</li><li>\u5F02\u6B65\u8C03\u7528\u7684\u4F9D\u8D56\u5904\u7406</li><li>\u81EA\u52A8\u4F9D\u8D56\u5904\u7406</li></ul></li><li><p>Step\u5E93</p></li><li><p>wind\u5E93</p></li></ol><h3 id="_4-4-\u5F02\u6B65\u5E76\u53D1\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#_4-4-\u5F02\u6B65\u5E76\u53D1\u63A7\u5236" aria-hidden="true">#</a> 4.4 \u5F02\u6B65\u5E76\u53D1\u63A7\u5236</h3><p>\u901A\u8FC7\u961F\u5217\u6765\u63A7\u5236\u5E76\u53D1\u91CF</p><h2 id="\u7B2C5\u7AE0-\u5185\u5B58\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#\u7B2C5\u7AE0-\u5185\u5B58\u63A7\u5236" aria-hidden="true">#</a> \u7B2C5\u7AE0 \u5185\u5B58\u63A7\u5236</h2><p>\u57FA\u4E8E\u65E0\u963B\u585E\u3001\u4E8B\u4EF6\u9A71\u52A8\u5EFA\u7ACB\u7684Node\u670D\u52A1\uFF0C\u5177\u6709\u5185\u5B58\u6D88\u8017\u4F4E\u7684\u4F18\u70B9\uFF0C\u975E\u5E38\u9002\u5408\u5904\u7406\u6D77\u91CF\u7684\u7F51\u7EDC\u8BF7\u6C42\u3002</p><h3 id="_5-1-v8\u7684\u5783\u573E\u56DE\u6536\u673A\u5236\u4E0E\u5185\u5B58\u9650\u5236" tabindex="-1"><a class="header-anchor" href="#_5-1-v8\u7684\u5783\u573E\u56DE\u6536\u673A\u5236\u4E0E\u5185\u5B58\u9650\u5236" aria-hidden="true">#</a> 5.1 V8\u7684\u5783\u573E\u56DE\u6536\u673A\u5236\u4E0E\u5185\u5B58\u9650\u5236</h3><h4 id="node\u4E0Ev8" tabindex="-1"><a class="header-anchor" href="#node\u4E0Ev8" aria-hidden="true">#</a> Node\u4E0EV8</h4><p>Node\u5728JavaScript\u7684\u6267\u884C\u4E0A\u76F4\u63A5\u53D7\u76CA\u4E8EV8,\u53EF\u4EE5\u968F\u7740V8\u7684\u5347\u7EA7\u5C31\u80FD\u4EAB\u53D7\u5230\u66F4\u597D\u5730\u6027\u80FD\u6216\u65B0\u7684\u8BED\u8A00\u7279\u6027\uFF08\u5982ES5\u548CES6\uFF09\u7B49\u3002</p><h4 id="v8\u7684\u5185\u5B58\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#v8\u7684\u5185\u5B58\u63A7\u5236" aria-hidden="true">#</a> V8\u7684\u5185\u5B58\u63A7\u5236</h4><p>Node\u4E2D\u901A\u8FC7JavaScript\u4F7F\u7528\u5185\u5B58\u65F6\u53EA\u80FD\u4F7F\u7528\u90E8\u5206\u5185\u5B58\uFF0C\u8FD9\u4F1A\u5BFC\u81F4Node\u65E0\u6CD5\u76F4\u63A5\u64CD\u4F5C\u5927\u5185\u5B58\u5BF9\u8C61\uFF0C\u8BA1\u7B97\u673A\u5185\u5B58\u8D44\u6E90\u65E0\u6CD5\u5F97\u5230\u5145\u8DB3\u7684\u4F7F\u7528\u3002</p><h4 id="v8\u7684\u5BF9\u8C61\u5206\u914D" tabindex="-1"><a class="header-anchor" href="#v8\u7684\u5BF9\u8C61\u5206\u914D" aria-hidden="true">#</a> V8\u7684\u5BF9\u8C61\u5206\u914D</h4><p>\u5728V8\u4E2D\uFF0C\u6240\u6709\u7684JavaScript\u5BF9\u8C61\u90FD\u662F\u901A\u8FC7\u5806\u6765\u8FDB\u884C\u5206\u914D\u7684\u3002</p><p><code>process.memoryUsage()</code>\u67E5\u770B\u5185\u5B58\u4F7F\u7528\u4FE1\u606F\u3002</p><p>\u5F53\u6211\u4EEC\u5728\u4EE3\u7801\u4E2D\u58F0\u660E\u53D8\u91CF\u5E76\u8D4B\u503C\u65F6\uFF0C\u6240\u4F7F\u7528\u5BF9\u8C61\u7684\u5185\u5B58\u5C31\u5206\u914D\u5728\u5806\u4E2D\u3002</p><p>\u8003\u8651\u5230\u5783\u573E\u56DE\u6536\u673A\u5236\u6240\u9700\u8981\u7684\u65F6\u95F4\u4F1A\u77ED\u6682\u9020\u6210JavaScript\u7EBF\u7A0B\u6682\u505C\u6267\u884C\uFF0C\u76F4\u63A5\u9650\u5236\u5806\u5185\u5B58\u662F\u4E00\u4E2A\u597D\u7684\u9009\u62E9\u3002</p><p>\u8FD9\u4E2A\u9650\u5236\u4E5F\u53EF\u4EE5\u6253\u5F00\uFF0C\u5728Node\u542F\u52A8\u65F6\u4F20\u9012<code>--max-old-space-size</code>\uFF08\u8BBE\u7F6E\u8001\u751F\u4EE3\u5185\u5B58\u7A7A\u95F4\u7684\u5927\u5C0F\uFF09\u6216<code>--max-new-space-size</code>\uFF08\u8BBE\u7F6E\u65B0\u751F\u4EE3\u5185\u5B58\u7A7A\u95F4\u7684\u5927\u5C0F\uFF09\u6765\u8C03\u6574\u5185\u5B58\u9650\u5236\u7684\u5927\u5C0F\uFF0C\u5982<code>node --max-old-space-size=1700 test.js // \u5355\u4F4D\u4E3AMB</code></p><h4 id="v8\u7684\u5783\u573E\u56DE\u6536\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#v8\u7684\u5783\u573E\u56DE\u6536\u673A\u5236" aria-hidden="true">#</a> V8\u7684\u5783\u573E\u56DE\u6536\u673A\u5236</h4><p>V8\u7528\u5230\u7684\u5404\u79CD\u5783\u573E\u56DE\u6536\u7B97\u6CD5</p><ul><li><p>V8\u7684\u5185\u5B58\u5206\u4EE3</p><p>V8\u7684\u5783\u573E\u56DE\u6536\u7B56\u7565\u4E3B\u8981\u57FA\u4E8E<strong>\u5206\u4EE3\u5F0F\u5783\u573E\u56DE\u6536\u673A\u5236</strong>\u3002</p><p>\u73B0\u4EE3\u7684\u5783\u573E\u56DE\u6536\u7B97\u6CD5\u4E2D\u6309\u5BF9\u8C61\u7684\u5B58\u6D3B\u65F6\u95F4\u5C06\u5185\u5B58\u7684\u5783\u573E\u56DE\u6536\u8FDB\u884C\u4E0D\u540C\u7684\u5206\u4EE3\uFF0C\u7136\u540E\u5206\u522B\u5BF9\u4E0D\u540C\u5206\u4EE3\u7684\u5185\u5B58\u65BD\u4EE5\u66F4\u9AD8\u6548\u7684\u7B97\u6CD5\u3002</p><p>\u5C06\u5185\u5B58\u5206\u4E3A\u65B0\u751F\u4EE3\u548C\u8001\u751F\u4EE3\uFF0C\u65B0\u751F\u4EE3\u4E2D\u7684\u5BF9\u8C61\u4E3A\u5B58\u6D3B\u65F6\u95F4\u8F83\u77ED\u7684\u5BF9\u8C61\uFF0C\u8001\u751F\u4EE3\u4E2D\u7684\u5BF9\u8C61\u4E3A\u5B58\u6D3B\u65F6\u95F4\u8F83\u957F\u6216\u5E38\u9A7B\u5185\u5B58\u7684\u5BF9\u8C61\u3002</p><p>\u5F53\u5185\u5B58\u5206\u914D\u8FC7\u7A0B\u8D85\u8FC7\u6781\u9650\u503C\u5C31\u4F1A\u5BFC\u81F4\u8FDB\u7A0B\u51FA\u9519\u3002\u9ED8\u8BA4\u5185\u5B58\u914D\u7F6E\u662F64\u4F4D1.4GB\u548C32\u4F4D0.7GB\u3002</p></li><li><p>Scavenge\u7B97\u6CD5</p><p>\u65B0\u751F\u4EE3\u4E2D\u7684\u5BF9\u8C61\u4E3B\u8981\u901A\u8FC7Scavenge\u7B97\u6CD5\u8FDB\u884C\u5783\u573E\u56DE\u6536\uFF0CScavenge\u7B97\u6CD5\u5B9E\u73B0\u4E3B\u8981\u91C7\u7528\u4E86Cheney\u7B97\u6CD5\u3002</p><p>Cheney\u7B97\u6CD5\u662F\u4E00\u79CD\u91C7\u7528\u590D\u5236\u7684\u65B9\u5F0F\u5B9E\u73B0\u7684\u5783\u573E\u56DE\u6536\u7B97\u6CD5\uFF0C\u5B83\u5C06\u5806\u5185\u5B58\u4E00\u5206\u4E3A\u4E8C\uFF0C\u6BCF\u4E00\u90E8\u5206\u7A7A\u95F4\u79F0\u4E3Asemispace\uFF0C\u5728\u8FD9\u4E24\u4E2Asemispace\u7A7A\u95F4\u4E2D\uFF0C\u4E00\u4E2A\u5904\u4E8E\u4F7F\u7528\u72B6\u6001\uFF08From\u7A7A\u95F4\uFF09\uFF0C\u4E00\u4E2A\u5904\u4E8E\u95F2\u7F6E\u72B6\u6001\uFF08To\u7A7A\u95F4\uFF09\uFF0C\u5206\u914D\u5BF9\u8C61\u662F\u5728From\u7A7A\u95F4\u8FDB\u884C\u5206\u914D\u3002</p><p>\u5F53\u5F00\u59CB\u8FDB\u884C\u5783\u573E\u56DE\u6536\u65F6\uFF0C\u4F1A\u68C0\u67E5From\u7A7A\u95F4\u4E2D\u7684\u5B58\u6D3B\u5BF9\u8C61\uFF0C\u5C06\u5B58\u6D3B\u5BF9\u8C61\u590D\u5236\u5230To\u7A7A\u95F4\uFF0C\u800C\u975E\u5B58\u6D3B\u5BF9\u8C61\u5360\u7528\u7684\u7A7A\u95F4\u5C06\u4F1A\u88AB\u91CA\u653E\uFF0C\u5783\u573E\u56DE\u6536\u7684\u8FC7\u7A0B\u5C31\u662F\u901A\u8FC7\u5C06\u5B58\u6D3B\u5BF9\u8C61\u5728\u4E24\u4E2Asemispace\u7A7A\u95F4\u4E4B\u95F4\u8FDB\u884C\u590D\u5236\u3002</p><p>Scavenge\u7684\u7F3A\u70B9\u662F\u53EA\u80FD\u4F7F\u7528\u5806\u5185\u5B58\u4E2D\u7684\u4E00\u534A\uFF0C\u8FD9\u662F\u56E0\u4E3A\u5212\u5206\u7A7A\u95F4\u548C\u590D\u5236\u673A\u5236\u6240\u51B3\u5B9A\u7684\uFF0C\u91C7\u7528\u4E86\u727A\u7272\u7A7A\u95F4\u6362\u53D6\u65F6\u95F4\u7684\u7B97\u6CD5\u3002</p><p>Scavenge\u975E\u5E38\u9002\u5408\u5E94\u7528\u5728\u65B0\u751F\u4EE3\u4E2D\uFF0C\u56E0\u4E3A\u65B0\u751F\u4EE3\u4E2D\u5BF9\u8C61\u7684\u58F0\u660E\u5468\u671F\u8F83\u77ED\u3002</p><p>\u5B9E\u9645\u4F7F\u7528\u7684\u5806\u5185\u5B58\u662F\u65B0\u751F\u4EE3\u4E2D\u7684\u4E24\u4E2Asemispace\u7A7A\u95F4\u5927\u5C0F\u548C\u8001\u751F\u4EE3\u6240\u7528\u5185\u5B58\u5927\u5C0F\u4E4B\u548C\u3002</p><p>\u5F53\u4E00\u4E2A\u5BF9\u8C61\u7ECF\u8FC7\u591A\u6B21\u590D\u5236\u4F9D\u7136\u5B58\u6D3B\uFF0C\u5B83\u5C06\u4F1A\u88AB\u8BA4\u4E3A\u662F\u751F\u547D\u5468\u671F\u8F83\u957F\u7684\u5BF9\u8C61\uFF0C\u8FD9\u79CD\u8F83\u957F\u751F\u547D\u5468\u671F\u7684\u5BF9\u8C61\u968F\u540E\u88AB\u79FB\u52A8\u5230\u8001\u751F\u4EE3\u4E2D\uFF0C\u91C7\u7528\u65B0\u7684\u7B97\u6CD5\u8FDB\u884C\u7BA1\u7406\uFF0C\u8FD9\u79CD\u8FC7\u7A0B\u79F0\u4E3A<strong>\u664B\u5347</strong>\u3002</p><p>\u5728\u5355\u7EAF\u7684Scavenge\u8FC7\u7A0B\u4E2D\uFF0CFrom\u7A7A\u95F4\u4E2D\u7684\u5B58\u6D3B\u5BF9\u8C61\u4F1A\u88AB\u590D\u5236\u5230To\u7A7A\u95F4\u4E2D\u53BB\uFF0C\u7136\u540E\u5BF9From\u7A7A\u95F4\u548CTo\u7A7A\u95F4\u8FDB\u884C\u89D2\u8272\u5BF9\u6362\uFF08\u53C8\u79F0\u7FFB\u8F6C\uFF09\u3002</p><p>\u5BF9\u8C61\u664B\u5347\u7684\u6761\u4EF6\u4E00\u4E2A\u662F\u5BF9\u8C61\u662F\u5426\u7ECF\u5386\u8FC7Scavenge\u56DE\u6536\uFF0C\u4E00\u4E2A\u662FTo\u7A7A\u95F4\u7684\u5185\u5B58\u5360\u7528\u6BD4\u8D85\u8FC7\u9650\u5236\uFF08To\u7A7A\u95F4\u5360\u7528\u6BD4\u8D85\u8FC725%\uFF09\u3002</p><p>\u5728\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CV8\u7684\u5BF9\u8C61\u5206\u914D\u4E3B\u8981\u96C6\u4E2D\u5728From\u7A7A\u95F4\u4E2D\u3002\u5BF9\u8C61\u4ECEFrom\u7A7A\u95F4\u4E2D\u590D\u5236\u5230To\u7A7A\u95F4\u65F6\uFF0C\u4F1A\u68C0\u67E5\u5B83\u7684\u5185\u5B58\u5730\u5740\u6765\u5224\u65AD\u8FD9\u4E2A\u5BF9\u8C61\u662F\u5426\u5DF2\u7ECF\u7ECF\u5386\u8FC7\u4E00\u6B21Scavenge\u56DE\u6536\uFF0C\u5982\u679C\u5DF2\u7ECF\u7ECF\u5386\u8FC7\uFF0C\u4F1A\u5C06\u8BE5\u5BF9\u8C61\u4ECEFrom\u7A7A\u95F4\u590D\u5236\u5230\u8001\u751F\u4EE3\u7A7A\u95F4\u4E2D\uFF0C\u5982\u679C\u6CA1\u6709\uFF0C\u5219\u590D\u5236\u5230To\u7A7A\u95F4\u4E2D\u3002</p></li><li><p>Mark-Sweep &amp; Mark-compact</p><p>Mark-Sweep\u662F\u6807\u8BB0\u6E05\u9664\u7684\u610F\u601D\uFF0C\u5B83\u5206\u4E3A\u6807\u8BB0\u548C\u6E05\u9664\u4E24\u4E2A\u9636\u6BB5\u3002Mark-Sweep\u5728\u6807\u8BB0\u9636\u6BB5\u904D\u5386\u5806\u4E2D\u7684\u6240\u6709\u5BF9\u8C61\uFF0C\u5E76\u6807\u8BB0\u6D3B\u7740\u7684\u5BF9\u8C61\uFF0C\u5728\u968F\u540E\u7684\u6E05\u9664\u9636\u6BB5\u4E2D\uFF0C\u53EA\u6E05\u9664\u6CA1\u6709\u88AB\u6807\u8BB0\u7684\u5BF9\u8C61\u3002</p><p>Mark-Sweep\u6700\u5927\u7684\u95EE\u9898\u662F\u8FDB\u884C\u4E00\u6B21\u6807\u8BB0\u6E05\u9664\u56DE\u6536\u540E\uFF0C\u5185\u5B58\u7A7A\u95F4\u4F1A\u51FA\u73B0\u4E0D\u8FDE\u7EED\u7684\u72B6\u6001\uFF0C\u8FD9\u79CD\u5185\u5B58\u788E\u7247\u4F1A\u5BF9\u540E\u7EED\u7684\u5185\u5B58\u5206\u914D\u9020\u6210\u95EE\u9898\uFF0C\u56E0\u4E3A\u5F88\u53EF\u80FD\u51FA\u73B0\u9700\u8981\u5206\u914D\u4E00\u4E2A\u5927\u5BF9\u8C61\u7684\u60C5\u51B5\uFF0C\u8FD9\u65F6\u6240\u6709\u7684\u788E\u7247\u7A7A\u95F4\u90FD\u65E0\u6CD5\u5B8C\u6210\u6B64\u6B21\u5206\u914D\uFF0C\u5C31\u4F1A\u63D0\u524D\u89E6\u53D1\u5783\u573E\u56DE\u6536\uFF0C\u800C\u8FD9\u6B21\u56DE\u6536\u662F\u4E0D\u5FC5\u8981\u7684\u3002</p><p>Mark-Compact\u662F\u6807\u8BB0\u6574\u7406\u7684\u610F\u601D\uFF0C\u662F\u5728Mark-Sweep\u7684\u57FA\u7840\u4E0A\u6F14\u53D8\u800C\u6765\u7684\u3002\u4ED6\u4EEC\u7684\u5DEE\u522B\u5728\u4E8E\u5BF9\u8C61\u5728\u6807\u8BB0\u4E3A\u6B7B\u4EA1\u540E\uFF0C\u5728\u6574\u7406\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u5C06\u6216\u8005\u7684\u5BF9\u8C61\u5F80\u4E00\u7AEF\u79FB\u52A8\uFF0C\u79FB\u52A8\u5B8C\u6210\u540E\uFF0C\u76F4\u63A5\u6E05\u7406\u6389\u8FB9\u754C\u5916\u7684\u5185\u5B58\u3002</p><p>V8\u4E3B\u8981\u4F7F\u7528Mark-Sweep\uFF0C\u5728\u7A7A\u95F4\u4E0D\u8DB3\u4EE5\u5BF9\u4ECE\u65B0\u751F\u4EE3\u4E2D\u664B\u5347\u8FC7\u6765\u7684\u5BF9\u8C61\u8FDB\u884C\u5206\u914D\u65F6\u624D\u4F7F\u7528Mark-Compact\u3002</p></li><li><p>Incremental Marking</p><p>\u5783\u573E\u56DE\u6536\u76843\u4E2D\u57FA\u672C\u7B97\u6CD5\u90FD\u9700\u8981\u5C06\u5E94\u7528\u903B\u8F91\u6682\u505C\u4E0B\u6765\uFF0C\u5F85\u6267\u884C\u5B8C\u5783\u573E\u56DE\u6536\u540E\u518D\u6062\u590D\u6267\u884C\u5E94\u7528\u903B\u8F91\uFF0C\u8FD9\u79CD\u884C\u4E3A\u88AB\u79F0\u4E3A\u201C\u5168\u505C\u987F\u201D\u3002</p><p>\u4E3A\u4E86\u964D\u4F4E\u5168\u5806\u5783\u573E\u56DE\u6536\u5E26\u6765\u7684\u505C\u987F\u65F6\u95F4\uFF0CV8\u5148\u4ECE\u6807\u8BB0\u9636\u6BB5\u5165\u624B\uFF0C\u5C06\u539F\u672C\u8981\u4E00\u53E3\u6C14\u505C\u987F\u5B8C\u6210\u7684\u52A8\u4F5C\u6539\u4E3A\u589E\u91CF\u6807\u8BB0\uFF0C\u4E5F\u5C31\u662F\u62C6\u5206\u4E3A\u8BB8\u591A\u5C0F\u201C\u6B65\u8FDB\u201D\uFF0C\u6BCF\u505A\u5B8C\u4E00\u201C\u6B65\u8FDB\u201D\uFF0C\u5C31\u8BA9JavaScript\u5E94\u7528\u903B\u8F91\u6267\u884C\u4E00\u5C0F\u4F1A\u513F\uFF0C\u5783\u573E\u56DE\u6536\u4E0E\u5E94\u7528\u903B\u8F91\u4EA4\u66FF\u6267\u884C\u77E5\u9053\u6807\u8BB0\u9636\u6BB5\u5B8C\u6210\u3002</p><p>\u60F3\u8981\u9AD8\u6027\u80FD\u7684\u6267\u884C\u6548\u7387\uFF0C\u9700\u8981\u6CE8\u610F\u8BA9\u5783\u573E\u56DE\u6536\u5C3D\u91CF\u5C11\u5730\u8FDB\u884C\uFF0C\u5C24\u5176\u662F\u5168\u5806\u5783\u573E\u56DE\u6536\u3002</p></li></ul><h4 id="\u67E5\u770B\u5783\u573E\u56DE\u6536\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u5783\u573E\u56DE\u6536\u65E5\u5FD7" aria-hidden="true">#</a> \u67E5\u770B\u5783\u573E\u56DE\u6536\u65E5\u5FD7</h4><p>\u5728\u542F\u52A8\u65F6\u6DFB\u52A0<code>--trace_gc</code>\u53C2\u6570\u53EF\u4EE5\u67E5\u770B\u5783\u573E\u56DE\u6536\u65E5\u5FD7\u3002</p><p>\u5728\u542F\u52A8\u65F6\u6DFB\u52A0<code>--prof</code>\u53C2\u6570\u53EF\u4EE5\u5F97\u5230V8\u6267\u884C\u65F6\u7684\u6027\u80FD\u5206\u6790\u6570\u636E\u3002</p><h3 id="_5-2-\u9AD8\u6548\u4F7F\u7528\u5185\u5B58" tabindex="-1"><a class="header-anchor" href="#_5-2-\u9AD8\u6548\u4F7F\u7528\u5185\u5B58" aria-hidden="true">#</a> 5.2 \u9AD8\u6548\u4F7F\u7528\u5185\u5B58</h3><h4 id="\u4F5C\u7528\u57DF" tabindex="-1"><a class="header-anchor" href="#\u4F5C\u7528\u57DF" aria-hidden="true">#</a> \u4F5C\u7528\u57DF</h4><p>\u4F5C\u7528\u57DF\u4F1A\u89E6\u53D1\u5783\u573E\u56DE\u6536\u3002\u51FD\u6570\u5728\u6BCF\u6B21\u88AB\u8C03\u7528\u65F6\u4F1A\u521B\u5EFA\u5BF9\u5E94\u7684\u4F5C\u7528\u57DF\uFF0C\u51FD\u6570\u6267\u884C\u7ED3\u675F\u540E\uFF0C\u8BE5\u4F5C\u7528\u57DF\u5C06\u4F1A\u9500\u6BC1\uFF0C\u4F5C\u7528\u57DF\u4E2D\u58F0\u660E\u7684\u5C40\u90E8\u53D8\u91CF\u5206\u914D\u5728\u8BE5\u4F5C\u7528\u57DF\u4E0A\uFF0C\u968F\u4F5C\u7528\u57DF\u7684\u9500\u6BC1\u800C\u9500\u6BC1\uFF0C\u53EA\u88AB\u5C40\u90E8\u53D8\u91CF\u5F15\u7528\u7684\u5BF9\u8C61\u5B58\u6D3B\u5468\u671F\u8F83\u77ED\u3002</p><p>\u6807\u8BC6\u7B26\u67E5\u627E\u3002\u901A\u8FC7\u4F5C\u7528\u57DF\u94FE\u8FDB\u884C\u67E5\u627E\u3002\u5982\u679C\u53D8\u91CF\u662F\u5168\u5C40\u53D8\u91CF\uFF0C\u7531\u4E8E\u5168\u5C40\u4F5C\u7528\u57DF\u9700\u8981\u76F4\u5230\u8FDB\u7A0B\u9000\u51FA\u624D\u80FD\u91CA\u653E\uFF0C\u6B64\u65F6\u5C06\u5BFC\u81F4\u5F15\u7528\u7684\u5BF9\u8C61\u5E38\u9A7B\u5185\u5B58\uFF08\u8001\u751F\u4EE3\u4E2D\uFF09\uFF0C\u53EF\u4EE5\u901A\u8FC7delete\u6216\u8005\u5C06\u53D8\u91CF\u91CD\u65B0\u590D\u5236\u6765\u91CA\u653E\u5E38\u9A7B\u5185\u5B58\u7684\u5BF9\u8C61\u3002</p><h4 id="\u95ED\u5305" tabindex="-1"><a class="header-anchor" href="#\u95ED\u5305" aria-hidden="true">#</a> \u95ED\u5305</h4><p>\u5B9E\u73B0\u5916\u90E8\u4F5C\u7528\u57DF\u8BBF\u95EE\u5185\u90E8\u4F5C\u7528\u57DF\u4E2D\u53D8\u91CF\u7684\u65B9\u6CD5\u53EB\u505A\u95ED\u5305\uFF08closure\uFF09\u3002</p><p>\u4E00\u65E6\u6709\u53D8\u91CF\u5F15\u7528\u8FD9\u4E2A\u4E2D\u95F4\u51FD\u6570\uFF0C\u8FD9\u4E2A\u4E2D\u95F4\u51FD\u6570\u5C06\u4E0D\u4F1A\u91CA\u653E\uFF0C\u540C\u65F6\u4E5F\u4F1A\u4F7F\u539F\u59CB\u7684\u4F5C\u7528\u57DF\u4E0D\u4F1A\u5F97\u5230\u91CA\u653E\uFF0C\u4F5C\u7528\u57DF\u4E2D\u4EA7\u751F\u7684\u5185\u5B58\u5360\u7528\u4E5F\u4E0D\u4F1A\u5F97\u5230\u91CA\u653E\uFF0C\u9664\u975E\u4E0D\u518D\u6709\u5F15\u7528\uFF0C\u624D\u4F1A\u9010\u6B65\u91CA\u653E\u3002</p><h4 id="\u5C0F\u7ED3-1" tabindex="-1"><a class="header-anchor" href="#\u5C0F\u7ED3-1" aria-hidden="true">#</a> \u5C0F\u7ED3</h4><p>\u5728\u6B63\u5E38\u7684JavaScript\u6267\u884C\u4E2D\uFF0C\u65E0\u6CD5\u7ACB\u5373\u56DE\u6536\u7684\u5185\u5B58\u6709\u95ED\u5305\u548C\u5168\u5C40\u53D8\u91CF\u5F15\u7528\uFF0C\u7531\u4E8EV8\u7684\u5185\u5B58\u9650\u5236\uFF0C\u8981\u5341\u5206\u5C0F\u5FC3\u6B64\u7C7B\u53D8\u91CF\u662F\u5426\u65E0\u9650\u5236\u7684\u589E\u52A0\uFF0C\u56E0\u4E3A\u5B83\u4F1A\u5BFC\u81F4\u8001\u751F\u4EE3\u4E2D\u7684\u5BF9\u8C61\u589E\u591A\u3002</p><h3 id="_5-3-\u5185\u5B58\u6307\u6807" tabindex="-1"><a class="header-anchor" href="#_5-3-\u5185\u5B58\u6307\u6807" aria-hidden="true">#</a> 5.3 \u5185\u5B58\u6307\u6807</h3><h4 id="\u67E5\u770B\u5185\u5B58\u4F7F\u7528\u60C5\u51B5" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u5185\u5B58\u4F7F\u7528\u60C5\u51B5" aria-hidden="true">#</a> \u67E5\u770B\u5185\u5B58\u4F7F\u7528\u60C5\u51B5</h4><p>os\u6A21\u5757\u4E2D\u7684totalmem()\u548Cfreemem()\u65B9\u6CD5\u53EF\u4EE5\u67E5\u770B\u5185\u5B58\u7684\u4F7F\u7528\u60C5\u51B5\u3002</p><ol><li><p>\u67E5\u770B\u8FDB\u7A0B\u7684\u5185\u5B58\u5360\u7528</p><p>Process.meoryUsage()\u53EF\u4EE5\u67E5\u770BNode\u8FDB\u7A0B\u7684\u5185\u5B58\u5360\u7528\u60C5\u51B5\u3002</p><p>rss\u8868\u793A\u8FDB\u7A0B\u7684\u5E38\u9A7B\u5185\u5B58\u90E8\u5206\uFF0CheapUsed\u8868\u793A\u76EE\u524D\u5806\u4E2D\u4F7F\u7528\u4E2D\u7684\u5185\u5B58\u91CF\uFF0CheapTotal\u8868\u793A\u5806\u4E2D\u603B\u5171\u7533\u8BF7\u7684\u5185\u5B58\u91CF\u3002</p></li><li><p>\u67E5\u770B\u7CFB\u7EDF\u7684\u5185\u5B58\u5360\u7528</p><p>os\u6A21\u5757\u7684totalmem()\u8FD4\u56DE\u7CFB\u7EDF\u7684\u603B\u5185\u5B58\uFF0Cfreemem()\u8FD4\u56DE\u95F2\u7F6E\u5185\u5B58\u3002</p></li></ol><h4 id="\u5806\u5916\u5185\u5B58" tabindex="-1"><a class="header-anchor" href="#\u5806\u5916\u5185\u5B58" aria-hidden="true">#</a> \u5806\u5916\u5185\u5B58</h4><p>\u4E0D\u662F\u901A\u8FC7V8\u5206\u914D\u5F97\u5185\u5B58\u79F0\u4E3A\u5806\u5916\u5185\u5B58\u3002</p><p>Buffer\u5BF9\u8C61\u4E0D\u540C\u4E8E\u5176\u4ED6\u5BF9\u8C61\uFF0C\u5B83\u4E0D\u7ECF\u8FC7V8\u7684\u5185\u5B58\u5206\u914D\u673A\u5236\uFF0C\u4E0D\u4F1A\u6709\u5806\u5185\u5B58\u7684\u5927\u5C0F\u9650\u5236\u3002</p><h3 id="_5-4-\u5185\u5B58\u6CC4\u6F0F" tabindex="-1"><a class="header-anchor" href="#_5-4-\u5185\u5B58\u6CC4\u6F0F" aria-hidden="true">#</a> 5.4 \u5185\u5B58\u6CC4\u6F0F</h3><p>\u9020\u6210\u5185\u5B58\u6CC4\u6F0F\u7684\u539F\u56E0\u6709\uFF1A\u7F13\u5B58\u3002\u961F\u5217\u6D88\u8D39\u4E0D\u53CA\u65F6\u3002\u4F5C\u7528\u57DF\u672A\u91CA\u653E\u3002</p><h4 id="\u614E\u5C06\u5185\u5B58\u5F53\u505A\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#\u614E\u5C06\u5185\u5B58\u5F53\u505A\u7F13\u5B58" aria-hidden="true">#</a> \u614E\u5C06\u5185\u5B58\u5F53\u505A\u7F13\u5B58</h4><p>\u7F13\u5B58\u4E2D\u5B58\u50A8\u7684\u952E\u8D8A\u591A\uFF0C\u957F\u671F\u5B58\u6D3B\u7684\u5BF9\u8C61\u4E5F\u5C31\u8D8A\u591A\uFF0C\u8FD9\u5C06\u5BFC\u81F4\u5783\u573E\u56DE\u6536\u5728\u8FDB\u884C\u626B\u63CF\u548C\u6574\u7406\u65F6\uFF0C\u5BF9\u8FD9\u4E9B\u5BF9\u8C61\u505A\u65E0\u7528\u529F\u3002</p><p>\u4E25\u683C\u610F\u4E49\u7684\u7F13\u5B58\u6709\u7740\u5B8C\u5584\u7684\u8FC7\u671F\u7B56\u7565\uFF0C\u800C\u666E\u901A\u5BF9\u8C61\u7684\u952E\u503C\u5BF9\u6CA1\u6709\u3002</p><p>\u5728node\u4E2D\uFF0C\u4EFB\u4F55\u8BD5\u56FE\u62FF\u5185\u5B58\u5F53\u7F13\u5B58\u7684\u884C\u4E3A\u8981\u5C0F\u5FC3\u4E3A\u4E4B\u3002</p><ol><li><p>\u7F13\u5B58\u9650\u5236\u7B56\u7565</p><p>\u53EF\u4EE5\u901A\u8FC7\u9650\u5236\u6570\u91CF\u6765\u9650\u5236\u7F13\u5B58\u7684\u65E0\u9650\u589E\u957F\u3002</p><p>\u7531\u4E8E\u6A21\u5757\u7684\u7F13\u5B58\u673A\u5236\uFF0C\u6A21\u5757\u662F\u5E38\u9A7B\u8001\u751F\u4EE3\u7684\uFF0C\u5728\u8BBE\u8BA1\u6A21\u5757\u65F6\uFF0C\u8981\u5341\u5206\u5C0F\u5FC3\u5185\u5B58\u6CC4\u6F0F\uFF0C\u53EF\u4EE5\u6DFB\u52A0\u6E05\u7A7A\u961F\u5217\u7684\u63A5\u53E3\u4F9B\u8C03\u7528\u8005\u91CA\u653E\u5185\u5B58\u3002</p></li><li><p>\u7F13\u5B58\u7684\u89E3\u51B3\u65B9\u6848</p><p>\u76EE\u524D\u8F83\u597D\u7684\u89E3\u51B3\u65B9\u6848\u662F\u91C7\u7528\u8FDB\u7A0B\u5916\u7684\u7F13\u5B58\uFF0C\u8FDB\u7A0B\u81EA\u8EAB\u4E0D\u5B58\u50A8\u72B6\u6001\u3002\u5916\u90E8\u7684\u7F13\u5B58\u8F6F\u4EF6\u6709\u7740\u826F\u597D\u7684\u7F13\u5B58\u8FC7\u671F\u6DD8\u6C70\u7B56\u7565\u4EE5\u53CA\u81EA\u6709\u7684\u5185\u5B58\u7BA1\u7406\uFF0C\u4E0D\u5F71\u54CDNode\u8FDB\u7A0B\u7684\u6027\u80FD\uFF0C\u5B83\u53EF\u4EE5\u89E3\u51B3Node\u4E2D\u7684\u4E24\u4E2A\u95EE\u9898\uFF081\uFF09\u5C06\u7F13\u5B58\u8F6C\u79FB\u5230\u5916\u90E8\uFF0C\u51CF\u5C11\u5E38\u9A7B\u5185\u5B58\u7684\u5BF9\u8C61\u7684\u6570\u91CF\uFF0C\u8BA9\u5783\u573E\u56DE\u6536\u66F4\u9AD8\u6548\u3002\uFF082\uFF09\u8FDB\u7A0B\u4E4B\u95F4\u53EF\u4EE5\u5171\u4EAB\u7F13\u5B58\u3002</p><p>\u76EE\u524D\u5E02\u9762\u4E0A\u8F83\u597D\u7684\u7F13\u5B58\u6709Redis\u548CMemcached\u3002</p></li></ol><h4 id="\u5173\u6CE8\u961F\u5217\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u5173\u6CE8\u961F\u5217\u72B6\u6001" aria-hidden="true">#</a> \u5173\u6CE8\u961F\u5217\u72B6\u6001</h4><p>\u89E3\u51B3\u65B9\u6848\u662F\u76D1\u63A7\u961F\u5217\u7684\u957F\u5EA6\uFF0C\u4E00\u65E6\u5806\u79EF\uFF0C\u5E94\u5F53\u901A\u8FC7\u76D1\u63A7\u7CFB\u7EDF\u4EA7\u751F\u62A5\u8B66\u5E76\u901A\u77E5\u76F8\u5173\u4EBA\u5458\u3002</p><p>\u53E6\u4E00\u4E2A\u65B9\u6848\u662F\u4EFB\u610F\u5F02\u6B65\u8C03\u7528\u90FD\u5E94\u8BE5\u5305\u542B\u8D85\u65F6\u673A\u5236\uFF0C\u5982\u679C\u5728\u9650\u5B9A\u65F6\u95F4\u5185\u672A\u5B8C\u6210\u54CD\u5E94\uFF0C\u901A\u8FC7\u56DE\u8C03\u51FD\u6570\u4F20\u9012\u8D85\u65F6\u5F02\u5E38\u3002</p><h3 id="_5-5-\u5185\u5B58\u6CC4\u6F0F\u6392\u67E5" tabindex="-1"><a class="header-anchor" href="#_5-5-\u5185\u5B58\u6CC4\u6F0F\u6392\u67E5" aria-hidden="true">#</a> 5.5 \u5185\u5B58\u6CC4\u6F0F\u6392\u67E5</h3><p>\u5B9A\u4F4DNode\u5E94\u7528\u7684\u5185\u5B58\u6CC4\u6F0F\u5DE5\u5177\uFF1A</p><ul><li>v8-profiler\u3002</li><li><strong>node-heapdump\u3002</strong></li><li>node-mtrace\u3002</li><li>dtrace\u3002</li><li><strong>node-memwatch\u3002</strong></li></ul><h3 id="_5-6-\u5927\u5185\u5B58\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#_5-6-\u5927\u5185\u5B58\u5E94\u7528" aria-hidden="true">#</a> 5.6 \u5927\u5185\u5B58\u5E94\u7528</h3><p>Node\u63D0\u4F9B\u7684stream\u6A21\u5757\u89E3\u51B3\u64CD\u4F5C\u5927\u6587\u4EF6\u7684\u8BFB\u5199\u95EE\u9898\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">reader</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">in.txt</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">writer</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">out.txt</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="\u7B2C6\u7AE0-\u7406\u89E3buffer" tabindex="-1"><a class="header-anchor" href="#\u7B2C6\u7AE0-\u7406\u89E3buffer" aria-hidden="true">#</a> \u7B2C6\u7AE0 \u7406\u89E3Buffer</h2><p>Buffer\u5BF9\u8C61\u7528\u4E8E\u5904\u7406\u4E8C\u8FDB\u5236\u6570\u636E\u3002</p><h3 id="_6-1-buffer\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_6-1-buffer\u7ED3\u6784" aria-hidden="true">#</a> 6.1 Buffer\u7ED3\u6784</h3><h4 id="\u6A21\u5757\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u6A21\u5757\u7ED3\u6784" aria-hidden="true">#</a> \u6A21\u5757\u7ED3\u6784</h4><p>Buffer\u7684\u6027\u80FD\u76F8\u5173\u90E8\u5206\u7528C++\u5B9E\u73B0\uFF0C\u975E\u6027\u80FD\u90E8\u5206\u7528JavaScript\u5B9E\u73B0\u3002</p><p>Buffer\u6240\u5360\u7528\u7684\u5185\u5B58\u4E0D\u662F\u901A\u8FC7V8\u5206\u914D\u5F97\uFF0C\u5C5E\u4E8E\u5806\u5916\u5185\u5B58\u3002</p><h4 id="buffer\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#buffer\u5BF9\u8C61" aria-hidden="true">#</a> Buffer\u5BF9\u8C61</h4><p>Buffer\u5BF9\u8C61\u7C7B\u4F3C\u4E8E\u6570\u7EC4\uFF0C\u5B83\u7684\u5143\u7D20\u4E3A16\u8FDB\u5236\u7684\u4E24\u4F4D\u6570\u3002</p><p>\u53EF\u4EE5\u901A\u8FC7length\u5C5E\u6027\u5F97\u5230\u957F\u5EA6\uFF0C\u901A\u8FC7\u4E0B\u6807\u8BBF\u95EE\u5143\u7D20\u3002</p><h4 id="buffer\u5185\u5B58\u5206\u914D" tabindex="-1"><a class="header-anchor" href="#buffer\u5185\u5B58\u5206\u914D" aria-hidden="true">#</a> Buffer\u5185\u5B58\u5206\u914D</h4><p>Node\u5728\u5185\u5B58\u7684\u4F7F\u7528\u4E0A\u5E94\u7528\u7684\u662F\u5728C++\u5C42\u9762\u7533\u8BF7\u5185\u5B58\u3001\u5728JavaScript\u4E2D\u5206\u914D\u5185\u5B58\u7684\u7B56\u7565\u3002</p><p>Node\u4E2D\u91C7\u7528\u4E86slab\u5206\u914D\u673A\u5236\uFF0Cslab\u662F\u4E00\u79CD\u52A8\u6001\u5185\u5B58\u7BA1\u7406\u673A\u5236\u3002</p><p>slab\u6709\u5982\u4E0B3\u4E2D\u72B6\u6001</p><ul><li>full\uFF1A\u5B8C\u5168\u5206\u914D\u72B6\u6001\u3002</li><li>partial\uFF1A\u90E8\u5206\u5206\u914D\u72B6\u6001\u3002</li><li>empty\uFF1A\u6CA1\u6709\u88AB\u5206\u914D\u72B6\u6001\u3002</li></ul><p>Node\u4EE58KB\u4E3A\u754C\u9650\u6765\u533A\u5206Buffer\u662F\u5927\u5BF9\u8C61\u8FD8\u662F\u5C0F\u5BF9\u8C61\u3002\u8FD9\u4E2A8KB\u7684\u503C\u4E5F\u5C31\u662F\u6BCF\u4E2Aslab\u7684\u5927\u5C0F\u503C\uFF0C\u5728JavaScript\u5C42\u9762\uFF0C\u4EE5\u5B83\u4F5C\u4E3A\u5355\u4F4D\u5355\u5143\u8FDB\u884C\u5185\u5B58\u7684\u5206\u914D\u3002</p><p><strong>1.\u5206\u914D\u5C0FBuffer\u5BF9\u8C61</strong></p><p>Buffer\u7684\u5206\u914D\u8FC7\u7A0B\u4E2D\u4E3B\u8981\u4F7F\u7528\u4E00\u4E2A\u5C40\u90E8\u53D8\u91CFpool\u4F5C\u4E3A\u4E2D\u95F4\u5904\u7406\u5BF9\u8C61\uFF0C\u5904\u4E8E\u5206\u914D\u72B6\u6001\u7684slab\u5355\u5143\u90FD\u6307\u5411\u5B83\u3002</p><p><code>new Buffer(1024);</code>\u6784\u9020\u5C06\u4F1A\u53BB\u68C0\u67E5pool\u5BF9\u8C61\uFF0C\u5982\u679Cpool\u6CA1\u6709\u5219\u4F1A\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684slab\u5355\u5143\u6307\u5411\u5B83\uFF0C\u540C\u65F6\u5F53\u524DBuffer\u5BF9\u8C61\u7684parent\u5C5E\u6027\u6307\u5411\u8BE5slab\uFF0C\u5E76\u8BB0\u5F55\u4E0B\u662F\u4ECE\u8FD9\u4E2Aslab\u7684\u54EA\u4E2A\u4F4D\u7F6E\uFF08offset\uFF09\u5F00\u59CB\u4F7F\u7528\u7684\uFF0Cslab\u5BF9\u8C61\u81EA\u8EAB\u4E5F\u8BB0\u5F55\u88AB\u4F7F\u7528\u4E86\u591A\u5C11\u5B57\u8282\u3002</p><p>\u5F53\u518D\u521B\u5EFA\u4E00\u4E2ABuffer\u5BF9\u8C61\u65F6\uFF0C\u5982\u679C\u8FD9\u4E2Aslab\u7684\u5269\u4F59\u7A7A\u95F4\u8DB3\u591F\u5219\u4F7F\u7528\u8FD9\u4E2Aslab\u7684\u5269\u4F59\u7A7A\u95F4\u5E76\u66F4\u65B0\u5206\u914D\u72B6\u6001\uFF0C\u5982\u679C\u4E0D\u591F\u5219\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684slab\u5E76\u4F7F\u7528\uFF0C\u7B2C\u4E00\u4E2Aslab\u5269\u4F59\u7684\u7A7A\u95F4\u5C06\u9020\u6210\u6D6A\u8D39\u3002</p><p>\u7531\u4E8E\u540C\u4E00\u4E2Aslab\u53EF\u80FD\u5206\u914D\u7ED9\u591A\u4E2ABuffer\u5BF9\u8C61\u4F7F\u7528\uFF0C\u53EA\u6709\u8FD9\u4E9B\u5C0FBuffer\u5BF9\u8C61\u5728\u4F5C\u7528\u57DF\u91CA\u653E\u5E76\u90FD\u53EF\u4EE5\u56DE\u6536\u65F6\uFF0Cslab\u76848KB\u7A7A\u95F4\u624D\u4F1A\u88AB\u56DE\u6536\u3002</p><p><strong>2.\u5206\u914D\u5927Buffer\u5BF9\u8C61</strong></p><p>\u8D85\u8FC78KB\u7684Buffer\u5BF9\u8C61\u5C06\u4F1A\u76F4\u63A5\u5206\u914D\u4E00\u4E2ASlowBuffer\u5BF9\u8C61\u4F5C\u4E3Aslab\u5355\u5143\uFF0C\u8FD9\u4E2Aslab\u5355\u5143\u5C06\u4F1A\u88AB\u8FD9\u4E2A\u5927Buffer\u5BF9\u8C61\u72EC\u5360\u3002</p><p>\u4E0A\u9762\u63D0\u5230\u7684Buffer\u5BF9\u8C61\u90FD\u662FJavaScript\u5C42\u9762\u7684\uFF0C\u80FD\u591F\u88ABV8\u7684\u5783\u573E\u56DE\u6536\u6807\u8BB0\u56DE\u6536\uFF0C\u4F46\u662F\u5176\u5185\u90E8\u7684parent\u5C5E\u6027\u6307\u5411\u7684SlowBuffer\u5BF9\u8C61\u5374\u6765\u81EA\u4E8ENode\u81EA\u8EABC++\u4E2D\u7684\u5B9A\u4E49\uFF0C\u662FC++\u5C42\u9762\u4E0A\u7684Buffer\u72EC\u4EAB\uFF0C\u6240\u7528\u5185\u5B58\u4E0D\u5728V8\u7684\u5806\u4E2D\u3002</p><h3 id="_6-2-buffer\u7684\u8F6C\u6362" tabindex="-1"><a class="header-anchor" href="#_6-2-buffer\u7684\u8F6C\u6362" aria-hidden="true">#</a> 6.2 Buffer\u7684\u8F6C\u6362</h3><p>Buffer\u5BF9\u8C61\u53EF\u4EE5\u4E0E\u5B57\u7B26\u4E32\u4E4B\u95F4\u4E92\u76F8\u8F6C\u6362\uFF0C\u76EE\u524D\u652F\u6301\u7684\u5B57\u7B26\u4E32\u7F16\u7801\u7C7B\u578B\u6709\uFF1A</p><ul><li>ASCII</li><li>UTF-8</li><li>UTF-16LE/UCS-2</li><li>Base64</li><li>Binary</li><li>Hex</li></ul><h4 id="\u5B57\u7B26\u4E32\u8F6Cbuffer" tabindex="-1"><a class="header-anchor" href="#\u5B57\u7B26\u4E32\u8F6Cbuffer" aria-hidden="true">#</a> \u5B57\u7B26\u4E32\u8F6CBuffer</h4><p><code>new Buffer(str, [encoding]);</code></p><p>\u901A\u8FC7\u6784\u9020\u51FD\u6570\u8F6C\u6362\u7684Buffer\u5BF9\u8C61\uFF0C\u5B58\u50A8\u7684\u53EA\u80FD\u662F\u4E00\u79CD\u7F16\u7801\u7C7B\u578B\u3002encoding\u53C2\u6570\u4E0D\u4F20\u9012\u65F6\uFF0C\u9ED8\u8BA4\u6309UTF-8\u7F16\u7801\u8FDB\u884C\u8F6C\u7801\u548C\u5B58\u50A8\u3002</p><p>Buffer\u5BF9\u8C61\u4E2D\u53EF\u4EE5\u5B58\u5728\u591A\u79CD\u7F16\u7801\u8F6C\u5316\u540E\u7684\u5185\u5BB9\u3002\u4E0D\u8FC7\u6BCF\u79CD\u7F16\u7801\u6240\u7528\u7684\u5B57\u8282\u957F\u5EA6\u4E0D\u540C\uFF0C\u5C06Buffer\u53CD\u8F6C\u56DE\u5B57\u7B26\u4E32\u65F6\u9700\u8981\u8C28\u614E\u5904\u7406\u3002</p><h4 id="buffer\u8F6C\u5B57\u7B26\u4E32" tabindex="-1"><a class="header-anchor" href="#buffer\u8F6C\u5B57\u7B26\u4E32" aria-hidden="true">#</a> Buffer\u8F6C\u5B57\u7B26\u4E32</h4><p>Buffer\u5BF9\u8C61\u8C03\u7528toString()\u65B9\u6CD5\u53EF\u4EE5\u8F6C\u4E3A\u5B57\u7B26\u4E32\u3002</p><p><code>buf.toString([encoding],[start],[end]);</code></p><h4 id="buffer\u4E0D\u652F\u6301\u7684\u7F16\u7801\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#buffer\u4E0D\u652F\u6301\u7684\u7F16\u7801\u7C7B\u578B" aria-hidden="true">#</a> Buffer\u4E0D\u652F\u6301\u7684\u7F16\u7801\u7C7B\u578B</h4><p><code>isEncoding()</code>\u51FD\u6570\u5224\u65AD\u7F16\u7801\u662F\u5426\u652F\u6301\u8F6C\u6362\u3002</p><p>iconv\u548Ciconv-lite\u4E24\u4E2A\u6A21\u5757\u652F\u6301\u66F4\u591A\u7684\u7F16\u7801\u7C7B\u578B\u8F6C\u6362\u3002</p><h3 id="_6-3-buffer\u7684\u62FC\u63A5" tabindex="-1"><a class="header-anchor" href="#_6-3-buffer\u7684\u62FC\u63A5" aria-hidden="true">#</a> 6.3 Buffer\u7684\u62FC\u63A5</h3><h4 id="\u4E71\u7801\u662F\u5982\u4F55\u4EA7\u751F\u7684" tabindex="-1"><a class="header-anchor" href="#\u4E71\u7801\u662F\u5982\u4F55\u4EA7\u751F\u7684" aria-hidden="true">#</a> \u4E71\u7801\u662F\u5982\u4F55\u4EA7\u751F\u7684</h4><p>\u5BF9\u4E8E\u4EFB\u610F\u957F\u5EA6\u7684Buffer\u800C\u8A00\uFF0C\u5BBD\u5B57\u8282\u5B57\u7B26\u4E32\u90FD\u6709\u53EF\u80FD\u5B58\u5728\u88AB\u622A\u65AD\u7684\u60C5\u51B5\uFF0C\u53EA\u4E0D\u8FC7Buffer\u7684\u957F\u5EA6\u8D8A\u5927\u51FA\u73B0\u7684\u6982\u7387\u8D8A\u4F4E\u800C\u5DF2\u3002</p><h4 id="setencoding-\u4E0Estring-decoder" tabindex="-1"><a class="header-anchor" href="#setencoding-\u4E0Estring-decoder" aria-hidden="true">#</a> setEncoding()\u4E0Estring_decoder()</h4><p>setEncoding()\u8BBE\u7F6E\u7F16\u7801\u683C\u5F0F</p><p>string_decoder()\u53EF\u4EE5\u81EA\u52A8\u8FDB\u884C\u6574\u6570\u500D\u5B57\u8282\u8FDB\u884C\u8F6C\u7801\uFF0C\u76EE\u524D\u53EF\u4EE5\u5904\u7406UTF-8\u3001Base64\u548CUCS-2/UTF-16LE\u3002</p><h4 id="\u6B63\u786E\u7684\u62FC\u63A5buffer" tabindex="-1"><a class="header-anchor" href="#\u6B63\u786E\u7684\u62FC\u63A5buffer" aria-hidden="true">#</a> \u6B63\u786E\u7684\u62FC\u63A5Buffer</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">chunks</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> []</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">size</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">chunks</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">push</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">chunk</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">size</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">buf</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">concat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">chunks</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">size</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">str</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">iconv</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">decode</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buf</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">str</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="buffer\u4E0E\u6027\u80FD" tabindex="-1"><a class="header-anchor" href="#buffer\u4E0E\u6027\u80FD" aria-hidden="true">#</a> Buffer\u4E0E\u6027\u80FD</h4><p>\u63D0\u9AD8\u5B57\u7B26\u4E32\u8F6CBuffer\u7684\u8F6C\u6362\u6548\u7387\uFF0C\u53EF\u4EE5\u5F88\u5927\u7A0B\u5EA6\u63D0\u9AD8\u7F51\u7EDC\u541E\u5410\u7387\u3002</p><p>\u901A\u8FC7\u9884\u5148\u8F6C\u6362\u9759\u6001\u5185\u5BB9\u4E3ABuffer\u5BF9\u8C61\uFF0C\u53EF\u4EE5\u6709\u6548\u5730\u51CF\u5C11CPU\u7684\u91CD\u590D\u4F7F\u7528\uFF0C\u8282\u7701\u670D\u52A1\u5668\u8D44\u6E90\u3002</p><p>\u5728Node\u6784\u5EFA\u7684Web\u5E94\u7528\u4E2D\uFF0C\u53EF\u4EE5\u9009\u62E9\u5C06\u9875\u9762\u4E2D\u7684\u52A8\u6001\u5185\u5BB9\u548C\u9759\u6001\u5185\u5BB9\u5206\u79BB\uFF0C\u9759\u6001\u5185\u5BB9\u90E8\u5206\u53EF\u4EE5\u901A\u8FC7\u9884\u5148\u8F6C\u6362\u4E3ABuffer\u7684\u65B9\u5F0F\uFF0C\u4F7F\u6027\u80FD\u5F97\u5230\u63D0\u5347\u3002\u6587\u4EF6\u81EA\u8EAB\u662F\u4E8C\u8FDB\u5236\u6570\u636E\uFF0C\u5728\u4E0D\u9700\u8981\u6539\u53D8\u5185\u5BB9\u7684\u573A\u666F\u4E0B\uFF0C\u5C3D\u91CF\u53EA\u8BFB\u53D6Buffer\uFF0C\u7136\u540E\u76F4\u63A5\u4F20\u8F93\uFF0C\u4E0D\u505A\u989D\u5916\u7684\u8F6C\u6362\uFF0C\u907F\u514D\u635F\u8017\u3002</p><p><code>fs.createReadStream()</code>\u7684\u5DE5\u4F5C\u65B9\u5F0F\u662F\u5728\u5185\u5B58\u4E2D\u51C6\u5907\u4E00\u6BB5Buffer\uFF0C\u7136\u540E\u5728<code>fs.read()</code>\u8BFB\u53D6\u65F6\u9010\u6B65\u4ECE\u78C1\u76D8\u4E2D\u5C06\u5B57\u8282\u590D\u5236\u5230Buffer\u4E2D\u3002</p><p>highWaterMark\u7684\u5927\u5C0F\u5BF9\u6027\u80FD\u6709\u4E24\u4E2A\u5F71\u54CD\u7684\u70B9\uFF1A</p><ul><li>highWaterMark\u8BBE\u7F6E\u5BF9Buffer\u5185\u5B58\u7684\u5206\u914D\u548C\u4F7F\u7528\u6709\u4E00\u5B9A\u5F71\u54CD\u3002</li><li>highWaterMark\u8BBE\u7F6E\u8FC7\u5C0F\uFF0C\u53EF\u80FD\u5BFC\u81F4\u7CFB\u7EDF\u8C03\u7528\u6B21\u6570\u8FC7\u591A\u3002</li></ul><p>highWaterMark\u7684\u5927\u5C0F\u51B3\u5B9A\u4F1A\u89E6\u53D1\u7CFB\u7EDF\u8C03\u7528\u548Cdata\u4E8B\u4EF6\u7684\u6B21\u6570\u3002</p><h2 id="\u7B2C7\u7AE0-\u7F51\u7EDC\u7F16\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u7B2C7\u7AE0-\u7F51\u7EDC\u7F16\u7A0B" aria-hidden="true">#</a> \u7B2C7\u7AE0 \u7F51\u7EDC\u7F16\u7A0B</h2><p>Node\u4E2D\u53EA\u9700\u8981\u51E0\u884C\u4EE3\u7801\u5373\u53EF\u6784\u5EFA\u670D\u52A1\u5668\uFF0C\u65E0\u9700\u989D\u5916\u7684\u5BB9\u5668\u3002</p><p>Node\u63D0\u4F9Bnet\u3001dgram\u3001http\u3001https\u8FD94\u4E2A\u6A21\u5757\uFF0C\u5206\u522B\u7528\u4E8E\u5904\u7406TCP\u3001UDP\u3001HTTP\u3001HTTPS\uFF0C\u9002\u7528\u4E8E\u670D\u52A1\u5668\u7AEF\u548C\u5BA2\u6237\u7AEF\u3002</p><h3 id="_7-1-\u6784\u5EFAtcp\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_7-1-\u6784\u5EFAtcp\u670D\u52A1" aria-hidden="true">#</a> 7.1 \u6784\u5EFATCP\u670D\u52A1</h3><h4 id="tcp" tabindex="-1"><a class="header-anchor" href="#tcp" aria-hidden="true">#</a> TCP</h4><p>TCP\u5168\u540D\u4E3A\u4F20\u8F93\u63A7\u5236\u534F\u8BAE\uFF0C\u5728OSI\u6A21\u578B\uFF08\u7269\u7406\u5C42\u3001\u6570\u636E\u94FE\u8DEF\u5C42\u3001\u7F51\u7EDC\u5C42\u3001\u4F20\u8F93\u5C42\u3001\u4F1A\u8BDD\u5C42\u3001\u8868\u793A\u5C42\u3001\u5E94\u7528\u5C42\uFF09\u4E2D\u5C5E\u4E8E\u4F20\u8F93\u5C42\u534F\u8BAE\u3002</p><h4 id="\u521B\u5EFAtcp\u670D\u52A1\u5668\u7AEF" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAtcp\u670D\u52A1\u5668\u7AEF" aria-hidden="true">#</a> \u521B\u5EFATCP\u670D\u52A1\u5668\u7AEF</h4><p>net\u6A21\u5757<code>net.createServer()</code></p><h4 id="tcp\u670D\u52A1\u7684\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#tcp\u670D\u52A1\u7684\u4E8B\u4EF6" aria-hidden="true">#</a> TCP\u670D\u52A1\u7684\u4E8B\u4EF6</h4><p><strong>1.\u670D\u52A1\u5668\u4E8B\u4EF6</strong></p><p><code>net.createServer()</code>\u662F\u4E00\u4E2AEventEmitter\u5B9E\u4F8B\uFF0C\u5B83\u7684\u81EA\u5B9A\u4E49\u4E8B\u4EF6\u6709\u5982\u4E0B\u51E0\u79CD\uFF1A</p><ul><li>listening\uFF1A\u5728\u8C03\u7528server.listen()\u6216\u8005Domain Socket\u89E6\u53D1\u3002</li><li>connection\uFF1A\u6BCF\u4E2A\u5BA2\u6237\u7AEF\u5957\u63A5\u5B57\u8FDE\u63A5\u5230\u670D\u52A1\u5668\u7AEF\u65F6\u89E6\u53D1\u3002</li><li>close\uFF1A\u5F53\u670D\u52A1\u5668\u5173\u95ED\u65F6\u89E6\u53D1\uFF0C\u5728\u8C03\u7528server.close()\u540E\uFF0C\u670D\u52A1\u5668\u5C06\u505C\u6B62\u63A5\u53D7\u65B0\u7684\u5957\u63A5\u5B57\u8FDE\u63A5\uFF0C\u4F46\u4FDD\u6301\u5F53\u524D\u5B58\u5728\u7684\u8FDE\u63A5\uFF0C\u7B49\u5F85\u6240\u6709\u8FDE\u63A5\u90FD\u65AD\u5F00\u540E\uFF0C\u4F1A\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>error\uFF1A\u5F53\u670D\u52A1\u5668\u53D1\u751F\u5F02\u5E38\u65F6\uFF0C\u4F1A\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li></ul><p><strong>2.\u8FDE\u63A5\u4E8B\u4EF6</strong></p><p>\u670D\u52A1\u5668\u53EF\u4EE5\u540C\u65F6\u4E0E\u591A\u4E2A\u5BA2\u6237\u7AEF\u4FDD\u6301\u8FDE\u63A5\uFF0C\u6BCF\u4E2A\u8FDE\u63A5\u662F\u53EF\u8BFB\u53EF\u5199Stream\u5BF9\u8C61\u3002Stream\u5BF9\u8C61\u7528\u4E8E\u670D\u52A1\u5668\u7AEF\u548C\u5BA2\u6237\u7AEF\u4E4B\u95F4\u7684\u901A\u4FE1\u3002</p><ul><li>data\uFF1A\u5F53\u4E00\u7AEF\u8C03\u7528write()\u53D1\u9001\u6570\u636E\u65F6\uFF0C\u53E6\u4E00\u7AEF\u4F1A\u89E6\u53D1data\u4E8B\u4EF6\uFF0C\u4E8B\u4EF6\u4F20\u9012\u7684\u6570\u636E\u5373\u662Fwrite()\u53D1\u9001\u7684\u6570\u636E\u3002</li><li>end\uFF1A\u5F53\u8FDE\u63A5\u4E2D\u7684\u4EFB\u610F\u4E00\u6BB5\u53D1\u9001\u4E86FIN\u6570\u636E\u65F6\uFF0C\u5C06\u4F1A\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>connect\uFF1A\u8BE5\u4E8B\u4EF6\u7528\u4E8E\u5BA2\u6237\u7AEF\uFF0C\u5F53\u5957\u63A5\u5B57\u4E0E\u670D\u52A1\u5668\u8FDE\u63A5\u6210\u529F\u65F6\u4F1A\u88AB\u89E6\u53D1\u3002</li><li>drain\uFF1A\u5F53\u4EFB\u610F\u4E00\u7AEF\u8C03\u7528write()\u53D1\u9001\u6570\u636E\u65F6\uFF0C\u5F53\u524D\u8FD9\u7AEF\u4F1A\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>error\uFF1A\u5F53\u5F02\u5E38\u53D1\u751F\u65F6\uFF0C\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>close\uFF1A\u5F53\u5957\u63A5\u5B57\u5B8C\u5168\u5173\u95ED\u65F6\uFF0C\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>timeout\uFF1A\u5F53\u4E00\u5B9A\u65F6\u95F4\u540E\u8FDE\u63A5\u4E0D\u518D\u6D3B\u8DC3\u65F6\uFF0C\u8BE5\u4E8B\u4EF6\u5C06\u4F1A\u88AB\u89E6\u53D1\uFF0C\u901A\u77E5\u7528\u6237\u5F53\u524D\u8FDE\u63A5\u5DF2\u7ECF\u88AB\u95F2\u7F6E\u4E86\u3002</li></ul><p>Node\u4E2DTCP\u9ED8\u8BA4\u91C7\u7528\u4E86Nagle\u7B97\u6CD5\u6765\u5BF9\u5C0F\u6570\u636E\u5305\u8FDB\u884C\u4E00\u5B9A\u7684\u4F18\u5316\uFF0CNagle\u7B97\u6CD5\u8981\u6C42\u7F13\u51B2\u533A\u7684\u6570\u636E\u8FBE\u5230\u4E00\u5B9A\u6570\u91CF\u6216\u8005\u4E00\u5B9A\u65F6\u95F4\u540E\u624D\u5C06\u5176\u53D1\u51FA\u3002</p><p>\u8C03\u7528<code>socket.setNoDelay(true)</code>\u53BB\u6389Nagle\u7B97\u6CD5\u3002</p><h3 id="_7-2-\u6784\u5EFAudp\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_7-2-\u6784\u5EFAudp\u670D\u52A1" aria-hidden="true">#</a> 7.2 \u6784\u5EFAUDP\u670D\u52A1</h3><p>\u5728UDP\u4E2D\uFF0C\u4E00\u4E2A\u5957\u63A5\u5B57\u53EF\u4EE5\u4E0E\u591A\u4E2AUDP\u670D\u52A1\u901A\u4FE1\u3002</p><h4 id="\u521B\u5EFAudp\u5957\u63A5\u5B57" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAudp\u5957\u63A5\u5B57" aria-hidden="true">#</a> \u521B\u5EFAUDP\u5957\u63A5\u5B57</h4><p>UDP\u5957\u63A5\u5B57\u4E00\u65E6\u521B\u5EFA\uFF0C\u65E2\u53EF\u4EE5\u4F5C\u4E3A\u5BA2\u6237\u7AEF\u53D1\u9001\u6570\u636E\uFF0C\u4E5F\u53EF\u4EE5\u4F5C\u4E3A\u670D\u52A1\u5668\u7AEF\u63A5\u6536\u6570\u636E\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">dgram</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">dgram</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">socket</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">dgram</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createSocket</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">udp4</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="\u521B\u5EFAudp\u670D\u52A1\u5668\u7AEF" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAudp\u670D\u52A1\u5668\u7AEF" aria-hidden="true">#</a> \u521B\u5EFAUDP\u670D\u52A1\u5668\u7AEF</h4><p>\u8C03\u7528<code>dgram.bind(port, [address])</code>\u65B9\u6CD5\u5BF9\u7F51\u5361\u548C\u7AEF\u53E3\u8FDB\u884C\u7ED1\u5B9A\u5373\u53EF\u3002</p><h4 id="\u521B\u5EFAudp\u5BA2\u6237\u7AEF" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAudp\u5BA2\u6237\u7AEF" aria-hidden="true">#</a> \u521B\u5EFAUDP\u5BA2\u6237\u7AEF</h4><p>\u8C03\u7528<code>socket.send(buf,offset,length,port,address,[callback])</code>\u53D1\u9001\u6570\u636E\u3002</p><p>\u53C2\u6570\u5206\u522B\u662F\u8981\u53D1\u9001\u7684Buffer\u3001Buffer\u7684\u504F\u79FB\u3001Buffer\u7684\u957F\u5EA6\u3001\u76EE\u6807\u7AEF\u53E3\uFF0C\u76EE\u6807\u5730\u5740\u3001\u53D1\u9001\u5B8C\u6210\u540E\u7684\u56DE\u8C03\u3002</p><h4 id="udp\u5957\u63A5\u5B57\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#udp\u5957\u63A5\u5B57\u4E8B\u4EF6" aria-hidden="true">#</a> UDP\u5957\u63A5\u5B57\u4E8B\u4EF6</h4><p>UDP\u5957\u63A5\u5B57\u662F\u4E00\u4E2AEventEmitter\u7684\u4E8B\u4F8B\u3002</p><ul><li>message\uFF1A\u5F53UDP\u5957\u63A5\u5B57\u4FA6\u542C\u7F51\u5361\u7AEF\u53E3\u540E\uFF0C\u63A5\u6536\u5230\u6D88\u606F\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\uFF0C\u89E6\u53D1\u643A\u5E26\u7684\u6570\u636E\u4E3A\u6D88\u606FBuffer\u5BF9\u8C61\u548C\u4E00\u4E2A\u8FDC\u7A0B\u5730\u5740\u4FE1\u606F\u3002</li><li>listening\uFF1A\u5F53UDP\u5957\u63A5\u5B57\u5F00\u59CB\u4FA6\u542C\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>close\uFF1A\u8C03\u7528close()\u65B9\u6CD5\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\uFF0C\u5E76\u4E0D\u518D\u89E6\u53D1message\u4E8B\u4EF6\u3002\u5982\u9700\u518D\u6B21\u89E6\u53D1message\u4E8B\u4EF6\uFF0C\u91CD\u65B0\u7ED1\u5B9A\u5373\u53EF\u3002</li><li>error\uFF1A\u5F53\u5F02\u5E38\u53D1\u751F\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\uFF0C\u5982\u679C\u4E0D\u4FA6\u542C\uFF0C\u76F4\u63A5\u629B\u51FA\u5F02\u5E38\uFF0C\u4F7F\u8FDB\u7A0B\u9000\u51FA\u3002</li></ul><h3 id="_7-3-\u6784\u5EFAhttp\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_7-3-\u6784\u5EFAhttp\u670D\u52A1" aria-hidden="true">#</a> 7.3 \u6784\u5EFAHTTP\u670D\u52A1</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">http</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">http</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9;">http</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createServer</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeHead</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">200</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Content-Type</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">text/plain</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Hello World</span><span style="color:#EBCB8B;">\\n</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1337</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">127.0.0.1</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="http" tabindex="-1"><a class="header-anchor" href="#http" aria-hidden="true">#</a> HTTP</h4><p>HTTP\u6784\u5EFA\u5728TCP\u4E4B\u4E0A\uFF0C\u5C5E\u4E8E\u5E94\u7528\u5C42\u534F\u8BAE\u3002<strong>B/S\u6A21\u5F0F</strong>\u3002</p><p>\u6D4F\u89C8\u5668\uFF0C\u5176\u5B9E\u662F\u4E00\u4E2AHTTP\u7684\u4EE3\u7406\u3002</p><h4 id="http\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#http\u6A21\u5757" aria-hidden="true">#</a> http\u6A21\u5757</h4><p>\u5728Node\u4E2D\uFF0CHTTP\u670D\u52A1\u7EE7\u627F\u81EATCP\u670D\u52A1\u5668\uFF08net\u6A21\u5757\uFF09\u3002</p><p>\u5728\u5F00\u542Fkeep-alive\u540E\uFF0C\u4E00\u4E2ATCP\u4F1A\u8BDD\u53EF\u4EE5\u7528\u4E8E\u591A\u6B21\u8BF7\u6C42\u548C\u54CD\u5E94\u3002</p><p>TCP\u670D\u52A1\u4EE5connection\u4E3A\u5355\u4F4D\u8FDB\u884C\u670D\u52A1\uFF0CHTTP\u670D\u52A1\u4EE5request\u4E3A\u5355\u4F4D\u8FDB\u884C\u670D\u52A1\u3002http\u6A21\u5757\u5373\u662F\u5C06connection\u5230request\u7684\u8FC7\u7A0B\u8FDB\u884C\u4E86\u5C01\u88C5\u3002</p><p>\u5728\u8BF7\u6C42\u4EA7\u751F\u7684\u8FC7\u7A0B\u4E2D\uFF0Chttp\u6A21\u5757\u62FF\u5230\u8FDE\u63A5\u4E2D\u4F20\u6765\u7684\u6570\u636E\uFF0C\u8C03\u7528\u4E8C\u8FDB\u5236\u6A21\u5757http_parser\u8FDB\u884C\u89E3\u6790\uFF0C\u5728\u89E3\u6790\u5B8C\u8BF7\u6C42\u62A5\u6587\u7684\u62A5\u5934\u540E\uFF0C\u89E6\u53D1request\u4E8B\u4EF6\uFF0C\u8C03\u7528\u7528\u6237\u7684\u4E1A\u52A1\u903B\u8F91\u3002</p><ol><li><p>HTTP\u8BF7\u6C42</p><p>\u8BF7\u6C42\u5934\u653E\u5728\u5728req.headers\u5C5E\u6027\u4E0A\u3002</p><p>\u62A5\u6587\u4F53\u9700\u8981\u6570\u636E\u6D41\u7ED3\u675F\u540E\u624D\u80FD\u8FDB\u884C\u64CD\u4F5C\u3002</p></li><li><p>HTTP\u54CD\u5E94</p><p>res.setHeader()\u548Cres.writeHead()\u54CD\u5E94\u62A5\u6587\u5934\u90E8\u4FE1\u606F\u3002</p><p>\u53EF\u4EE5\u8C03\u7528setHeader\u8FDB\u884C\u591A\u6B21\u8BBE\u7F6E\uFF0C\u5F53\u8C03\u7528writeHead\uFF0C\u62A5\u6587\u5934\u624D\u4F1A\u5199\u5165\u5230\u8FDE\u63A5\u4E2D\u3002</p><p>res.write()\u548Cres.end()\u5B9E\u73B0\u62A5\u6587\u4F53\u90E8\u5206\uFF0Cres.end()\u4F1A\u5148\u8C03\u7528write()\u53D1\u9001\u6570\u636E\uFF0C\u7136\u540E\u53D1\u9001\u4FE1\u53F7\u544A\u77E5\u670D\u52A1\u5668\u8FD9\u6B21\u54CD\u5E94\u7ED3\u675F\u3002</p><p>\u62A5\u5934\u662F\u5728\u62A5\u6587\u4F53\u524D\u53D1\u9001\uFF0C\u4E00\u65E6\u5F00\u59CB\u4E86\u6570\u636E\u7684\u53D1\u9001\uFF0CwriteHead()\u548CsetHeader()\u5C06\u4E0D\u518D\u751F\u6548\u3002</p><p>\u52A1\u5FC5\u5728\u7ED3\u675F\u65F6\u8C03\u7528res.end()\u7ED3\u675F\u8BF7\u6C42\uFF0C\u5426\u5219\u5BA2\u6237\u7AEF\u5C06\u4E00\u76F4\u5904\u4E8E\u7B49\u5F85\u7684\u72B6\u6001\u3002</p></li><li><p>HTTP\u670D\u52A1\u7684\u4E8B\u4EF6</p><ul><li>connection\u4E8B\u4EF6\uFF1A\u5728\u5F00\u59CBHTTP\u8BF7\u6C42\u548C\u54CD\u5E94\u524D\uFF0C\u5BA2\u6237\u7AEF\u4E0E\u670D\u52A1\u5668\u9700\u8981\u5EFA\u7ACB\u5E95\u5C42\u7684TCP\u8FDE\u63A5\uFF0C\u8FD9\u4E2A\u8FDE\u63A5\u53EF\u80FD\u56E0\u4E3A\u5F00\u542F\u4E86keep-alive\uFF0C\u53EF\u4EE5\u5728\u591A\u6B21\u8BF7\u6C42\u54CD\u5E94\u4E4B\u95F4\u4F7F\u7528\uFF1B\u5F53\u8FD9\u4E2A\u8FDE\u63A5\u5EFA\u7ACB\u65F6\uFF0C\u670D\u52A1\u5668\u89E6\u53D1\u4E86\u4E00\u6B21connection\u4E8B\u4EF6\u3002</li><li>request\u4E8B\u4EF6\u3002\u5EFA\u7ACBTCP\u8FDE\u63A5\u540E\uFF0Chttp\u6A21\u5757\u5E95\u5C42\u5C06\u5728\u6570\u636E\u6D41\u4E2D\u62BD\u8C61\u51FAHTTP\u8BF7\u6C42\u548CHTTP\u54CD\u5E94\uFF0C\u5F53\u8BF7\u6C42\u6570\u636E\u53D1\u9001\u5230\u670D\u52A1\u5668\u7AEF\uFF0C\u5728\u89E3\u6790\u51FAHTTP\u8BF7\u6C42\u5934\u540E\uFF0C\u5C06\u4F1A\u89E6\u53D1\u8BE5\u4E8B\u4EF6\uFF1B\u5728res.end()\u540E\uFF0CTCP\u8FDE\u63A5\u53EF\u80FD\u5C06\u7528\u4E8E\u4E0B\u4E00\u6B21\u8BF7\u6C42\u54CD\u5E94\u3002</li><li>close\u4E8B\u4EF6\u3002\u4E0ETCP\u670D\u52A1\u5668\u7684\u884C\u4E3A\u4E00\u81F4\uFF0C\u8C03\u7528server.close()\u65B9\u6CD5\u505C\u6B62\u63A5\u53D7\u65B0\u7684\u8FDE\u63A5\uFF0C\u5F53\u5DF2\u6709\u7684\u8FDE\u63A5\u90FD\u65AD\u5F00\u65F6\uFF0C\u89E6\u53D1\u8BE5\u4E8B\u4EF6\uFF1B\u53EF\u4EE5\u7ED9server.close()\u4F20\u9012\u4E00\u4E2A\u56DE\u8C03\u51FD\u6570\u6765\u5FEB\u901F\u6CE8\u518C\u4E8B\u4EF6\u3002</li><li>checkContinue\u4E8B\u4EF6\uFF1A\u67D0\u4E9B\u5BA2\u6237\u7AEF\u5728\u53D1\u9001\u8F83\u5927\u7684\u6570\u636E\u65F6\uFF0C\u5E76\u4E0D\u4F1A\u5C06\u6570\u636E\u76F4\u63A5\u53D1\u9001\uFF0C\u800C\u662F\u5148\u53D1\u9001\u4E00\u4E2A\u5934\u90E8\u5E26Expect:100-continue\u7684\u8BF7\u6C42\u5230\u670D\u52A1\u5668\uFF0C\u670D\u52A1\u5668\u5C06\u4F1A\u89E6\u53D1checkContinue\u4E8B\u4EF6\uFF1B\u5982\u679C\u6CA1\u6709\u4E3A\u670D\u52A1\u5668\u76D1\u542C\u8FD9\u4E2A\u4E8B\u4EF6\uFF0C\u670D\u52A1\u5668\u5C06\u4F1A\u81EA\u52A8\u54CD\u5E94\u5BA2\u6237\u7AEF100 Continue\u7684\u72B6\u6001\u7801\uFF0C\u8868\u793A\u63A5\u53D7\u6570\u636E\u4E0A\u4F20\uFF1B\u5982\u679C\u4E0D\u63A5\u53D7\u6570\u636E\u7684\u8F83\u591A\u65F6\uFF0C\u54CD\u5E94\u5BA2\u6237\u7AEF400 Bad Request\u62D2\u7EDD\u5BA2\u6237\u7AEF\u7EE7\u7EED\u53D1\u9001\u6570\u636E\u5373\u53EF\u3002\u5F53\u8BE5\u4E8B\u4EF6\u53D1\u751F\u65F6\u4E0D\u4F1A\u89E6\u53D1request\u4E8B\u4EF6\uFF0C\u4E24\u4E2A\u4E8B\u4EF6\u4E4B\u95F4\u4E92\u65A5\u3002\u5F53\u5BA2\u6237\u7AEF\u6536\u5230100 continue\u540E\u91CD\u65B0\u53D1\u9001\u8BF7\u6C42\u65F6\uFF0C\u624D\u4F1A\u89E6\u53D1request\u4E8B\u4EF6\u3002</li><li>connect\u4E8B\u4EF6\uFF1A\u5F53\u5BA2\u6237\u7AEF\u53D1\u8D77connect\u8BF7\u6C42\u65F6\u89E6\u53D1\uFF0C\u800C\u53D1\u8D77connect\u8BF7\u6C42\u91CD\u65B0\u5728HTTP\u4EE3\u7406\u65F6\u51FA\u73B0\uFF1B\u5982\u679C\u4E0D\u76D1\u542C\u8BE5\u4E8B\u4EF6\uFF0C\u53D1\u8D77\u8BE5\u8BF7\u6C42\u7684\u8FDE\u63A5\u5C06\u4F1A\u5173\u95ED\u3002</li><li>upgrade\u4E8B\u4EF6\uFF1A\u5F53\u5BA2\u6237\u7AEF\u8981\u6C42\u5347\u7EA7\u8FDE\u63A5\u7684\u534F\u8BAE\u65F6\uFF0C\u9700\u8981\u548C\u670D\u52A1\u5668\u7AEF\u534F\u5546\uFF0C\u5BA2\u6237\u7AEF\u4F1A\u5728\u8BF7\u6C42\u5934\u4E2D\u5E26\u4E0AUpgrade\u5B57\u6BB5\uFF0C\u670D\u52A1\u5668\u7AEF\u4F1A\u5728\u63A5\u6536\u5230\u8FD9\u6837\u7684\u8BF7\u6C42\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>clientError\u4E8B\u4EF6\uFF1A\u8FDE\u63A5\u7684\u5BA2\u6237\u7AEF\u89E6\u53D1error\u4E8B\u4EF6\u65F6\uFF0C\u8FD9\u4E2A\u9519\u8BEF\u4F1A\u4F20\u9012\u5230\u670D\u52A1\u5668\u7AEF\uFF0C\u6B64\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li></ul></li></ol><h4 id="http\u5BA2\u6237\u7AEF" tabindex="-1"><a class="header-anchor" href="#http\u5BA2\u6237\u7AEF" aria-hidden="true">#</a> HTTP\u5BA2\u6237\u7AEF</h4><p>HTTP\u6A21\u5757\u63D0\u4F9B\u4E86\u4E00\u4E2A\u5E95\u5C42API\uFF0Chttp.request(options, connect)\uFF0C\u7528\u4E8E\u6784\u9020HTTP\u5BA2\u6237\u7AEF\u3002</p><p>options\u53C2\u6570\u51B3\u5B9A\u4E86\u8FD9\u4E2AHTTP\u8BF7\u6C42\u5934\u7684\u5185\u5BB9\uFF0C\u5B83\u7684\u9009\u9879\u6709\u5982\u4E0B\uFF1A</p><ul><li>host\uFF1A\u670D\u52A1\u5668\u7684\u57DF\u540D\u6216ip\u5730\u5740\uFF0C\u9ED8\u8BA4\u4E3Alocalhost\u3002</li><li>hostname\uFF1A\u670D\u52A1\u5668\u540D\u79F0\u3002</li><li>port\uFF1A\u670D\u52A1\u5668\u7AEF\u53E3\uFF0C\u9ED8\u8BA4\u4E3A80\u3002</li><li>localAddress\uFF1A\u5EFA\u7ACB\u7F51\u7EDC\u8FDE\u63A5\u7684\u672C\u5730\u7F51\u5361\u3002</li><li>scoketPath\uFF1ADomain\u5957\u63A5\u5B57\u8DEF\u5F84\u3002</li><li>method\uFF1AHTTP\u8BF7\u6C42\u65B9\u6CD5\uFF0C\u9ED8\u8BA4\u4E3Aget\u3002</li><li>path\uFF1A\u8BF7\u6C42\u8DEF\u5F84\uFF0C\u9ED8\u8BA4\u4E3A/\u3002</li><li>headers\uFF1A\u8BF7\u6C42\u5934\u5BF9\u8C61\u3002</li><li>auth\uFF1ABasic\u8BA4\u8BC1\uFF0C\u8FD9\u4E2A\u503C\u5C06\u88AB\u8BA1\u7B97\u6210\u8BF7\u6C42\u5934\u4E2D\u7684Authorization\u90E8\u5206\u3002</li></ul><ol><li><p>HTTP\u54CD\u5E94</p><p>ClientRequest\u5728\u89E3\u6790\u54CD\u5E94\u62A5\u6587\u65F6\uFF0C\u4E00\u89E3\u6790\u5B8C\u54CD\u5E94\u5934\u5C31\u89E6\u53D1response\u4E8B\u4EF6\u3002</p></li><li><p>HTTP\u4EE3\u7406</p><p>\u4E3A\u4E86\u91CD\u7528TCP\u8FDE\u63A5\uFF0CHTTP\u6A21\u5757\u5305\u542B\u4E86\u4E00\u4E2A\u9ED8\u8BA4\u7684\u5BA2\u6237\u7AEF\u4EE3\u7406\u5BF9\u8C61http.globalAgent\u3002\u5B83\u5BF9\u6BCF\u4E2A\u670D\u52A1\u5668\u7AEF\uFF08host+port\uFF09\u521B\u5EFA\u7684\u8FDE\u63A5\u8FDB\u884C\u4E86\u7BA1\u7406\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u901A\u8FC7ClientRequest\u5BF9\u8C61\u5BF9\u540C\u4E00\u4E2A\u670D\u52A1\u5668\u7AEF\u53D1\u8D77\u7684HTTP\u8BF7\u6C42\u6700\u591A\u53EF\u4EE5\u521B\u5EFA\u4E94\u4E2A\u8FDE\u63A5\u3002\u5B83\u7684\u5B9E\u8D28\u662F\u4E00\u4E2A\u8FDE\u63A5\u6C60\u3002</p><p>\u4E00\u65E6\u8BF7\u6C42\u91CF\u8FC7\u5927\uFF0C\u8FDE\u63A5\u9650\u5236\u5C06\u4F1A\u9650\u5236\u670D\u52A1\u6027\u80FD\u3002\u53EF\u4EE5\u901A\u8FC7\u5728options\u4E2D\u4F20\u9012agent\u9009\u9879\u3002\u53EF\u4EE5\u8BBE\u7F6Eagent\u4E3Afalse\u8131\u79BB\u8FDE\u63A5\u6C60\u7684\u7BA1\u7406\uFF0C\u4F7F\u5F97\u8BF7\u6C42\u4E0D\u53D7\u5E76\u53D1\u7684\u9650\u5236\u3002</p><p>Agent\u5BF9\u8C61\u7684sockets\u548Crequests\u5C5E\u6027\u5206\u522B\u8868\u793A\u5F53\u524D\u8FDE\u63A5\u6C60\u4E2D\u4F7F\u7528\u4E2D\u7684\u8FDE\u63A5\u6570\u548C\u5904\u4E8E\u7B49\u5F85\u72B6\u6001\u7684\u8BF7\u6C42\u6570\u3002</p></li><li><p>HTTP\u5BA2\u6237\u7AEF\u4E8B\u4EF6</p><ul><li>response\uFF1A\u4E0E\u670D\u52A1\u5668\u7AEF\u7684request\u4E8B\u4EF6\u5BF9\u5E94\u7684\u5BA2\u6237\u7AEF\u5728\u8BF7\u6C42\u53D1\u51FA\u540E\u5F97\u5230\u670D\u52A1\u5668\u7AEF\u54CD\u5E94\u65F6\u3002\u4F1A\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>socket\uFF1A\u5F53\u5E95\u5C42\u8FDE\u63A5\u6C60\u4E2D\u5EFA\u7ACB\u7684\u8FDE\u63A5\u5206\u914D\u7ED9\u5F53\u524D\u8BF7\u6C42\u5BF9\u8C61\u65F6\uFF0C\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>connect\uFF1A\u5F53\u5BA2\u6237\u7AEF\u5411\u670D\u52A1\u5668\u7AEF\u53D1\u8D77connect\u8BF7\u6C42\u65F6\uFF0C\u5982\u679C\u670D\u52A1\u5668\u7AEF\u54CD\u5E94\u4E86200\u72B6\u6001\u7801\uFF0C\u5BA2\u6237\u7AEF\u5C06\u4F1A\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>Upgrade:\u5BA2\u6237\u7AEF\u5411\u670D\u52A1\u5668\u7AEF\u53D1\u8D77Upgrade\u8BF7\u6C42\u65F6\uFF0C\u5982\u679C\u670D\u52A1\u5668\u7AEF\u54CD\u5E94\u4E86101 Switching Protocols\u72B6\u6001\uFF0C\u5BA2\u6237\u7AEF\u5C06\u4F1A\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>continus\uFF1A\u5BA2\u6237\u7AEF\u5411\u670D\u52A1\u5668\u7AEF\u53D1\u8D77Expect: 100-continus\u5934\u4FE1\u606F\uFF0C\u4EE5\u8BD5\u56FE\u53D1\u9001\u8F83\u5927\u6570\u636E\u91CF\uFF0C\u5982\u679C\u670D\u52A1\u5668\u7AEF\u54CD\u5E94100 \u4E0D\u3002continue\u72B6\u6001\uFF0C\u5BA2\u6237\u7AEF\u5C06\u4F1A\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li></ul></li></ol><h3 id="_7-4-\u6784\u5EFAwebsocket\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_7-4-\u6784\u5EFAwebsocket\u670D\u52A1" aria-hidden="true">#</a> 7.4 \u6784\u5EFAWebSocket\u670D\u52A1</h3><p>WebScoket\u5BA2\u6237\u7AEF\u57FA\u4E8E\u4E8B\u4EF6\u7684\u7F16\u7A0B\u6A21\u578B\u4E0ENode\u4E2D\u81EA\u5B9A\u4E49\u4E8B\u4EF6\u76F8\u5DEE\u65E0\u51E0\uFF1BWebScoket\u5B9E\u73B0\u4E86\u5BA2\u6237\u7AEF\u4E0E\u670D\u52A1\u5668\u7AEF\u4E4B\u95F4\u7684\u957F\u8FDE\u63A5\uFF0C\u800CNode\u4E8B\u4EF6\u9A71\u52A8\u7684\u65B9\u5F0F\u5341\u5206\u64C5\u957F\u4E0E\u5927\u91CF\u7684\u5BA2\u6237\u7AEF\u4FDD\u6301\u9AD8\u5E76\u53D1\u8FDE\u63A5\u3002</p><p>WebSocket\u597D\u5904\uFF1A</p><ul><li>\u5BA2\u6237\u7AEF\u4E0E\u670D\u52A1\u5668\u7AEF\u53EA\u5EFA\u7ACB\u4E00\u4E2ATCP\u8FDE\u63A5\uFF0C\u53EF\u4EE5\u4F7F\u7528\u66F4\u5C11\u7684\u8FDE\u63A5\u3002</li><li>WebScoket\u670D\u52A1\u5668\u7AEF\u53EF\u4EE5\u63A8\u9001\u6570\u636E\u5230\u5BA2\u6237\u7AEF\uFF0C\u8FD9\u8FDC\u6BD4HTTP\u8BF7\u6C42\u54CD\u5E94\u6A21\u5F0F\u66F4\u7075\u6D3B\u3001\u66F4\u9AD8\u6548\u3002</li><li>\u6709\u8F7B\u91CF\u7EA7\u7684\u534F\u8BAE\u5934\uFF0C\u51CF\u5C11\u6570\u636E\u4F20\u9001\u91CF\u3002</li></ul><p>\u957F\u8F6E\u8BE2\u7684\u539F\u7406\u662F\u5BA2\u6237\u7AEF\u5411\u670D\u52A1\u5668\u7AEF\u53D1\u8D77\u8BF7\u6C42\uFF0C\u670D\u52A1\u5668\u7AEF\u53EA\u5728\u8D85\u65F6\u6216\u6709\u6570\u636E\u54CD\u5E94\u65F6\u65AD\u5F00\u8FDE\u63A5\uFF08res.end()\uFF09\u3002</p><p>\u4F7F\u7528WebSocket\u7684\u8BDD\uFF0C\u7F51\u9875\u5BA2\u6237\u7AEF\u53EA\u9700\u8981\u4E00\u4E2ATCP\u8FDE\u63A5\u5373\u53EF\u5B8C\u6210\u53CC\u5411\u901A\u4FE1\uFF0C\u5728\u5BA2\u6237\u7AEF\u4E0E\u670D\u52A1\u5668\u7AEF\u9891\u7E41\u901A\u4FE1\u65F6\uFF0C\u65E0\u9700\u9891\u7E41\u65AD\u5F00\u8FDE\u63A5\u548C\u91CD\u53D1\u8BF7\u6C42\u3002</p><h4 id="webscoket\u63E1\u624B" tabindex="-1"><a class="header-anchor" href="#webscoket\u63E1\u624B" aria-hidden="true">#</a> WebScoket\u63E1\u624B</h4><p>\u4E00\u65E6Websocket\u63E1\u624B\u6210\u529F\uFF0C\u670D\u52A1\u5668\u7AEF\u4E0E\u5BA2\u6237\u7AEF\u5C06\u4F1A\u5448\u73B0\u5BF9\u7B49\u7684\u6548\u679C\uFF0C\u90FD\u80FD\u63A5\u6536\u548C\u53D1\u9001\u6D88\u606F\u3002</p><h4 id="websocket\u6570\u636E\u4F20\u8F93" tabindex="-1"><a class="header-anchor" href="#websocket\u6570\u636E\u4F20\u8F93" aria-hidden="true">#</a> WebSocket\u6570\u636E\u4F20\u8F93</h4><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJ1gS.jpg" alt="gjJ1gS.jpg"></p><p>ws\u6A21\u5757\u5C01\u88C5\u4E86WebScoket\u7684\u5E95\u5C42\u5B9E\u73B0\u3002</p><h3 id="_7-5-\u7F51\u7EDC\u670D\u52A1\u4E0E\u5B89\u5168" tabindex="-1"><a class="header-anchor" href="#_7-5-\u7F51\u7EDC\u670D\u52A1\u4E0E\u5B89\u5168" aria-hidden="true">#</a> 7.5 \u7F51\u7EDC\u670D\u52A1\u4E0E\u5B89\u5168</h3><p>SSL\u4F5C\u4E3A\u4E00\u79CD\u5B89\u5168\u534F\u8BAE\uFF0C\u5B83\u5728\u4F20\u8F93\u5C42\u63D0\u4F9B\u5BF9\u7F51\u7EDC\u8FDE\u63A5\u52A0\u5BC6\u7684\u529F\u80FD\u3002\u5BF9\u4E8E\u5E94\u7528\u5C42\u800C\u8A00\uFF0C\u5B83\u662F\u900F\u660E\u7684\uFF0C\u6570\u636E\u5728\u4F20\u9012\u5230\u5E94\u7528\u5C42\u4E4B\u524D\u5C31\u5DF2\u7ECF\u5B8C\u6210\u4E86\u52A0\u5BC6\u548C\u89E3\u5BC6\u7684\u8FC7\u7A0B\u3002</p><p>Node\u5728\u7F51\u7EDC\u5B89\u5168\u4E0A\u63D0\u4F9B\u4E863\u4E2A\u6A21\u5757\uFF0C\u5206\u522B\u662Fcrypto\u3001tls\u3001https\u3002</p><p>crypto\u4E3B\u8981\u7528\u4E8E\u52A0\u5BC6\u89E3\u5BC6\uFF0CSHA1\u3001MD5\u7B49\u52A0\u5BC6\u7B97\u6CD5\u90FD\u5728\u5176\u4E2D\u3002tls\u6A21\u5757\u63D0\u4F9B\u4E86\u4E0Enet\u6A21\u5757\u7C7B\u4F3C\u7684\u529F\u80FD\uFF0C\u533A\u522B\u5728\u4E8E\u5B83\u5EFA\u7ACB\u5728TLS/SSL\u52A0\u5BC6\u7684TCP\u8FDE\u63A5\u4E0A\u3002https\u4E0Ehttp\u6A21\u5757\u63A5\u53E3\u4E00\u81F4\uFF0C\u533A\u522B\u662F\u5B83\u5EFA\u7ACB\u5728\u5B89\u5168\u7684\u8FDE\u63A5\u4E4B\u4E0A\u3002</p><h4 id="tls-ssl" tabindex="-1"><a class="header-anchor" href="#tls-ssl" aria-hidden="true">#</a> TLS/SSL</h4><ol><li><p>\u5BC6\u94A5</p><p>TLS/SSL\u662F\u4E00\u4E2A\u516C\u94A5/\u79C1\u94A5\u7684\u7ED3\u6784\uFF0C\u5B83\u662F\u4E00\u4E2A\u975E\u5BF9\u79F0\u7684\u7ED3\u6784\uFF0C\u6BCF\u4E2A\u670D\u52A1\u5668\u7AEF\u548C\u5BA2\u6237\u7AEF\u90FD\u6709\u81EA\u5DF1\u7684\u516C\u79C1\u94A5\u3002</p><p>\u516C\u94A5\u7528\u6765\u52A0\u5BC6\u8981\u4F20\u8F93\u7684\u6570\u636E\uFF0C\u79C1\u94A5\u7528\u6765\u89E3\u5BC6\u63A5\u6536\u5230\u7684\u6570\u636E\u3002\u516C\u94A5\u548C\u79C1\u94A5\u662F\u914D\u5BF9\u7684\uFF0C\u901A\u8FC7\u516C\u94A5\u52A0\u5BC6\u7684\u6570\u636E\uFF0C\u53EA\u6709\u901A\u8FC7\u79C1\u94A5\u624D\u80FD\u89E3\u5BC6\u3002</p><p>\u5728\u5EFA\u7ACB\u5B89\u5168\u4F20\u8F93\u4E4B\u524D\uFF0C\u5BA2\u6237\u7AEF\u548C\u670D\u52A1\u5668\u7AEF\u4E4B\u95F4\u9700\u8981\u4E92\u6362\u516C\u94A5\u3002\u5BA2\u6237\u7AEF\u53D1\u9001\u6570\u636E\u65F6\u8981\u901A\u8FC7\u670D\u52A1\u5668\u7AEF\u7684\u516C\u94A5\u8FDB\u884C\u52A0\u5BC6\uFF0C\u670D\u52A1\u5668\u7AEF\u53D1\u9001\u6570\u636E\u65F6\u5219\u9700\u8981\u5BA2\u6237\u7AEF\u7684\u516C\u94A5\u8FDB\u884C\u52A0\u5BC6\u3002</p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJ3jg.jpg" alt="gjJ3jg.jpg"></p><p>Node\u5E95\u5C42\u91C7\u7528\u7684\u662Fopenssl\u5B9E\u73B0TLS/SSL\u7684\uFF0C\u751F\u6210\u516C\u94A5\u79C1\u94A5\u53EF\u4EE5\u7528\u4E2Aopenssl\u5B8C\u6210\u3002</p><p>\u516C\u79C1\u94A5\u53EF\u80FD\u5B58\u5728\u7684\u6F0F\u6D1E\u662F\u4E2D\u95F4\u4EBA\u653B\u51FB\uFF0C\u901A\u8FC7\u6570\u5B57\u8BC1\u4E66\u8BA4\u8BC1\u53EF\u4EE5\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\u3002</p></li><li><p>\u6570\u5B57\u8BC1\u4E66</p><p>\u6570\u5B57\u8BC1\u4E66\u4E2D\u5305\u542B\u4E86\u670D\u52A1\u5668\u7684\u540D\u79F0\u548C\u4E3B\u673A\u540D\u3001\u670D\u52A1\u5668\u7684\u516C\u94A5\u3001\u7B7E\u540D\u9881\u53D1\u673A\u6784\u7684\u540D\u79F0\u3001\u6765\u81EA\u7B7E\u540D\u9881\u53D1\u673A\u6784\u7684\u7B7E\u540D\u3002\u5728\u8FDE\u63A5\u5EFA\u7ACB\u524D\uFF0C\u4F1A\u901A\u8FC7\u8BC1\u4E66\u4E2D\u7684\u7B7E\u540D\u786E\u8BA4\u6536\u5230\u7684\u516C\u94A5\u662F\u6765\u81EA\u76EE\u6807\u670D\u52A1\u5668\u7684\uFF0C\u4ECE\u800C\u4EA7\u751F\u4FE1\u4EFB\u5173\u7CFB\u3002</p><p>CA\uFF08Cretificate Authority\uFF0C\u6570\u5B57\u8BC1\u4E66\u8BA4\u8BC1\u4E2D\u5FC3)\u3002CA\u7684\u4F5C\u7528\u662F\u4E3A\u7AD9\u70B9\u9881\u53D1\u8BC1\u4E66\uFF0C\u8FD9\u4E2A\u8BC1\u4E66\u901A\u8FC7CA\u901A\u8FC7\u81EA\u5DF1\u7684\u516C\u94A5\u548C\u79C1\u94A5\u5B9E\u73B0\u7684\u7B7E\u540D\u3002</p><p>\u4E3A\u4E86\u5F97\u5230\u7B7E\u540D\u8BC1\u4E66\uFF0C\u670D\u52A1\u5668\u7AEF\u9700\u8981\u901A\u8FC7\u81EA\u5DF1\u7684\u79C1\u94A5\u751F\u6210CSR\uFF08\u8BC1\u4E66\u7B7E\u540D\u8BF7\u6C42\uFF09\u6587\u4EF6\u3002CA\u673A\u6784\u5C06\u901A\u8FC7\u8FD9\u4E2A\u6587\u4EF6\u9881\u53D1\u5C5E\u4E8E\u8BE5\u670D\u52A1\u5668\u7AEF\u7684\u7B7E\u540D\u8BC1\u4E66\uFF0C\u53EA\u8981\u901A\u8FC7CA\u673A\u6784\u5C31\u80FD\u9A8C\u8BC1\u8BC1\u4E66\u662F\u5426\u5408\u6CD5\u3002</p><p>\u5BF9\u4E8E\u4E2D\u5C0F\u578B\u4F01\u4E1A\uFF0C\u591A\u534A\u662F\u91C7\u7528\u81EA\u7B7E\u540D\u8BC1\u4E66\u6765\u6784\u5EFA\u5B89\u5168\u7F51\u7EDC\u7684\u3002\u6240\u8C13\u81EA\u7B7E\u540D\u8BC1\u4E66\u5C31\u662F\u81EA\u5DF1\u626E\u6F14CA\u673A\u6784\u3002\u7ED9\u81EA\u5DF1\u7684\u670D\u52A1\u5668\u7AEF\u9881\u53D1\u7B7E\u540D\u8BC1\u4E66\u3002</p></li></ol><h4 id="tls\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#tls\u670D\u52A1" aria-hidden="true">#</a> TLS\u670D\u52A1</h4><ol><li><p>\u521B\u5EFA\u670D\u52A1\u5668\u7AEF</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">tls</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">tls</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">server</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">tls</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createServer</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">options</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">fn</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9;">server</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">8080</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p>TLS\u5BA2\u6237\u7AEF</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">stream</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">tls</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">connect</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">8080</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">options</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">fn</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9;">stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u4E0E\u666E\u901A\u7684TCP\u670D\u52A1\u5668\u7AEF\u548C\u5BA2\u6237\u7AEF\u76F8\u6BD4\u3002TLS\u7684\u670D\u52A1\u5668\u7AEF\u548C\u5BA2\u6237\u7AEF\u4EC5\u4EC5\u53EA\u5728\u8BC1\u4E66\u7684\u914D\u7F6E\u4E0A\u6709\u5DEE\u522B\uFF0C\u5176\u4F59\u90E8\u5206\u57FA\u672C\u76F8\u540C\u3002</p></li></ol><h4 id="https\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#https\u670D\u52A1" aria-hidden="true">#</a> HTTPS\u670D\u52A1</h4><p>HTTPS\u670D\u52A1\u5C31\u662F\u5DE5\u4F5C\u5728TLS/SSL\u4E0A\u7684HTTP\u3002</p><ol><li><p>\u51C6\u5907\u8BC1\u4E66</p><p>HTTPS\u670D\u52A1\u9700\u8981\u7528\u5230\u79C1\u94A5\u548C\u7B7E\u540D\u8BC1\u4E66\u3002</p></li><li><p>\u521B\u5EFAHTTPS\u670D\u52A1</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">https</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">https</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9;">https</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createServer</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">options</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeHead</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">200</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">heel world</span><span style="color:#EBCB8B;">\\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">8000</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li><p>HTTPS\u5BA2\u6237\u7AEF</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">options</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#88C0D0;">hostname</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">localhost</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#88C0D0;">port</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">8000</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#88C0D0;">path</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#88C0D0;">method</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">GET</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#88C0D0;">key</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">client.key</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#88C0D0;">cert</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">client.crt</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#88C0D0;">ca</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">ca.crt</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">options</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">agent</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">https</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Agent</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">options</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">req</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">https</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">request</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">options</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setEncoding</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">utf-8</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ol><h2 id="\u7B2C8\u7AE0-\u6784\u5EFAweb\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#\u7B2C8\u7AE0-\u6784\u5EFAweb\u5E94\u7528" aria-hidden="true">#</a> \u7B2C8\u7AE0 \u6784\u5EFAWeb\u5E94\u7528</h2><h3 id="_8-1-\u57FA\u7840\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#_8-1-\u57FA\u7840\u529F\u80FD" aria-hidden="true">#</a> 8.1 \u57FA\u7840\u529F\u80FD</h3><h4 id="\u8BF7\u6C42\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u8BF7\u6C42\u65B9\u6CD5" aria-hidden="true">#</a> \u8BF7\u6C42\u65B9\u6CD5</h4><p>GET\u3001POST\u3001HEAD\u3001DELETE\u3001PUT\u3001CONNECT</p><p>HTTP_Parser\u63D0\u4F9Breq.method\u65B9\u6CD5\u83B7\u53D6\u8BF7\u6C42\u65B9\u6CD5</p><h4 id="\u8DEF\u5F84\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#\u8DEF\u5F84\u5206\u6790" aria-hidden="true">#</a> \u8DEF\u5F84\u5206\u6790</h4><p>HTTP_Parser\u63D0\u4F9Breq.url\u65B9\u6CD5\u83B7\u53D6\u8DEF\u5F84\u89E3\u6790</p><h4 id="\u67E5\u8BE2\u5B57\u7B26\u4E32" tabindex="-1"><a class="header-anchor" href="#\u67E5\u8BE2\u5B57\u7B26\u4E32" aria-hidden="true">#</a> \u67E5\u8BE2\u5B57\u7B26\u4E32</h4><p><code>?foo=bar&amp;baz=val</code>\uFF0CNote\u63D0\u4F9B\u4E86querystring\u6A21\u5757\u7528\u4E8E\u5904\u7406\u8FD9\u90E8\u5206\u6570\u636E\u3002</p><h4 id="cookie" tabindex="-1"><a class="header-anchor" href="#cookie" aria-hidden="true">#</a> Cookie</h4><h5 id="_1-\u521D\u8BC6cookie" tabindex="-1"><a class="header-anchor" href="#_1-\u521D\u8BC6cookie" aria-hidden="true">#</a> <strong>1.\u521D\u8BC6Cookie</strong></h5><p>Cookie\u7684\u5904\u7406\u5206\u4E3A\u5982\u4E0B\u51E0\u6B65\u3002</p><ul><li>\u670D\u52A1\u5668\u5411\u5BA2\u6237\u7AEF\u53D1\u9001cookie\u3002</li><li>\u6D4F\u89C8\u5668\u5C06cookie\u4FDD\u5B58\u3002</li><li>\u4E4B\u540E\u6BCF\u6B21\u6D4F\u89C8\u5668\u90FD\u4F1A\u5C06cookie\u53D1\u5411\u670D\u52A1\u5668\u7AEF\u3002</li></ul><p>HTTP_Parser\u4F1A\u5C06\u6240\u6709\u7684\u62A5\u6587\u5B57\u6BB5\u89E3\u6790\u5230req.headers\u4E0A\uFF0Ccookie\u662Freq.headers.cookie\u3002Cookie\u7684\u503C\u683C\u5F0F\u662Fkey=value\uFF1Bkey2=value2\u3002</p><p>\u6D4F\u89C8\u5668\u7AEF\u901A\u8FC7<code>document.cookie</code>\u83B7\u53D6cookie\u4FE1\u606F\u3002</p><p>\u670D\u52A1\u5668\u7AEF\u7B2C\u4E00\u6B21\u53D1\u9001cookie\u901A\u8FC7Set-Cooket\u5B57\u6BB5\u3002<code>Set-Cookie: name=value; Paht=/; Expires=Sun, 23-Apr-23 09:01:35 GMT; Domain=.domain.com;</code></p><ul><li>path\u8868\u793A\u8FD9\u4E2Acookie\u5F71\u54CD\u5230\u7684\u8DEF\u5F84\uFF0C\u5F53\u524D\u8BBF\u95EE\u7684\u8DEF\u5F84\u4E0D\u6EE1\u8DB3\u8BE5\u5339\u914D\u65F6\uFF0C\u6D4F\u89C8\u5668\u5219\u4E0D\u53D1\u9001\u8FD9\u4E2Acookie\u3002</li><li>Expires\u548CMax-Age\u662F\u7528\u6765\u544A\u77E5\u6D4F\u89C8\u5668\u8FD9\u4E2Acookie\u4F55\u65F6\u8FC7\u671F\u7684\uFF0C\u5982\u679C\u4E0D\u8BBE\u7F6E\u8BE5\u9009\u9879\uFF0C\u5728\u5173\u95ED\u6D4F\u89C8\u5668\u65F6\u4F1A\u4E22\u5931\u6389\u8FD9\u4E2Acookie\u3002</li><li>Secure\u3002\u5F53Secure\u4E3Atrue\u65F6\uFF0C\u5728HTTP\u4E2D\u662F\u65E0\u6548\u7684\uFF0C\u5728HTTPS\u4E2D\u624D\u6709\u6548\u3002</li></ul><h5 id="_2-cookie\u7684\u6027\u80FD\u5F71\u54CD" tabindex="-1"><a class="header-anchor" href="#_2-cookie\u7684\u6027\u80FD\u5F71\u54CD" aria-hidden="true">#</a> 2.Cookie\u7684\u6027\u80FD\u5F71\u54CD</h5><p>\u4E00\u65E6\u8BBE\u7F6E\u7684cookie\u8FC7\u591A\u5C06\u4F1A\u5BFC\u81F4\u62A5\u5934\u8F83\u5927\u3002</p><ul><li>\u51CF\u5C11cookie\u7684\u5927\u5C0F\u3002</li><li>\u4E3A\u9759\u6001\u7EC4\u4EF6\u4F7F\u7528\u4E0D\u540C\u7684\u57DF\u540D\u3002</li><li>\u51CF\u5C11DNS\u67E5\u8BE2\u3002</li></ul><h4 id="session" tabindex="-1"><a class="header-anchor" href="#session" aria-hidden="true">#</a> Session</h4><p>Session\u7684\u6570\u636E\u503C\u4FDD\u7559\u5728\u670D\u52A1\u5668\u7AEF\uFF0C\u5BA2\u6237\u7AEF\u65E0\u6CD5\u4FEE\u6539\uFF0C\u8FD9\u6837\u7684\u6570\u636E\u7684\u5B89\u5168\u6027\u5F97\u5230\u4E00\u5B9A\u7684\u4FDD\u969C\uFF0C\u6570\u636E\u4E5F\u65E0\u987B\u5728\u534F\u8BAE\u4E2D\u6BCF\u6B21\u90FD\u88AB\u4F20\u9012\u3002</p><ul><li><p>\u57FA\u4E8ECookie\u6765\u5B9E\u73B0\u7528\u6237\u548C\u6570\u636E\u7684\u6620\u5C04</p></li><li><p>\u901A\u8FC7\u67E5\u8BE2\u5B57\u7B26\u4E32\u6765\u5B9E\u73B0\u6D4F\u89C8\u5668\u7AEF\u548C\u670D\u52A1\u5668\u7AEF\u6570\u636E\u7684\u5BF9\u5E94</p><p>\u5B83\u7684\u539F\u7406\u662F\u68C0\u67E5\u8BF7\u6C42\u7684\u67E5\u8BE2\u5B57\u7B26\u4E32\uFF0C\u5982\u679C\u6CA1\u6709\u503C\uFF0C\u4F1A\u5148\u751F\u6210\u65B0\u7684\u5E26\u503C\u7684URL\u3002</p></li></ul><ol><li><p>Session\u4E0E\u5185\u5B58</p><p>Session\u6570\u636E\u76F4\u63A5\u5B58\u5728\u53D8\u91CFsessions\u4E2D\uFF0C\u5B83\u4F4D\u4E8E\u5185\u5B58\u4E2D\u3002\u7528\u6237\u6570\u91CF\u589E\u591A\u4F1A\u5F15\u8D77\u6027\u80FD\u95EE\u9898\u3002</p><p>\u89E3\u51B3\u6027\u80FD\u95EE\u9898\u548CSession\u6570\u636E\u65E0\u6CD5\u8DE8\u8FDB\u7A0B\u5171\u4EAB\u7684\u95EE\u9898\uFF0C\u5E38\u7528\u7684\u65B9\u6848\u662F\u5C06Session\u96C6\u4E2D\u5316\uFF0C\u5C06\u539F\u672C\u53EF\u80FD\u5206\u6563\u5728\u591A\u4E2A\u8FDB\u7A0B\u91CC\u7684\u6570\u636E\uFF0C\u7EDF\u4E00\u8F6C\u79FB\u5230\u96C6\u4E2D\u7684\u6570\u636E\u5B58\u50A8\u4E2D\u3002\u76EE\u524D\u5E38\u7528\u7684\u5DE5\u5177\u662FRedis\u3001Memcached\u7B49\uFF0C\u901A\u8FC7\u8FD9\u4E9B\u9AD8\u6548\u7684\u7F13\u5B58\uFF0CNode\u8FDB\u7A0B\u65E0\u987B\u5728\u5185\u90E8\u7EF4\u62A4\u6570\u636E\u5BF9\u8C61\uFF0C\u5783\u573E\u56DE\u6536\u95EE\u9898\u548C\u5185\u5B58\u9650\u5236\u95EE\u9898\u90FD\u53EF\u4EE5\u8FCE\u5203\u800C\u89E3\u3002</p></li><li><p>Session\u4E0E\u5B89\u5168</p><p>Seesion\u53E3\u4EE4\u4F1A\u88AB\u4F2A\u9020\uFF0C\u53EF\u80FD\u4F1A\u9020\u6210\u670D\u52A1\u5668\u7AEF\u6570\u636E\u88AB\u5229\u7528\u3002</p><p>\u89E3\u51B3\u65B9\u6CD5\uFF1A\u5C06\u8FD9\u4E2A\u53E3\u4EE4\u901A\u8FC7\u79C1\u94A5\u52A0\u5BC6\u8FDB\u884C\u7B7E\u540D\uFF0C\u4F7F\u5F97\u4F2A\u9020\u7684\u6210\u672C\u8F83\u9AD8\u3002\u5728\u54CD\u5E94\u65F6\u5C06\u53E3\u4EE4\u548C\u7B7E\u540D\u8FDB\u884C\u5BF9\u6BD4\uFF0C\u5982\u679C\u7B7E\u540D\u975E\u6CD5\uFF0C\u6211\u4EEC\u5C06\u670D\u52A1\u5668\u4E2D\u7684\u6570\u636E\u7ACB\u5373\u8FC7\u671F\u5373\u53EF\u3002</p></li></ol><h4 id="\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58" aria-hidden="true">#</a> \u7F13\u5B58</h4><p>\u7F13\u5B58\u65B9\u6CD5\uFF1A</p><ul><li>\u6DFB\u52A0Expires\u6216Cache-Control\u5230\u62A5\u6587\u5934\u4E2D\u3002</li><li>\u914D\u7F6EETag\u3002</li><li>\u8BA9Ajax\u53EF\u7F13\u5B58\u3002</li></ul><p>\u6D4F\u89C8\u5668\u7AEF\u5982\u679C\u5728\u7B2C\u4E8C\u6B21\u8BF7\u6C42\u5982\u679C\u4E0D\u80FD\u786E\u5B9A\u8FD9\u4EFD\u672C\u5730\u6587\u4EF6\u662F\u5426\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\uFF0C\u5B83\u5C06\u4F1A\u53D1\u9001\u4E00\u6B21\u6761\u4EF6\u8BF7\u6C42\uFF0C\u5728\u666E\u901A\u7684GET\u8BF7\u6C42\u62A5\u6587\u4E2D\uFF0C\u9644\u5E26If-Modified-Since\u5B57\u6BB5\u3002</p><p>\u5982\u679C\u670D\u52A1\u5668\u7AEF\u6CA1\u6709\u65B0\u7684\u7248\u672C\uFF0C\u53EA\u9700\u54CD\u5E94\u4E00\u4E2A304\u72B6\u6001\u7801\uFF0C\u5BA2\u6237\u7AEF\u5C31\u4F7F\u7528\u672C\u5730\u7248\u672C\uFF0C\u5982\u679C\u670D\u52A1\u5668\u7AEF\u6709\u65B0\u7684\u7248\u672C\uFF0C\u5C31\u5C06\u65B0\u7684\u5185\u5BB9\u53D1\u9001\u7ED9\u5BA2\u6237\u7AEF\uFF0C\u5BA2\u6237\u7AEF\u653E\u5F03\u672C\u5730\u7248\u672C\u3002</p><p>\u8FD9\u91CC\u7684\u6761\u4EF6\u8BF7\u6C42\u91C7\u7528\u65F6\u95F4\u6233\u7684\u65B9\u5F0F\u5B9E\u73B0\uFF0C\u4F46\u662F\u65F6\u95F4\u6233\u6709\u4E00\u4E9B\u7F3A\u9677\u5B58\u5728\u3002</p><ul><li>\u6587\u4EF6\u7684\u65F6\u95F4\u6233\u6539\u52A8\u4F46\u5185\u5BB9\u5E76\u4E0D\u4E00\u5B9A\u6539\u52A8\u3002</li><li>\u65F6\u95F4\u6233\u53EA\u80FD\u7CBE\u786E\u5230\u79D2\u7EA7\u522B\uFF0C\u66F4\u65B0\u9891\u7E41\u7684\u5185\u5BB9\u5C06\u65E0\u6CD5\u751F\u6548\u3002</li></ul><p>\u4E3A\u6B64HTTP1.1\u4E2D\u5F15\u5165\u4E86ETag\u7684\u6765\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0CETag\u7531\u670D\u52A1\u5668\u7AEF\u751F\u6210\uFF0C\u670D\u52A1\u5668\u7AEF\u53EF\u4EE5\u51B3\u5B9A\u5B83\u751F\u6210\u89C4\u5219\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">gethash</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">str</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">shasum</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">crtpto</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createHash</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">sha1</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">shasum</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">update</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">str</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">digest</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">base64</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">handle</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">hash</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">getHash</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">noneMatch</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">headers</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">if-none-match</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">hash</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">noneMatch</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeHead</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">304</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Not Modified</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">else</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setHead</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">ETag</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">hash</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeHead</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">200</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">OK</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>ETag\u7684\u8BF7\u6C42\u548C\u54CD\u5E94\u662FIf-None-Match/ETag\u3002</p><p>\u5728\u54CD\u5E94\u91CC\u8BBE\u7F6EExpires\u6216Cache-Control\u5934\uFF0C\u6D4F\u89C8\u5668\u5C06\u6839\u636E\u8BE5\u503C\u8FDB\u884C\u7F13\u5B58\u3002</p><p>Expires\u662F\u4E00\u4E2AGMT\u683C\u5F0F\u7684\u65F6\u95F4\u5B57\u7B26\u4E32\u3002\u6D4F\u89C8\u5668\u5728\u63A5\u6536\u5230\u8FD9\u4E2A\u8FC7\u671F\u503C\u540E\uFF0C\u53EA\u6709\u672C\u5730\u8FD8\u5B58\u5728\u8FD9\u4E2A\u7F13\u5B58\u6587\u4EF6\uFF0C\u5728\u5230\u671F\u65F6\u95F4\u4E4B\u524D\u5B83\u90FD\u4E0D\u4F1A\u518D\u53D1\u8D77\u8BF7\u6C42\u3002Expires\u7684\u7F3A\u9677\u5728\u4E8E\u6D4F\u89C8\u5668\u4E0E\u670D\u52A1\u5668\u4E4B\u95F4\u7684\u65F6\u95F4\u53EF\u80FD\u4E0D\u4E00\u81F4\uFF0C\u8FD9\u53EF\u80FD\u4F1A\u5E26\u6765\u4E00\u4E9B\u95EE\u9898\uFF0C\u6BD4\u5982\u6587\u4EF6\u63D0\u524D\u8FC7\u671F\u6216\u8005\u5230\u671F\u540E\u5E76\u6CA1\u6709\u88AB\u5220\u9664\u3002Cache-Control\u4EE5\u66F4\u4E30\u5BCC\u7684\u5F62\u5F0F\uFF0C\u5B9E\u73B0\u76F8\u540C\u7684\u529F\u80FD\u3002</p><p>Cache-Control\u8BBE\u7F6E\u4E86max-age\u503C\uFF0C\u53EF\u4EE5\u907F\u514D\u670D\u52A1\u5668\u7AEF\u4E0E\u6D4F\u89C8\u5668\u7AEF\u65F6\u95F4\u4E0D\u540C\u6B65\u5E26\u6765\u7684\u4E0D\u4E00\u81F4\u6027\u95EE\u9898\u3002Cache-Control\u8FD8\u53EF\u4EE5\u8BBE\u7F6Epublic\u3001private\u3001no-cache\u3001no-store\u7B49\u3002</p><p>\u5728\u6D4F\u89C8\u5668\u4E2D\u5982\u679C\u4E24\u4E2A\u503C\u540C\u65F6\u5B58\u5728\u4E14\u88AB\u540C\u65F6\u652F\u6301\u65F6\uFF0Cmax-age\u4F1A\u8986\u76D6Expires\u3002</p><p><strong>\u6E05\u9664\u7F13\u5B58</strong></p><p>\u6D4F\u89C8\u5668\u662F\u6839\u636EURL\u8FDB\u884C\u7F13\u5B58\uFF0C\u4E00\u65E6\u5185\u5BB9\u6709\u6240\u66F4\u65B0\u65F6\uFF0C\u6211\u4EEC\u5C31\u8BA9\u6D4F\u89C8\u5668\u53D1\u8D77\u65B0\u7684URL\u8BF7\u6C42\u3002\u4E00\u822C\u7684\u66F4\u65B0\u673A\u5236\u6709\u5982\u4E0B\u4E24\u79CD\u3002</p><ul><li>\u8DEF\u5F84\u4E2D\u8DDF\u968FWeb\u5E94\u7528\u7684\u7248\u672C\u53F7\uFF1A<code>http://url.com/?v=20210401</code></li><li>\u8DEF\u5F84\u4E2D\u8DDF\u968F\u8BE5\u6587\u4EF6\u5185\u5BB9\u7684hash\u503C\uFF1A<code>http://url.com/?hash=afadfadwe</code></li></ul><p>hash\u503C\u8FDB\u884C\u7F13\u5B58\u6DD8\u6C70\u4F1A\u66F4\u52A0\u9AD8\u6548\u3002</p><h4 id="basic\u8BA4\u8BC1" tabindex="-1"><a class="header-anchor" href="#basic\u8BA4\u8BC1" aria-hidden="true">#</a> Basic\u8BA4\u8BC1</h4><p>Basic\u8BA4\u8BC1\u662F\u5F53\u5BA2\u6237\u7AEF\u4E0E\u670D\u52A1\u5668\u7AEF\u8FDB\u884C\u8BF7\u6C42\u65F6\uFF0C\u5141\u8BB8\u901A\u8FC7\u7528\u6237\u540D\u548C\u5BC6\u7801\u5B9E\u73B0\u7684\u4E00\u79CD\u8EAB\u4EFD\u8BA4\u8BC1\u65B9\u5F0F\u3002</p><p>Basic\u8BA4\u8BC1\u4F1A\u53BB\u68C0\u67E5\u8BF7\u6C42\u62A5\u5934\u4E2D\u7684Authorization\u5B57\u6BB5\u3002Basic\u8BA4\u8BC1\u4F1A\u5C06\u7528\u6237\u540D\u548C\u5BC6\u7801\u90E8\u5206\u7EC4\u5408\u7136\u540E\u8FDB\u884CBase64\u7F16\u7801\u3002</p><p>\u54CD\u5E94\u5934\u4E2D\u7684<code>WWW-Authenticate</code>\u5B57\u6BB5\u4F1A\u544A\u77E5\u6D4F\u89C8\u5668\u91C7\u7528\u4EC0\u4E48\u6837\u7684\u8BA4\u8BC1\u548C\u52A0\u5BC6\u65B9\u5F0F\u3002</p><p>Basic\u8BA4\u8BC1\u4E00\u822C\u5728\u53EA\u6709HTTPS\u7684\u60C5\u51B5\u4E0B\u624D\u4F1A\u4F7F\u7528\u3002</p><h3 id="_8-2-\u6570\u636E\u4E0A\u4F20" tabindex="-1"><a class="header-anchor" href="#_8-2-\u6570\u636E\u4E0A\u4F20" aria-hidden="true">#</a> 8.2 \u6570\u636E\u4E0A\u4F20</h3><p>\u901A\u8FC7\u5224\u65AD\u62A5\u5934\u7684<code>Transfer-Encoding</code>\u6216<code>Content-Length</code>\u6765\u5224\u65AD\u8BF7\u6C42\u4E2D\u662F\u5426\u5E26\u6709\u5185\u5BB9\u3002</p><h4 id="_8-2-1-\u8868\u5355\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_8-2-1-\u8868\u5355\u6570\u636E" aria-hidden="true">#</a> 8.2.1 \u8868\u5355\u6570\u636E</h4><p>\u8868\u5355\u63D0\u4EA4\u7684\u8BF7\u6C42\u5934<code>Content-Type</code>\u5B57\u6BB5\u503C\u4E3A<code>application/x-www-form-urlencoded</code>\u3002</p><h4 id="_8-2-2-\u5176\u4ED6\u683C\u5F0F" tabindex="-1"><a class="header-anchor" href="#_8-2-2-\u5176\u4ED6\u683C\u5F0F" aria-hidden="true">#</a> 8.2.2 \u5176\u4ED6\u683C\u5F0F</h4><p>JSON\u7C7B\u578B\u7684\u503C\u4E3A<code>application/json</code>\uFF0CXML\u7C7B\u578B\u7684\u503C\u4E3A<code>application/xml</code>\u3002</p><p>\u89E3\u6790JSON\u6587\u4EF6\u901A\u8FC7<code>JSON.parse()</code>\uFF0C\u89E3\u6790XML\u6587\u4EF6\u901A\u8FC7xml2js\u6A21\u5757\u5904\u7406\u3002</p><h4 id="_8-2-3-\u9644\u4EF6\u4E0A\u4F20" tabindex="-1"><a class="header-anchor" href="#_8-2-3-\u9644\u4EF6\u4E0A\u4F20" aria-hidden="true">#</a> 8.2.3 \u9644\u4EF6\u4E0A\u4F20</h4><p>\u7279\u6B8A\u8868\u5355\u7684\u503C\u4E3A<code>multipart/form-data</code>\u3002</p><h4 id="_8-2-4-\u6570\u636E\u4E0A\u4F20\u4E8E\u5B89\u5168" tabindex="-1"><a class="header-anchor" href="#_8-2-4-\u6570\u636E\u4E0A\u4F20\u4E8E\u5B89\u5168" aria-hidden="true">#</a> 8.2.4 \u6570\u636E\u4E0A\u4F20\u4E8E\u5B89\u5168</h4><h5 id="_1-\u5185\u5B58\u9650\u5236" tabindex="-1"><a class="header-anchor" href="#_1-\u5185\u5B58\u9650\u5236" aria-hidden="true">#</a> 1.\u5185\u5B58\u9650\u5236</h5><p>\u89E3\u51B3\u5185\u5B58\u88AB\u5360\u5149\u7684\u95EE\u9898\uFF1A</p><ul><li>\u9650\u5236\u4E0A\u4F20\u5185\u5BB9\u7684\u5927\u5C0F\uFF0C\u4E00\u65E6\u8D85\u8FC7\u9650\u5236\uFF0C\u505C\u6B62\u63A5\u6536\u6570\u636E\uFF0C\u5E76\u54CD\u5E94400\u72B6\u6001\u7801\u3002</li><li>\u901A\u8FC7\u6D41\u5F0F\u89E3\u6790\uFF0C\u5C06\u6570\u636E\u6D41\u5BFC\u5411\u5230\u78C1\u76D8\u4E2D\uFF0CNode\u53EA\u4FDD\u7559\u6587\u4EF6\u8DEF\u5F84\u7B49\u5C0F\u6570\u636E\u3002</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// \u9650\u5236</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">bytes</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1024</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">len</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">headers</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">content-length</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">] </span><span style="color:#81A1C1;">?</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">parseInt</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">headers</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">content-length</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">null</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">len</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">len</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">bytes</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeHead</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">413</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="_2-csrf" tabindex="-1"><a class="header-anchor" href="#_2-csrf" aria-hidden="true">#</a> 2.CSRF</h5><p>CSRF\u7684\u5168\u79F0\u662FCross-Site Request Forgery\uFF0C\u4E2D\u6587\u610F\u601D\u662F\u8DE8\u7AD9\u8BF7\u6C42\u4F2A\u9020\u3002</p><p>\u89E3\u51B3CSRF\u653B\u51FB\u7684\u65B9\u6848\u6709\u6DFB\u52A0\u968F\u673A\u503C\u7684\u65B9\u5F0F\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">generateRandom</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">len</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">crypto</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">randomBytes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">Math</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ceil</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">len</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">4</span><span style="color:#D8DEE9FF;">))</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">base64</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">slice</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">len</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_8-3-\u8DEF\u7531\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#_8-3-\u8DEF\u7531\u89E3\u6790" aria-hidden="true">#</a> 8.3 \u8DEF\u7531\u89E3\u6790</h3><h4 id="_8-3-1-\u6587\u4EF6\u8DEF\u5F84\u578B" tabindex="-1"><a class="header-anchor" href="#_8-3-1-\u6587\u4EF6\u8DEF\u5F84\u578B" aria-hidden="true">#</a> 8.3.1 \u6587\u4EF6\u8DEF\u5F84\u578B</h4><ol><li><p>\u9759\u6001\u6587\u4EF6</p><p>\u5C06\u8BF7\u6C42\u8DEF\u5F84\u5BF9\u5E94\u7684\u6587\u4EF6\u53D1\u9001\u7ED9\u5BA2\u6237\u7AEF\u5373\u53EF\u3002</p></li><li><p>\u52A8\u6001\u6587\u4EF6\uFF08\u5C11\u89C1\uFF09</p><p>Web\u670D\u52A1\u5668\u6839\u636EURL\u8DEF\u5F84\u627E\u5230\u5BF9\u5E94\u7684\u6587\u4EF6\u3002</p></li></ol><h4 id="_8-3-2-mvc" tabindex="-1"><a class="header-anchor" href="#_8-3-2-mvc" aria-hidden="true">#</a> 8.3.2 MVC</h4><p>MVC\u6A21\u578B\u7684\u4E3B\u8981\u601D\u60F3\u662F\u5C06\u4E1A\u52A1\u903B\u8F91\u6309\u804C\u8D23\u5206\u79BB\uFF0C\u4E3B\u8981\u5206\u4E3A\u4EE5\u4E0B\u51E0\u79CD\u3002</p><ul><li>\u63A7\u5236\u5668\uFF08Controller\uFF09\uFF0C\u4E00\u7EC4\u884C\u4E3A\u7684\u96C6\u5408\u3002</li><li>\u6A21\u578B\uFF08Model\uFF09\uFF0C\u6570\u636E\u76F8\u5173\u7684\u64CD\u4F5C\u548C\u5C01\u88C5\u3002</li><li>\u89C6\u56FE\uFF08View\uFF09\uFF0C\u89C6\u56FE\u7684\u6E32\u67D3\u3002</li></ul><p>\u5DE5\u4F5C\u6A21\u5F0F\u5982\u4E0B</p><ul><li>\u8DEF\u7531\u89E3\u6790\uFF0C\u6839\u636EURL\u5BFB\u627E\u5230\u5BF9\u5E94\u7684\u63A7\u5236\u5668\u548C\u884C\u4E3A\u3002</li><li>\u884C\u4E3A\u8C03\u7528\u76F8\u5173\u7684\u6A21\u578B\uFF0C\u8FDB\u884C\u6570\u636E\u64CD\u4F5C\u3002</li><li>\u6570\u636E\u64CD\u4F5C\u7ED3\u675F\u540E\uFF0C\u8C03\u7528\u89C6\u56FE\u548C\u76F8\u5173\u6570\u636E\u8FDB\u884C\u9875\u9762\u6E32\u67D3\uFF0C\u8F93\u51FA\u5230\u5BA2\u6237\u7AEF\u3002</li></ul><p>\u8DEF\u7531\u6620\u5C04\u5206\u4E3A\u624B\u5DE5\u6620\u5C04\u548C\u81EA\u7136\u5173\u8054\u6620\u5C04\u3002</p><h4 id="_8-3-3-restful" tabindex="-1"><a class="header-anchor" href="#_8-3-3-restful" aria-hidden="true">#</a> 8.3.3 RESTful</h4><p>REST\u7684\u5168\u79F0\u662FRepresentational State Transfer\uFF0C\u4E2D\u6587\u542B\u4E49\u4E3A\u8868\u73B0\u5C42\u72B6\u6001\u8F6C\u5316\u3002</p><p>\u901A\u8FC7URL\u8BBE\u8BA1\u8D44\u6E90\u3001\u8BF7\u6C42\u65B9\u6CD5\u5B9A\u4E49\u8D44\u6E90\u7684\u64CD\u4F5C\uFF0C\u901A\u8FC7Accept\u51B3\u5B9A\u8D44\u6E90\u7684\u8868\u73B0\u5F62\u5F0F\u3002</p><h3 id="_8-4-\u4E2D\u95F4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_8-4-\u4E2D\u95F4\u4EF6" aria-hidden="true">#</a> 8.4 \u4E2D\u95F4\u4EF6</h3><p>\u4E2D\u95F4\u4EF6\u53EF\u4EE5\u7528\u6765\u7B80\u5316\u548C\u9694\u79BB\u57FA\u7840\u8BBE\u65BD\u4E0E\u4E1A\u52A1\u903B\u8F91\u4E4B\u95F4\u7684\u7EC6\u8282\uFF0C\u8BA9\u5F00\u53D1\u8005\u80FD\u591F\u5173\u6CE8\u5728\u4E1A\u52A1\u7684\u5F00\u53D1\u4E0A\uFF0C\u4EE5\u8FBE\u5230\u63D0\u5347\u5F00\u53D1\u6548\u7387\u7684\u76EE\u7684\u3002</p><h4 id="_8-4-1-\u5F02\u5E38\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_8-4-1-\u5F02\u5E38\u5904\u7406" aria-hidden="true">#</a> 8.4.1 \u5F02\u5E38\u5904\u7406</h4><p>\u6DFB\u52A0err\u53C2\u6570\uFF0C\u6355\u83B7\u4E2D\u95F4\u4EF6\u76F4\u63A5\u629B\u51FA\u7684\u540C\u6B65\u5F02\u5E38\u3002</p><h4 id="_8-4-2-\u4E2D\u95F4\u4EF6\u4E0E\u6027\u80FD" tabindex="-1"><a class="header-anchor" href="#_8-4-2-\u4E2D\u95F4\u4EF6\u4E0E\u6027\u80FD" aria-hidden="true">#</a> 8.4.2 \u4E2D\u95F4\u4EF6\u4E0E\u6027\u80FD</h4><ol><li><p>\u7F16\u5199\u9AD8\u6548\u7684\u4E2D\u95F4\u4EF6</p><ul><li>\u4F7F\u7528\u9AD8\u6548\u7684\u65B9\u6CD5\u3002</li><li>\u7F13\u5B58\u9700\u8981\u91CD\u590D\u8BA1\u7B97\u7684\u7ED3\u679C\u3002</li><li>\u907F\u514D\u4E0D\u5FC5\u8981\u7684\u8BA1\u7B97\u3002</li></ul></li><li><p>\u5408\u7406\u4F7F\u7528\u8DEF\u7531</p><p>\u63D0\u5347\u5339\u914D\u6210\u529F\u7387\uFF0C\u907F\u514DQPS\u76F4\u7EBF\u4E0B\u964D\u3002</p></li></ol><h3 id="_8-5-\u9875\u9762\u6E32\u67D3" tabindex="-1"><a class="header-anchor" href="#_8-5-\u9875\u9762\u6E32\u67D3" aria-hidden="true">#</a> 8.5 \u9875\u9762\u6E32\u67D3</h3><h4 id="_8-5-1-\u5185\u5BB9\u54CD\u5E94" tabindex="-1"><a class="header-anchor" href="#_8-5-1-\u5185\u5BB9\u54CD\u5E94" aria-hidden="true">#</a> 8.5.1 \u5185\u5BB9\u54CD\u5E94</h4><ol><li><p>MIME</p><p>\u6D4F\u89C8\u5668\u901A\u8FC7\u4E0D\u540C\u7684Content-Type\u7684\u503C\u6765\u51B3\u5B9A\u91C7\u7528\u4E0D\u540C\u7684\u6E32\u67D3\u65B9\u5F0F\uFF0C\u8FD9\u4E2A\u503C\u7B80\u79F0MIME\u503C\u3002</p><p>MIME\u7684\u5168\u79F0\u662FMultipurpose Internet Mail Extensions\u3002</p></li><li><p>\u9644\u4EF6\u4E0B\u8F7D</p><p><code>Content-Disposition</code>\u5B57\u6BB5\u53EF\u4EE5\u8BA9\u5BA2\u6237\u7AEF\u6839\u636E\u5B83\u7684\u503C\u5224\u65AD\u5E94\u8BE5\u8BB2\u62A5\u6587\u6570\u636E\u5F53\u505A\u5373\u65F6\u6D4F\u89C8\u7684\u5185\u5BB9\uFF0C\u8FD8\u662F\u53EF\u4E0B\u8F7D\u7684\u9644\u4EF6\u3002</p><p>\u5373\u65F6\u67E5\u770B\u503C\u4E3Ainline\uFF0C\u5B58\u4E3A\u9644\u4EF6\u503C\u4E3Aattachement\u3002<code>Content-Disposition: attachment; filename=&quot;filename.ext&quot;</code></p></li><li><p>\u54CD\u5E94JSON</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">json</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">json</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setHeader</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Content-Type</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">application/json</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeHead</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">200</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stringify</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">json</span><span style="color:#D8DEE9FF;">))</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li><p>\u54CD\u5E94\u8DF3\u8F6C</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">redirect</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">url</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setHeader</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Location</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">url</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeHead</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">302</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Redirect to </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">url</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ol><h4 id="_8-5-2-\u89C6\u56FE\u6E32\u67D3" tabindex="-1"><a class="header-anchor" href="#_8-5-2-\u89C6\u56FE\u6E32\u67D3" aria-hidden="true">#</a> 8.5.2 \u89C6\u56FE\u6E32\u67D3</h4><p>\u901A\u8FC7\u540E\u7AEF\u8FD4\u56DEhtml\u7247\u6BB5\u751F\u6210\u89C6\u56FE\u3002</p><h4 id="_8-5-3-\u6A21\u677F" tabindex="-1"><a class="header-anchor" href="#_8-5-3-\u6A21\u677F" aria-hidden="true">#</a> 8.5.3 \u6A21\u677F</h4><p>\u5B9E\u8D28\u662F\u5C06\u6A21\u677F\u6587\u4EF6\u548C\u6570\u636E\u901A\u8FC7\u6A21\u677F\u5F15\u64CE\u751F\u6210\u6700\u7EC8\u7684HTML\u4EE3\u7801\u3002\u6A21\u677F\u6280\u672F\u4F7F\u5F97\u7F51\u9875\u4E2D\u7684\u52A8\u6001\u5185\u5BB9\u548C\u9759\u6001\u5185\u5BB9\u53D8\u5F97\u4E0D\u4E92\u76F8\u4F9D\u8D56\u3002</p><ol><li><p>\u6A21\u677F\u5F15\u64CE</p><ul><li>\u8BED\u6CD5\u5206\u89E3\u3002\u63D0\u53D6\u51FA\u666E\u901A\u5B57\u7B26\u4E32\u548C\u8868\u8FBE\u5F0F\u3002</li><li>\u5904\u7406\u8868\u8FBE\u5F0F\u3002\u5C06\u6807\u7B7E\u8868\u8FBE\u5F0F\u8F6C\u6362\u6210\u666E\u901A\u7684\u8BED\u8A00\u8868\u8FBE\u5F0F\u3002</li><li>\u751F\u6210\u5F85\u6267\u884C\u7684\u8BED\u53E5\u3002</li><li>\u4E0E\u6570\u636E\u4E00\u8D77\u6267\u884C\uFF0C\u751F\u6210\u6700\u7EC8\u5B57\u7B26\u4E32\u3002</li></ul><p>\u5C06\u539F\u59CB\u7684\u6A21\u677F\u5B57\u7B26\u4E32\u8F6C\u6210\u4E00\u4E2A\u51FD\u6570\u5BF9\u8C61\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\u79F0\u4E3A\u6A21\u677F\u7F16\u8BD1\u3002</p></li><li><p>with\u7684\u5E94\u7528</p><p><code>tpl = &#39;var tpl = &quot;&quot;;\\nwith (obj) {&#39; + tpl + &#39;}\\nreturn tpl;&#39;;</code></p><p>\u6A21\u677F\u6280\u672F\u9700\u8981\u6CE8\u610F\u65F6\u523B\u8F6C\u4E49\u3002</p></li><li><p>\u6A21\u677F\u903B\u8F91</p></li><li><p>\u96C6\u6210\u6587\u4EF6\u7CFB\u7EDF</p></li><li><p>\u5B50\u6A21\u677F</p></li><li><p>\u5E03\u5C40\u89C6\u56FE</p></li><li><p>\u6A21\u677F\u6027\u80FD</p></li></ol><p>\u6A21\u677F\u5F15\u64CE\u6A21\u5757<strong>EJS</strong>\u3002</p><h4 id="_8-5-4-bigpipe" tabindex="-1"><a class="header-anchor" href="#_8-5-4-bigpipe" aria-hidden="true">#</a> 8.5.4 Bigpipe</h4><p>\u5728\u6570\u636E\u54CD\u5E94\u4E4B\u524D\uFF0C\u7528\u6237\u770B\u5230\u7684\u662F\u7A7A\u767D\u9875\u9762\uFF0C\u8FD9\u5BF9\u7528\u6237\u4F53\u9A8C\u5341\u5206\u4E0D\u53CB\u597D\u3002Bigpipe\u7684\u89E3\u51B3\u601D\u8DEF\u662F\u5C06\u9875\u9762\u5206\u5272\u6210\u591A\u4E2A\u90E8\u5206\uFF08pagelet\uFF09\uFF0C\u5148\u5411\u7528\u6237\u8F93\u51FA\u6CA1\u6709\u6570\u636E\u7684\u5E03\u5C40\uFF08\u6846\u67B6\uFF09\uFF0C\u5C06\u6BCF\u4E2A\u90E8\u5206\u9010\u6B65\u8F93\u51FA\u5230\u524D\u7AEF\uFF0C\u6700\u7EC8\u6E32\u67D3\u586B\u5145\u6846\u67B6\uFF0C\u5B8C\u6210\u6574\u4E2A\u9875\u9762\u7684\u6E32\u67D3\u3002\u9700\u8981\u524D\u540E\u7AEF\u7684\u914D\u5408\u3002</p><h2 id="\u7B2C9\u7AE0-\u73A9\u8F6C\u8FDB\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u7B2C9\u7AE0-\u73A9\u8F6C\u8FDB\u7A0B" aria-hidden="true">#</a> \u7B2C9\u7AE0 \u73A9\u8F6C\u8FDB\u7A0B</h2><p>JavaScript\u8FD0\u884C\u5728\u5355\u4E2A\u8FDB\u7A0B\u7684\u5355\u4E2A\u7EBF\u7A0B\u4E0A\u3002</p><h3 id="_9-1-\u670D\u52A1\u6A21\u578B\u7684\u53D8\u8FC1" tabindex="-1"><a class="header-anchor" href="#_9-1-\u670D\u52A1\u6A21\u578B\u7684\u53D8\u8FC1" aria-hidden="true">#</a> 9.1 \u670D\u52A1\u6A21\u578B\u7684\u53D8\u8FC1</h3><h4 id="_9-1-1-\u77F3\u5668\u65F6\u4EE3-\u540C\u6B65" tabindex="-1"><a class="header-anchor" href="#_9-1-1-\u77F3\u5668\u65F6\u4EE3-\u540C\u6B65" aria-hidden="true">#</a> 9.1.1 \u77F3\u5668\u65F6\u4EE3\uFF1A\u540C\u6B65</h4><p>\u670D\u52A1\u6A21\u5F0F\u662F\u4E00\u6B21\u53EA\u4E3A\u4E00\u4E2A\u8BF7\u6C42\u670D\u52A1\uFF0C\u6240\u6709\u8BF7\u6C42\u90FD\u5F97\u6309\u6B21\u5E8F\u7B49\u5F85\u670D\u52A1\u3002QPS\u4E3A1/N\u3002</p><h4 id="_9-1-2-\u9752\u94DC\u65F6\u4EE3-\u590D\u5236\u8FDB\u7A0B" tabindex="-1"><a class="header-anchor" href="#_9-1-2-\u9752\u94DC\u65F6\u4EE3-\u590D\u5236\u8FDB\u7A0B" aria-hidden="true">#</a> 9.1.2 \u9752\u94DC\u65F6\u4EE3\uFF1A\u590D\u5236\u8FDB\u7A0B</h4><p>\u901A\u8FC7\u8FDB\u7A0B\u7684\u590D\u5236\u540C\u65F6\u670D\u52A1\u66F4\u591A\u7684\u8BF7\u6C42\u548C\u7528\u6237\u3002QPS\u4E3AM/N\u3002</p><h4 id="_9-1-3-\u767D\u94F6\u65F6\u4EE3-\u591A\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#_9-1-3-\u767D\u94F6\u65F6\u4EE3-\u591A\u7EBF\u7A0B" aria-hidden="true">#</a> 9.1.3 \u767D\u94F6\u65F6\u4EE3\uFF1A\u591A\u7EBF\u7A0B</h4><p>\u4E00\u4E2A\u7EBF\u7A0B\u670D\u52A1\u4E00\u4E2A\u8BF7\u6C42\u3002\u7531\u4E8E\u4E00\u4E2ACPU\u6838\u5FC3\u5728\u4E00\u4E2A\u65F6\u523B\u53EA\u80FD\u505A\u4E00\u4EF6\u4E8B\uFF0C\u64CD\u4F5C\u7CFB\u7EDF\u53EA\u80FD\u901A\u8FC7\u5C06CPU\u5207\u5206\u4E3A\u65F6\u95F4\u7247\u7684\u65B9\u6CD5\uFF0C\u8BA9\u7EBF\u7A0B\u8F83\u4E3A\u5747\u5300\u5730\u4F7F\u7528CPU\u8D44\u6E90\u3002</p><p>\u5F53\u7EBF\u7A0B\u6570\u91CF\u8FC7\u591A\u65F6\uFF0C\u65F6\u95F4\u5C06\u4F1A\u88AB\u8017\u7528\u5728\u4E0A\u4E0B\u6587\u5207\u6362\u4E2D\u3002QPS\u4E3AM*L/N\u3002</p><h4 id="_9-1-4-\u9EC4\u91D1\u65F6\u4EE3-\u4E8B\u4EF6\u9A71\u52A8" tabindex="-1"><a class="header-anchor" href="#_9-1-4-\u9EC4\u91D1\u65F6\u4EE3-\u4E8B\u4EF6\u9A71\u52A8" aria-hidden="true">#</a> 9.1.4 \u9EC4\u91D1\u65F6\u4EE3\uFF1A\u4E8B\u4EF6\u9A71\u52A8</h4><p>\u91C7\u7528\u5355\u7EBF\u7A0B\u907F\u514D\u4E86\u4E0D\u5FC5\u8981\u7684\u5185\u5B58\u5F00\u9500\u548C\u4E0A\u4E0B\u6587\u5207\u6362\u5F00\u9500\u3002</p><p>\u5BF9\u4E8ENode\u6765\u8BF4\uFF0C\u6240\u6709\u8BF7\u6C42\u7684\u4E0A\u4E0B\u6587\u90FD\u662F\u7EDF\u4E00\u7684\u3002</p><h3 id="_9-2-\u591A\u8FDB\u7A0B\u67B6\u6784" tabindex="-1"><a class="header-anchor" href="#_9-2-\u591A\u8FDB\u7A0B\u67B6\u6784" aria-hidden="true">#</a> 9.2 \u591A\u8FDB\u7A0B\u67B6\u6784</h3><p>Node\u63D0\u4F9B\u4E86<code>child_process</code>\u6A21\u5757\u5B9E\u73B0\u591A\u6838CPU\u5229\u7528\u3002</p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJJBj.jpg" alt="gjJJBj.jpg"></p><p>Master-Worker\uFF0C\u4E3B\u4ECE\u6A21\u5F0F\uFF0C\u4E3B\u8FDB\u7A0B\u4E0D\u8D1F\u8D23\u5177\u4F53\u7684\u4E1A\u52A1\u5904\u7406\uFF0C\u800C\u662F\u8D1F\u8D23\u8C03\u5EA6\u6216\u7BA1\u7406\u5DE5\u4F5C\u8FDB\u7A0B\uFF0C\u5B83\u662F\u8D8B\u5411\u4E8E\u7A33\u5B9A\u7684\u3002\u5DE5\u4F5C\u8FDB\u7A0B\u8D1F\u8D23\u5177\u4F53\u7684\u4E1A\u52A1\u5904\u7406\uFF0C\u56E0\u4E3A\u4E1A\u52A1\u7684\u591A\u79CD\u591A\u6837\uFF0C\u751A\u81F3\u4E00\u9879\u4E1A\u52A1\u7531\u591A\u4EBA\u5F00\u53D1\u5B8C\u6210\uFF0C\u6240\u4EE5\u5DE5\u4F5C\u8FDB\u7A0B\u7684\u7A33\u5B9A\u6027\u503C\u5F97\u5F00\u53D1\u8005\u5173\u6CE8\u3002</p><p>\u901A\u8FC7fork()\u590D\u5236\u7684\u8FDB\u7A0B\u90FD\u662F\u4E00\u4E2A\u72EC\u7ACB\u7684\u8FDB\u7A0B\uFF0C\u8FD9\u4E2A\u8FDB\u7A0B\u4E2D\u6709\u7740\u72EC\u7ACB\u800C\u5168\u65B0\u7684V8\u5B9E\u4F8B\u3002\u5B83\u9700\u8981\u81F3\u5C1130\u6BEB\u79D2\u7684\u542F\u52A8\u65F6\u95F4\u548C\u81F3\u5C1110MB\u7684\u5185\u5B58\u3002fork()\u8FDB\u7A0B\u662F\u6602\u8D35\u7684\u3002</p><h4 id="_9-2-1-\u521B\u5EFA\u5B50\u8FDB\u7A0B" tabindex="-1"><a class="header-anchor" href="#_9-2-1-\u521B\u5EFA\u5B50\u8FDB\u7A0B" aria-hidden="true">#</a> 9.2.1 \u521B\u5EFA\u5B50\u8FDB\u7A0B</h4><p><code>child_process</code>\u6A21\u5757\u63D0\u4F9B\u521B\u5EFA\u5B50\u8FDB\u7A0B\u7684\u80FD\u529B\uFF0C4\u4E2A\u65B9\u6CD5\u521B\u5EFA\u5B50\u8FDB\u7A0B\u3002</p><ul><li>spawn()\uFF1A\u542F\u52A8\u4E00\u4E2A\u5B50\u8FDB\u7A0B\u6765\u6267\u884C\u547D\u4EE4\u3002</li><li>exec()\uFF1A\u542F\u52A8\u4E00\u4E2A\u5B50\u8FDB\u7A0B\u6765\u6267\u884C\u547D\u4EE4\uFF0C\u4E0Espawn()\u4E0D\u540C\u7684\u662F\u5176\u63A5\u53E3\u4E0D\u540C\uFF0C\u5B83\u7531\u4E00\u4E2A\u56DE\u8C03\u51FD\u6570\u83B7\u77E5\u5B50\u8FDB\u7A0B\u7684\u72B6\u51B5\u3002</li><li>execFile()\uFF1A\u542F\u52A8\u4E00\u4E2A\u5B50\u8FDB\u7A0B\u6765\u6267\u884C\u53EF\u6267\u884C\u6587\u4EF6\u3002</li><li>fork()\uFF1A\u4E0Espawn()\u7C7B\u4F3C\uFF0C\u4E0D\u540C\u70B9\u5728\u4E8E\u5B83\u521B\u5EFANode\u7684\u5B50\u8FDB\u7A0B\u53EA\u9700\u6307\u5B9A\u8981\u6267\u884C\u7684JavaScript\u6587\u4EF6\u6A21\u5757\u5373\u53EF\u3002</li></ul><h4 id="_9-2-2-\u8FDB\u7A0B\u95F4\u901A\u4FE1" tabindex="-1"><a class="header-anchor" href="#_9-2-2-\u8FDB\u7A0B\u95F4\u901A\u4FE1" aria-hidden="true">#</a> 9.2.2 \u8FDB\u7A0B\u95F4\u901A\u4FE1</h4><p>\u4E3B\u7EBF\u7A0B\u4E0E\u5DE5\u4F5C\u7EBF\u7A0B\u4E4B\u95F4\u901A\u8FC7<code>onmessage()</code>\u548C<code>postMessage()</code>\u8FDB\u884C\u901A\u4FE1\uFF0C\u5B50\u8FDB\u7A0B\u5BF9\u8C61\u5219\u7531<code>send()</code>\u65B9\u6CD5\u5B9E\u73B0\u4E3B\u8FDB\u7A0B\u5411\u5B50\u8FDB\u7A0B\u53D1\u9001\u6570\u636E\uFF0C<code>message</code>\u4E8B\u4EF6\u5B9E\u73B0\u6536\u542C\u5B50\u8FDB\u7A0B\u53D1\u6765\u7684\u6570\u636E\u3002</p><p>\u7236\u8FDB\u7A0B\u4E0E\u5B50\u8FDB\u7A0B\u4E4B\u95F4\u4F1A\u521B\u5EFAIPC\u901A\u9053\uFF0C\u901A\u8FC7IPC\u901A\u9053\uFF0C\u7236\u5B50\u8FDB\u7A0B\u4E4B\u95F4\u624D\u80FD\u901A\u8FC7message()\u548Csend()\u4F20\u9012\u6D88\u606F\u3002</p><h5 id="\u8FDB\u7A0B\u95F4\u901A\u4FE1\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u8FDB\u7A0B\u95F4\u901A\u4FE1\u539F\u7406" aria-hidden="true">#</a> \u8FDB\u7A0B\u95F4\u901A\u4FE1\u539F\u7406</h5><p>IPC\u5168\u79F0\u662FInter-Process Communication\uFF0C\u5373\u8FDB\u7A0B\u95F4\u901A\u4FE1\u3002\u8FDB\u7A0B\u95F4\u901A\u4FE1\u7684\u76EE\u7684\u662F\u4E3A\u4E86\u8BA9\u4E0D\u540C\u7684\u8FDB\u7A0B\u80FD\u591F\u4E92\u76F8\u8BBF\u95EE\u8D44\u6E90\u5E76\u8FDB\u884C\u534F\u8C03\u5DE5\u4F5C\u3002</p><p>\u8FDB\u7A0B\u95F4\u901A\u4FE1\u7684\u6280\u672F\u6709\u547D\u540D\u7BA1\u9053\u3001\u533F\u540D\u7BA1\u9053\u3001socket\u3001\u4FE1\u53F7\u91CF\u3001\u5171\u4EAB\u5185\u5B58\u3001\u6D88\u606F\u961F\u5217\u3001Domain Socket\u7B49\u3002Node\u7684\u901A\u4FE1\u6280\u672F\u5177\u4F53\u5B9E\u73B0\u6709libuv\u63D0\u4F9B\uFF0C\u5728Window\u4E0B\u7531\u547D\u540D\u7BA1\u9053\uFF08named pipe\uFF09\u5B9E\u73B0\uFF0C*nix\u7CFB\u7EDF\u7531Unix Domain Socket\u5B9E\u73B0\u3002</p><p>\u7236\u8FDB\u7A0B\u5728\u5B9E\u9645\u521B\u5EFA\u5B50\u8FDB\u7A0B\u4E4B\u524D\uFF0C\u4F1A\u521B\u5EFAIPC\u901A\u4FE1\u5E76\u76D1\u542C\u5B83\uFF0C\u7136\u540E\u624D\u771F\u6B63\u521B\u5EFA\u51FA\u5B50\u8FDB\u7A0B\uFF0C\u5E76\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\uFF08NODE_CHANNEL_FD)\u544A\u8BC9\u5B50\u8FDB\u7A0B\u8FD9\u4E2AIPC\u901A\u9053\u7684\u6587\u4EF6\u63CF\u8FF0\u7B26\u3002\u5B50\u8FDB\u7A0B\u5728\u542F\u52A8\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u6839\u636E\u6587\u4EF6\u63CF\u8FF0\u7B26\u53BB\u8FDE\u63A5\u8FD9\u4E2A\u5DF2\u5B58\u5728\u7684IPC\u901A\u9053\uFF0C\u4ECE\u800C\u5B8C\u6210\u7236\u5B50\u8FDB\u7A0B\u4E4B\u95F4\u7684\u8FDE\u63A5\u3002</p><p>\u7531\u4E8EIPC\u901A\u9053\u662F\u7528\u547D\u540D\u7BA1\u9053\u6216Domain Socket\u521B\u5EFA\u7684\uFF0C\u5C5E\u4E8E\u53CC\u5411\u901A\u884C\u3002IPC\u901A\u9053\u88AB\u62BD\u8C61\u4E3AStream\u5BF9\u8C61\uFF0C\u901A\u8FC7send()\u53D1\u9001\u6570\u636E\uFF0Cmessage\u4E8B\u4EF6\u89E6\u53D1\u7ED9\u5E94\u7528\u5C42\u3002</p><h4 id="_9-2-3-\u53E5\u67C4\u4F20\u9012" tabindex="-1"><a class="header-anchor" href="#_9-2-3-\u53E5\u67C4\u4F20\u9012" aria-hidden="true">#</a> 9.2.3 \u53E5\u67C4\u4F20\u9012</h4><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJYHs.jpg" alt="gjJYHs.jpg"></p><p><code>send()</code>\u65B9\u6CD5\u7B2C\u4E8C\u4E2A\u53EF\u9009\u53C2\u6570\u53EF\u4EE5\u53D1\u9001\u53E5\u67C4\u3002\u53E5\u67C4\u662F\u4E00\u79CD\u53EF\u4EE5\u7528\u6765\u6807\u8BC6\u8D44\u6E90\u7684\u5F15\u7528\uFF0C\u5B83\u7684\u5185\u90E8\u5305\u542B\u4E86\u6307\u5411\u5BF9\u8C61\u7684\u6587\u4EF6\u63CF\u8FF0\u7B26\u3002</p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/gjJUNq.jpg" alt="gjJUNq.jpg"></p><h5 id="_1-\u53E5\u67C4\u53D1\u9001\u4E0E\u8FD8\u539F" tabindex="-1"><a class="header-anchor" href="#_1-\u53E5\u67C4\u53D1\u9001\u4E0E\u8FD8\u539F" aria-hidden="true">#</a> 1.\u53E5\u67C4\u53D1\u9001\u4E0E\u8FD8\u539F</h5><p>\u5B50\u8FDB\u7A0B\u5BF9\u8C61send()\u65B9\u6CD5\u53EF\u4EE5\u53D1\u9001\u7684\u53E5\u67C4\u7C7B\u578B\u5982\u4E0B\u51E0\u79CD\uFF1A</p><ul><li>net.Socket\u3002TCP\u5957\u63A5\u5B57\u3002</li><li>net.Server\u3002TCP\u670D\u52A1\u5668\uFF0C\u4EFB\u610F\u5EFA\u8BAE\u5728TCP\u670D\u52A1\u5668\u4E0A\u7684\u5E94\u7528\u5C42\u670D\u52A1\u90FD\u53EF\u4EE5\u4EAB\u53D7\u5230\u5B83\u5E26\u6765\u7684\u597D\u5904\u3002</li><li>net.Native\u3002C++\u5C42\u9762\u7684TCP\u5957\u63A5\u5B57\u6216IPC\u7BA1\u9053\u3002</li><li>dgram.Socket\u3002UDP\u5957\u63A5\u5B57\u3002</li><li>dgram.Native\u3002C++\u5C42\u9762\u7684UDP\u5957\u63A5\u5B57\u3002</li></ul><p>\u53D1\u9001\u5230IPC\u7BA1\u9053\u4E2D\u7684\u5B9E\u9645\u4E0A\u662F\u6211\u4EEC\u8981\u53D1\u9001\u7684\u53E5\u67C4\u6587\u4EF6\u63CF\u8FF0\u7B26\uFF0C\u6587\u4EF6\u63CF\u8FF0\u7B26\u662F\u4E00\u4E2A\u6574\u6570\u503C\u3002\u5199\u5165\u5230IPC\u7BA1\u9053\u4F1A\u901A\u8FC7JSON.Stringify()\u8FDB\u884C\u5E8F\u5217\u5316\uFF0C\u5B50\u8FDB\u7A0B\u8BFB\u53D6\u65F6\u901A\u8FC7JSON.parse()\u89E3\u6790\u8FD8\u539F\u3002</p><h5 id="_2-\u7AEF\u53E3\u5171\u540C\u76D1\u542C" tabindex="-1"><a class="header-anchor" href="#_2-\u7AEF\u53E3\u5171\u540C\u76D1\u542C" aria-hidden="true">#</a> 2.\u7AEF\u53E3\u5171\u540C\u76D1\u542C</h5><p>send()\u53D1\u9001\u7684\u53E5\u67C4\u8FD8\u539F\u51FA\u6765\u7684\u670D\u52A1\u800C\u8A00\uFF0C\u5B83\u4EEC\u7684\u6587\u4EF6\u63CF\u8FF0\u7B26\u662F\u76F8\u540C\u7684\uFF0C\u6240\u4EE5\u76D1\u542C\u76F8\u540C\u7AEF\u53E3\u4E0D\u4F1A\u5F15\u8D77\u5F02\u5E38\u3002</p><p>\u591A\u4E2A\u5E94\u7528\u76D1\u542C\u76F8\u540C\u7AEF\u53E3\u65F6\uFF0C\u6587\u4EF6\u63CF\u8FF0\u7B26\u540C\u4E00\u65F6\u95F4\u53EA\u80FD\u88AB\u67D0\u4E2A\u8FDB\u7A0B\u6240\u7528\u3002</p><h3 id="_9-3-\u96C6\u7FA4\u7A33\u5B9A\u4E4B\u8DEF" tabindex="-1"><a class="header-anchor" href="#_9-3-\u96C6\u7FA4\u7A33\u5B9A\u4E4B\u8DEF" aria-hidden="true">#</a> 9.3 \u96C6\u7FA4\u7A33\u5B9A\u4E4B\u8DEF</h3><h4 id="_9-3-1-\u8FDB\u7A0B\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#_9-3-1-\u8FDB\u7A0B\u4E8B\u4EF6" aria-hidden="true">#</a> 9.3.1 \u8FDB\u7A0B\u4E8B\u4EF6</h4><p>\u9664\u4E86message\u4E8B\u4EF6\uFF0C\u8FD8\u6709\u5982\u4E0B\u4E8B\u4EF6\uFF1A</p><ul><li>error\uFF1A\u5F53\u5B50\u8FDB\u7A0B\u65E0\u6CD5\u88AB\u590D\u5236\u521B\u5EFA\u3001\u65E0\u6CD5\u88AB\u6740\u6B7B\u3001\u65E0\u6CD5\u53D1\u9001\u6D88\u606F\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>exit\uFF1A\u5B50\u8FDB\u7A0B\u9000\u51FA\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\uFF0C\u5B50\u8FDB\u7A0B\u5982\u679C\u662F\u6B63\u5E38\u9000\u51FA\uFF0C\u8FD9\u4E2A\u4E8B\u4EF6\u7684\u7B2C\u4E00\u4E2A\u53C2\u6570\u4E3A\u9000\u51FA\u7801\uFF0C\u5426\u5219\u4E3Anull\u3002\u5982\u679C\u8FDB\u7A0B\u662F\u901A\u8FC7kill()\u88AB\u6740\u6B7B\uFF0C\u4F1A\u5F97\u5230\u7B2C\u4E8C\u4E2A\u53C2\u6570\u8868\u793A\u6740\u6B7B\u8FDB\u7A0B\u65F6\u7684\u4FE1\u53F7\u3002</li><li>close\uFF1A\u5728\u5B50\u8FDB\u7A0B\u7684\u6807\u51C6\u8F93\u5165\u8F93\u51FA\u6D41\u4E2D\u6B62\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\uFF0C\u53C2\u6570\u4E0Eexit\u76F8\u540C\u3002</li><li>disconnect\uFF1A\u5728\u7236\u8FDB\u7A0B\u6216\u5B50\u8FDB\u7A0B\u8C03\u7528disconnect()\u65B9\u6CD5\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6\uFF0C\u5728\u8C03\u7528\u8BE5\u65B9\u6CD5\u65F6\u5C06\u5173\u95ED\u76D1\u542CIPC\u7BA1\u9053\u3002</li></ul><p><code>kill()</code>\u65B9\u6CD5\u7ED9\u5B50\u8FDB\u7A0B\u53D1\u9001\u6D88\u606F\uFF0C\u5B83\u5E76\u4E0D\u80FD\u771F\u6B63\u7684\u6740\u6B7B\u5B50\u8FDB\u7A0B\uFF0C\u5B50\u8FDB\u7A0B\u9700\u8981\u76D1\u542C<strong>\u4FE1\u53F7\u5217\u8868</strong>\uFF0C\u4E4B\u540E\u505A\u51FA\u56DE\u5E94\u3002</p><h4 id="_9-3-2-\u81EA\u52A8\u91CD\u542F" tabindex="-1"><a class="header-anchor" href="#_9-3-2-\u81EA\u52A8\u91CD\u542F" aria-hidden="true">#</a> 9.3.2 \u81EA\u52A8\u91CD\u542F</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">fork</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">child_process</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">fork</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">cpus</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">os</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">cpus</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">server</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">net</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createServer</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">server</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1337</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">workers</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">createWorker</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">worker</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">fork</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./worker.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">worker</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">exit</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">Worker </span><span style="color:#81A1C1;">\${</span><span style="color:#D8DEE9;">worker</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">pid</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> exited.</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">delete</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">workers</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">worker</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">pid</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">createWorker</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">worker</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">send</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">server</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">server</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">workers</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">worker</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">pid</span><span style="color:#D8DEE9FF;">] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">worker</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">Create worker. pid: </span><span style="color:#81A1C1;">\${</span><span style="color:#D8DEE9;">worker</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">pid</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">i</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">i</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">cpus</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">i</span><span style="color:#81A1C1;">++</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#88C0D0;">createWorker</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">process</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">exit</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">pid</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">workers</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">workers</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">pid</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">kill</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ol><li><p>\u81EA\u6740\u4FE1\u53F7</p><p>\u5DE5\u4F5C\u8FDB\u7A0B\u5728\u5F97\u77E5\u8981\u9000\u51FA\u65F6\uFF0C\u5411\u4E3B\u8FDB\u7A0B\u53D1\u9001\u4E00\u4E2A\u81EA\u6740\u4FE1\u53F7\uFF0C\u7136\u540E\u624D\u505C\u6B62\u65B0\u7684\u8FDE\u63A5\uFF0C\u5F53\u6240\u6709\u8FDE\u63A5\u65AD\u5F00\u540E\u624D\u9000\u51FA\u3002</p><p>\u4E3B\u8FDB\u7A0B\u5728\u63A5\u53D7\u5230\u81EA\u6740\u4EFB\u52A1\u540E\uFF0C\u7ACB\u5373\u521B\u5EFA\u65B0\u7684\u5DE5\u4F5C\u8FDB\u7A0B\u670D\u52A1\u3002</p></li><li><p>\u9650\u91CF\u91CD\u542F</p><p>\u5728\u5355\u4F4D\u65F6\u95F4\u5185\u89C4\u5B9A\u53EA\u80FD\u91CD\u542F\u591A\u5C11\u6B21\uFF0C\u8D85\u8FC7\u9650\u5236\u5C31\u89E6\u53D1giveup\u4E8B\u4EF6\u3002</p></li></ol><h4 id="_9-3-3-\u8D1F\u8F7D\u5747\u8861" tabindex="-1"><a class="header-anchor" href="#_9-3-3-\u8D1F\u8F7D\u5747\u8861" aria-hidden="true">#</a> 9.3.3 \u8D1F\u8F7D\u5747\u8861</h4><p>\u4FDD\u8BC1\u591A\u4E2A\u5904\u7406\u5355\u5143\u5DE5\u4F5C\u91CF\u516C\u5E73\u7684\u7B56\u7565\u53EB\u8D1F\u8F7D\u5747\u8861\u3002</p><p>Node\u9ED8\u8BA4\u63D0\u4F9B\u7684\u673A\u5236\u662F\u91C7\u7528\u64CD\u4F5C\u7CFB\u7EDF\u7684\u62A2\u5360\u5F0F\u7B56\u7565\u3002\u8C01\u62A2\u5230\u8C01\u670D\u52A1\u3002</p><p>**\u8F6E\u53EB\u8C03\u5EA6\uFF1A**\u7531\u4E3B\u8FDB\u7A0B\u63A5\u53D7\u8FDE\u63A5\uFF0C\u5C06\u5176\u4F9D\u6B21\u5206\u53D1\u7ED9\u5DE5\u4F5C\u8FDB\u7A0B\u3002\u5206\u53D1\u7684\u7B56\u7565\u662F\u5728N\u4E2A\u5DE5\u4F5C\u8FDB\u7A0B\u4E2D\uFF0C\u6BCF\u6B21\u9009\u62E9\u7B2Ci=(i+1)mod n\u4E2A\u8FDB\u7A0B\u6765\u53D1\u9001\u8FDE\u63A5\u3002</p><h4 id="_9-3-4-\u72B6\u6001\u5171\u4EAB" tabindex="-1"><a class="header-anchor" href="#_9-3-4-\u72B6\u6001\u5171\u4EAB" aria-hidden="true">#</a> 9.3.4 \u72B6\u6001\u5171\u4EAB</h4><p>\u5B9E\u73B0\u6570\u636E\u5728\u591A\u4E2A\u8FDB\u7A0B\u4E4B\u95F4\u7684\u5171\u4EAB\uFF1A</p><ol><li><p>\u7B2C\u4E09\u65B9\u6570\u636E\u5B58\u50A8</p><p>\u5C06\u6570\u636E\u5B58\u653E\u5230\u6570\u636E\u5E93\u3001\u78C1\u76D8\u6587\u4EF6\u3001\u7F13\u5B58\u670D\u52A1\uFF08\u5982Redis\uFF09\u3002</p><p>\u901A\u8FC7\u5B9A\u65F6\u8F6E\u8BE2\u5B9E\u73B0\u72B6\u6001\u540C\u6B65\u3002\u8F6E\u8BE2\u65F6\u95F4\u4E0D\u80FD\u8FC7\u5BC6\u3002</p></li><li><p>\u4E3B\u52A8\u901A\u77E5</p><p>\u5F53\u6570\u636E\u53D1\u751F\u66F4\u65B0\u65F6\uFF0C\u4E3B\u52A8\u901A\u77E5\u5B50\u8FDB\u7A0B\u3002</p><p>\u4E3A\u4E86\u4E0D\u6DF7\u5408\u4E1A\u52A1\u903B\u8F91\uFF0C\u53EF\u4EE5\u6DFB\u52A0\u4E00\u4E2A\u901A\u77E5\u8FDB\u7A0B\u6765\u8FDB\u884C\u8F6E\u8BE2\u548C\u901A\u77E5\u7684\u5DE5\u4F5C\uFF0C\u4E0D\u5904\u7406\u4EFB\u4F55\u4E1A\u52A1\u903B\u8F91\u3002</p></li></ol><h3 id="_9-4-cluster\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#_9-4-cluster\u6A21\u5757" aria-hidden="true">#</a> 9.4 Cluster\u6A21\u5757</h3><p>cluster\u6A21\u5757\u89E3\u51B3\u591A\u6838CPU\u7684\u5229\u7528\u7387\u95EE\u9898\uFF0C\u63D0\u4F9B\u4E86\u8F83\u5B8C\u5584\u7684API\uFF0C\u7528\u4EE5\u5904\u7406\u8FDB\u7A0B\u7684\u5065\u58EE\u6027\u95EE\u9898\u3002</p><h4 id="_9-4-1-cluster\u5DE5\u4F5C\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#_9-4-1-cluster\u5DE5\u4F5C\u539F\u7406" aria-hidden="true">#</a> 9.4.1 Cluster\u5DE5\u4F5C\u539F\u7406</h4><p>cluster\u6A21\u5757\u5C31\u662Fchild_process\u548Cnet\u6A21\u5757\u7684\u7EC4\u5408\u5E94\u7528\u3002</p><p>\u5728cluster\u6A21\u5757\u5E94\u7528\u4E2D\uFF0C\u4E00\u4E2A\u4E3B\u8FDB\u7A0B\u53EA\u80FD\u7BA1\u7406\u4E00\u7EC4\u5DE5\u4F5C\u8FDB\u7A0B\u3002</p><h4 id="_9-4-2-cluster\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#_9-4-2-cluster\u4E8B\u4EF6" aria-hidden="true">#</a> 9.4.2 Cluster\u4E8B\u4EF6</h4><ul><li>fork\uFF1A\u590D\u5236\u4E00\u4E2A\u5DE5\u4F5C\u8FDB\u7A0B\u540E\u89E6\u53D1\u8BE5\u4E8B\u4EF6\u3002</li><li>online\u3002</li><li>listening\u3002</li><li>disconnect\u3002</li><li>exit\u3002</li><li>setup\u3002</li></ul><h2 id="\u7B2C10\u7AE0-\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u7B2C10\u7AE0-\u6D4B\u8BD5" aria-hidden="true">#</a> \u7B2C10\u7AE0 \u6D4B\u8BD5</h2><p>\u6D4B\u8BD5\u7684\u610F\u4E49\u5728\u4E8E\uFF0C\u5728\u7528\u6237\u6D88\u8D39\u4EA7\u51FA\u7684\u4EE3\u7801\u4E4B\u524D\uFF0C\u5F00\u53D1\u8005\u9996\u5148\u6D88\u8D39\u5B83\uFF0C\u7ED9\u4E88\u5176\u91CD\u8981\u7684\u8D28\u91CF\u4FDD\u8BC1\u3002\u4E3A\u81EA\u5DF1\u4EE3\u7801\u5199\u6D4B\u8BD5\u7528\u4F8B\u662F\u4E00\u79CD\u884C\u4E4B\u6709\u6548\u7684\u65B9\u6CD5\uFF0C\u5B83\u80FD\u591F\u8BA9\u5F00\u53D1\u8005\u660E\u786E\u638C\u63E1\u5230\u4EE3\u7801\u7684\u884C\u4E3A\u548C\u6027\u80FD\u7B49\u3002</p><p>\u6D4B\u8BD5\u5305\u542B\u5355\u5143\u6D4B\u8BD5\u3001\u6027\u80FD\u6D4B\u8BD5\u3001\u5B89\u5168\u6D4B\u8BD5\u548C\u529F\u80FD\u6D4B\u8BD5\u7B49\u51E0\u4E2A\u65B9\u9762\u3002</p><h3 id="_10-1-\u5355\u5143\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_10-1-\u5355\u5143\u6D4B\u8BD5" aria-hidden="true">#</a> 10.1 \u5355\u5143\u6D4B\u8BD5</h3><h4 id="_10-1-1-\u5355\u5143\u6D4B\u8BD5\u7684\u610F\u4E49" tabindex="-1"><a class="header-anchor" href="#_10-1-1-\u5355\u5143\u6D4B\u8BD5\u7684\u610F\u4E49" aria-hidden="true">#</a> 10.1.1 \u5355\u5143\u6D4B\u8BD5\u7684\u610F\u4E49</h4><p>\u5355\u5143\u6D4B\u8BD5\u662F\u6700\u57FA\u672C\u7684\u80FD\u4FDD\u8BC1\u4EA7\u54C1\u7684\u8D28\u91CF\u7684\u4E00\u79CD\u65B9\u5F0F\uFF0C\u5982\u679C\u6CA1\u81EA\u5DF1\u6D4B\u8BD5\u4EE3\u7801\uFF0C\u90A3\u5FC5\u7136\u8981\u9762\u5BF9\u5982\u4E0B\u95EE\u9898\uFF1A</p><ol><li><p>\u6D4B\u8BD5\u5DE5\u7A0B\u5E08\u662F\u5426\u53EF\u4F9D\u8D56\uFF1F</p></li><li><p>\u7B2C\u4E09\u65B9\u4EE3\u7801\u662F\u5426\u53EF\u4F9D\u8D56\uFF1F</p></li><li><p>\u5728\u4EA7\u54C1\u8FED\u4EE3\u8FC7\u7A0B\u4E2D\uFF0C\u5982\u4F55\u7EE7\u7EED\u4FDD\u8BC1\u8D28\u91CF\uFF1F</p><p>\u5355\u5143\u6D4B\u8BD5\u7684\u610F\u4E49\u5728\u4E8E\u6BCF\u4E2A\u6D4B\u8BD5\u7528\u4F8B\u7684\u8986\u76D6\u90FD\u662F\u4E00\u79CD\u53EF\u80FD\u7684\u627F\u8BFA\u3002</p></li></ol><p>\u7F3A\u5C11\u5355\u5143\u6D4B\u8BD5\u7684\u8D28\u91CF\u4FDD\u8BC1\uFF0C\u4F1A\u9677\u5165\u4E3E\u6B65\u7EF4\u8270\u7684\u7EF4\u62A4\u4E4B\u8DEF\uFF0C\u62C6\u4E1C\u5899\u8865\u897F\u5899\uFF0C\u5F00\u53D1\u8005\u4E5F\u6E10\u6E10\u53D8\u5F97\u53EA\u60F3\u505A\u65B0\u9879\u76EE\uFF0C\u800C\u65E7\u7684\u9879\u76EE\u6700\u540E\u53D8\u5F97\u4E0D\u53EF\u7EF4\u62A4\u6216\u4E0D\u6562\u7EF4\u62A4\u3002</p><p>\u5F53\u65E0\u6CD5\u4E3A\u4E00\u6BB5\u4EE3\u7801\u5199\u51FA\u5355\u5143\u6D4B\u8BD5\u65F6\uFF0C\u8FD9\u6BB5\u4EE3\u7801\u5FC5\u7136\u6709\u574F\u5473\u9053\uFF0C\u8FD9\u6837\u7684\u4EE3\u7801\u6700\u9700\u8981\u91CD\u6784\u3002\u597D\u4EE3\u7801\u7684\u5355\u5143\u6D4B\u8BD5\u5FC5\u7136\u662F\u8F7B\u91CF\u7684\uFF0C\u91CD\u6784\u548C\u5199\u5355\u5143\u6D4B\u8BD5\u4E4B\u95F4\u662F\u4E00\u4E2A\u76F8\u4E92\u4FC3\u8FDB\u7684\u6B65\u9AA4\u3002</p><p>\u7F16\u5199\u53EF\u6D4B\u8BD5\u4EE3\u7801\u6709\u4EE5\u4E0B\u51E0\u4E2A\u539F\u5219\u53EF\u4EE5\u9075\u5FAA\uFF1A</p><ul><li><strong>\u5355\u4E00\u804C\u8D23</strong>\u3002\u5C06\u804C\u8D23\u8FDB\u884C\u89E3\u8026\u5206\u79BB\uFF0C\u53D8\u6210\u4E24\u4E2A\u5355\u4E00\u804C\u8D23\u7684\u65B9\u6CD5\u3002</li><li><strong>\u63A5\u53E3\u62BD\u8C61</strong>\u3002</li><li><strong>\u5C42\u6B21\u5206\u79BB</strong>\u3002\u9010\u5C42\u6D4B\u8BD5\uFF0C\u9010\u5C42\u4FDD\u8BC1\u3002</li></ul><h4 id="_10-1-2-\u5355\u5143\u6D4B\u8BD5\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_10-1-2-\u5355\u5143\u6D4B\u8BD5\u4ECB\u7ECD" aria-hidden="true">#</a> 10.1.2 \u5355\u5143\u6D4B\u8BD5\u4ECB\u7ECD</h4><p>\u5355\u5143\u6D4B\u8BD5\u4E3B\u8981\u5305\u62EC\u65AD\u8A00\u3001\u6D4B\u8BD5\u6846\u67B6\u3001\u6D4B\u8BD5\u7528\u4F8B\u3001\u6D4B\u8BD5\u8986\u76D6\u7387\u3001mock\u3001\u6301\u7EED\u96C6\u6210\u7B49\u51E0\u4E2A\u65B9\u9762\u3002</p><h5 id="_1-\u65AD\u8A00" tabindex="-1"><a class="header-anchor" href="#_1-\u65AD\u8A00" aria-hidden="true">#</a> 1. \u65AD\u8A00</h5><p><code>\u65AD\u8A00</code>\u5C31\u662F\u5355\u5143\u6D4B\u8BD5\u4E2D\u7528\u6765\u4FDD\u8BC1\u6700\u5C0F\u5355\u5143\u662F\u5426\u6B63\u5E38\u7684\u6D4B\u8BD5\u65B9\u6CD5\u3002</p><p>Node\u901A\u8FC7<code>assert</code>\u6A21\u5757\u6765\u5B9E\u73B0\u65AD\u8A00\u3002</p><ul><li>ok()\uFF1A\u5224\u65AD\u7ED3\u679C\u662F\u5426\u4E3A\u771F\u3002</li><li>equal()\uFF1A\u5224\u65AD\u5B9E\u9645\u503C\u4E0E\u671F\u671B\u503C\u662F\u5426\u76F8\u7B49\u3002</li><li>notEqualI()\u3002</li><li>deepEqual()\uFF1A\u5224\u65AD\u5B9E\u9645\u503C\u4E0E\u671F\u671B\u503C\u662F\u5426\u6DF1\u5EA6\u76F8\u7B49\u3002</li><li>notDeepEqual()\u3002</li><li>strictEqual()\uFF1A\u5224\u65AD\u5B9E\u9645\u503C\u4E0E\u671F\u671B\u503C\u662F\u5426\u4E25\u683C\u76F8\u7B49\uFF08===\uFF09\u3002</li><li>notStrictEqual()\u3002</li><li>throws()\uFF1A\u5224\u65AD\u4EE3\u7801\u662F\u5426\u629B\u51FA\u5F02\u5E38\u3002</li><li>doesNotThrow()\u3002</li><li>ifError()\uFF1A\u5224\u65AD\u5B9E\u9645\u503C\u662F\u5426\u4E3A\u4E00\u4E2A\u5047\u503C\uFF08null\u3001undefined\u30010\u3001&#39;&#39;\u3001false\uFF09\uFF0C\u5982\u679C\u5B9E\u9645\u503C\u4E3A\u771F\u6307\uFF0C\u5C06\u4F1A\u629B\u51FA\u5F02\u5E38\u3002</li></ul><h5 id="_2-\u6D4B\u8BD5\u6846\u67B6" tabindex="-1"><a class="header-anchor" href="#_2-\u6D4B\u8BD5\u6846\u67B6" aria-hidden="true">#</a> 2. \u6D4B\u8BD5\u6846\u67B6</h5><p>\u6D4B\u8BD5\u6846\u67B6\u7528\u4E8E\u4E3A\u6D4B\u8BD5\u670D\u52A1\uFF0C\u5B83\u672C\u8EAB\u5E76\u4E0D\u53C2\u4E0E\u6D4B\u8BD5\uFF0C\u4E3B\u8981\u7528\u4E8E\u7BA1\u7406\u6D4B\u8BD5\u7528\u4F8B\u548C\u751F\u6210\u6D4B\u8BD5\u62A5\u544A\uFF0C\u63D0\u5347\u6D4B\u8BD5\u7528\u4F8B\u7684\u5F00\u53D1\u901F\u5EA6\u3002</p><p><code>mocha</code>\u3001<code>jest</code>\u6D4B\u8BD5\u6846\u67B6\u3002</p><p>\u73B0\u4ECA\u6D41\u884C\u7684\u5355\u5143\u6D4B\u8BD5\u98CE\u683C\u4E3B\u8981\u6709TDD\uFF08\u6D4B\u8BD5\u9A71\u52A8\u5F00\u53D1\uFF09\u548CBDD\uFF08\u884C\u4E3A\u9A71\u52A8\u5F00\u53D1\uFF09\uFF0C\u5B83\u4EEC\u7684\u5DEE\u522B\u5982\u4E0B\uFF1A</p><ul><li>\u5173\u6CE8\u70B9\u4E0D\u540C\u3002TDD\u5173\u6CE8\u6240\u6709\u529F\u80FD\u662F\u5426\u88AB\u6B63\u786E\u5B9E\u73B0\uFF0C\u6BCF\u4E00\u4E2A\u529F\u80FD\u90FD\u5177\u5907\u5BF9\u5E94\u7684\u6D4B\u8BD5\u7528\u4F8B\uFF1BBDD\u5173\u6CE8\u6574\u4F53\u884C\u4E3A\u662F\u5426\u7B26\u5408\u9884\u671F\uFF0C\u9002\u5408\u81EA\u9876\u5411\u4E0B\u7684\u8BBE\u8BA1\u65B9\u5F0F\u3002</li><li>\u8868\u8FBE\u65B9\u5F0F\u4E0D\u540C\u3002TDD\u7684\u8868\u8FF0\u65B9\u5F0F\u504F\u5411\u4E8E\u529F\u80FD\u8BF4\u660E\u4E66\u7684\u98CE\u683C\uFF1BBDD\u7684\u8868\u8FF0\u65B9\u5F0F\u66F4\u63A5\u8FD1\u4E8E\u81EA\u7136\u8BED\u8A00\u7684\u4E60\u60EF\u3002</li></ul><p>BDD\u91C7\u7528<code>describe</code>\u548C<code>it</code>\u7EC4\u7EC7\uFF0C\u8FD8\u63D0\u4F9B\u4E86<code>before</code>\u3001<code>after</code>\u3001<code>beforeEach</code>\u3001<code>afterEach</code>\u56DB\u4E2A\u94A9\u5B50\u65B9\u6CD5\u3002TDD\u91C7\u7528<code>steup</code>\u548C<code>test</code>\u5B8C\u6210\uFF0C\u8FD8\u63D0\u4F9B<code>setup</code>\u548C<code>teardown</code>\u94A9\u5B50\u51FD\u6570\u3002</p><h5 id="_3-\u6D4B\u8BD5\u4EE3\u7801\u7684\u6587\u4EF6\u7EC4\u7EC7" tabindex="-1"><a class="header-anchor" href="#_3-\u6D4B\u8BD5\u4EE3\u7801\u7684\u6587\u4EF6\u7EC4\u7EC7" aria-hidden="true">#</a> 3. \u6D4B\u8BD5\u4EE3\u7801\u7684\u6587\u4EF6\u7EC4\u7EC7</h5><p>\u5728package.json\u7684devDependencies\u6DFB\u52A0mocha\u5B57\u6BB5\u5373\u53EF\u3002</p><h5 id="_4-\u6D4B\u8BD5\u7528\u4F8B" tabindex="-1"><a class="header-anchor" href="#_4-\u6D4B\u8BD5\u7528\u4F8B" aria-hidden="true">#</a> 4. \u6D4B\u8BD5\u7528\u4F8B</h5><p>\u4E00\u4E2A\u6D4B\u8BD5\u7528\u4F8B\u4E2D\u5305\u542B\u81F3\u5C11\u4E00\u4E2A\u65AD\u8A00\u3002\u6D4B\u8BD5\u7528\u4F8B\u6700\u5C11\u9700\u8981\u901A\u8FC7\u6B63\u5411\u6D4B\u8BD5\u548C\u53CD\u5411\u6D4B\u8BD5\u6765\u4FDD\u8BC1\u6D4B\u8BD5\u5BF9\u529F\u80FD\u7684\u8986\u76D6\u3002</p><ul><li><p>\u5F02\u6B65\u6D4B\u8BD5</p><p>\u901A\u8FC7it\u56DE\u8C03\u51FD\u6570\u7684\u5B9E\u53C2\u8C03\u7528\u6CE8\u5165\u901A\u77E5\u6D4B\u8BD5\u6846\u67B6\u5F53\u524D\u7528\u4F8B\u6267\u884C\u5B8C\u6210\u624D\u80FD\u7EE7\u7EED\u6267\u884C\u4E0B\u4E00\u4E2A\u6D4B\u8BD5\u7528\u4F8B\u3002</p></li><li><p>\u8D85\u65F6\u8BBE\u7F6E</p><p>mocha\u7ED9\u6240\u6709\u6D89\u53CA\u5F02\u6B65\u7684\u6D4B\u8BD5\u7528\u4F8B\u6DFB\u52A0\u8D85\u65F6\u9650\u5236\uFF0C\u9632\u6B62\u6D4B\u8BD5\u7A0B\u5E8F\u5361\u6B7B\u3002</p><p>\u53EF\u4EE5\u901A\u8FC7<code>mocha -t &lt;ms&gt;</code>\u6216\u8005\u5728it\u4E2D\u8C03\u7528<code>this.timeout(ms)</code>\u8BBE\u7F6E\u3002</p></li></ul><h5 id="_5-\u6D4B\u8BD5\u8986\u76D6\u7387" tabindex="-1"><a class="header-anchor" href="#_5-\u6D4B\u8BD5\u8986\u76D6\u7387" aria-hidden="true">#</a> 5. \u6D4B\u8BD5\u8986\u76D6\u7387</h5><p>\u6D4B\u8BD5\u8986\u76D6\u7387\u662F\u5355\u5143\u6D4B\u8BD5\u7684\u4E00\u4E2A\u91CD\u8981\u6307\u6807\uFF0C\u5B83\u80FD\u591F\u6982\u62EC\u6027\u5730\u7ED9\u51FA\u6574\u4F53\u7684\u8986\u76D6\u5EA6\uFF0C\u4E5F\u80FD\u660E\u786E\u5730\u7ED9\u51FA\u7EDF\u8BA1\u5230\u884C\u7684\u8986\u76D6\u60C5\u51B5\u3002</p><h5 id="_6-mock" tabindex="-1"><a class="header-anchor" href="#_6-mock" aria-hidden="true">#</a> 6. mock</h5><h5 id="_7-\u79C1\u6709\u65B9\u6CD5\u7684\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_7-\u79C1\u6709\u65B9\u6CD5\u7684\u6D4B\u8BD5" aria-hidden="true">#</a> 7. \u79C1\u6709\u65B9\u6CD5\u7684\u6D4B\u8BD5</h5><p><code>rewire</code>\u6A21\u5757\u63D0\u4F9B\u4E00\u79CD\u5DE7\u5999\u7684\u65B9\u5F0F\u5B9E\u73B0\u5BF9\u79C1\u6709\u65B9\u6CD5\u7684\u8BBF\u95EE\u3002</p><p>\u6BCF\u4E00\u4E2A\u88ABrewire\u5F15\u5165\u7684\u6A21\u5757\u7684\u65B9\u6CD5\u90FD\u6709<code>__set__</code>\u548C<code>__get__</code>\u65B9\u6CD5\u3002</p><h4 id="_10-1-3-\u5DE5\u7A0B\u5316\u548C\u81EA\u52A8\u5316" tabindex="-1"><a class="header-anchor" href="#_10-1-3-\u5DE5\u7A0B\u5316\u548C\u81EA\u52A8\u5316" aria-hidden="true">#</a> 10.1.3 \u5DE5\u7A0B\u5316\u548C\u81EA\u52A8\u5316</h4><h5 id="_1-\u5DE5\u7A0B\u5316" tabindex="-1"><a class="header-anchor" href="#_1-\u5DE5\u7A0B\u5316" aria-hidden="true">#</a> 1. \u5DE5\u7A0B\u5316</h5><p>\u4F7F\u7528Makefile\u7B49\u6210\u719F\u5DE5\u5177</p><ul><li>Makefile\u6587\u4EF6\u7684\u7F29\u8FDB\u5FC5\u987B\u662Ftab\u7B26\u53F7\uFF0C\u4E0D\u80FD\u7528\u7A7A\u683C\u3002</li><li>\u8BB0\u5F97\u5728\u5305\u63CF\u8FF0\u6587\u4EF6\u4E2D\u914D\u7F6Eblanket\u3002</li></ul><h5 id="_2-\u6301\u7EED\u96C6\u6210" tabindex="-1"><a class="header-anchor" href="#_2-\u6301\u7EED\u96C6\u6210" aria-hidden="true">#</a> 2. \u6301\u7EED\u96C6\u6210</h5><p>\u5229\u7528travis-ci\u5B9E\u73B0\u6301\u7EED\u96C6\u6210\u3002</p><h3 id="_10-2-\u6027\u80FD\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_10-2-\u6027\u80FD\u6D4B\u8BD5" aria-hidden="true">#</a> 10.2 \u6027\u80FD\u6D4B\u8BD5</h3><p>\u6027\u80FD\u6D4B\u8BD5\u5305\u62EC\u8D1F\u8F7D\u6D4B\u8BD5\u3001\u538B\u529B\u6D4B\u8BD5\u548C\u57FA\u51C6\u6D4B\u8BD5\u7B49\u3002</p><h4 id="_10-2-1-\u57FA\u51C6\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_10-2-1-\u57FA\u51C6\u6D4B\u8BD5" aria-hidden="true">#</a> 10.2.1 \u57FA\u51C6\u6D4B\u8BD5</h4><p>\u57FA\u51C6\u6D4B\u8BD5\u8981\u7EDF\u8BA1\u7684\u5C31\u662F\u5728\u591A\u5C11\u65F6\u95F4\u5185\u6267\u884C\u4E86\u591A\u5C11\u6B21\u67D0\u4E2A\u65B9\u6CD5\u3002</p><h4 id="_10-2-1-\u538B\u529B\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_10-2-1-\u538B\u529B\u6D4B\u8BD5" aria-hidden="true">#</a> 10.2.1 \u538B\u529B\u6D4B\u8BD5</h4><p>\u505A\u538B\u529B\u6D4B\u8BD5\u9700\u8981\u8003\u67E5\u7684\u6709\u541E\u5410\u7387\u3001\u54CD\u5E94\u65F6\u95F4\u548C\u5E76\u53D1\u6570\uFF0C\u8FD9\u4E9B\u6307\u6807\u53CD\u6620\u4E86\u670D\u52A1\u5668\u7684\u5E76\u53D1\u5904\u7406\u80FD\u529B\u3002</p><p>\u6700\u5E38\u7528\u7684\u5DE5\u5177\u6709ab\u3001siege\u3001http_load\u7B49\u3002</p><h4 id="_10-2-3-\u57FA\u51C6\u6D4B\u8BD5\u9A71\u52A8\u5F00\u53D1" tabindex="-1"><a class="header-anchor" href="#_10-2-3-\u57FA\u51C6\u6D4B\u8BD5\u9A71\u52A8\u5F00\u53D1" aria-hidden="true">#</a> 10.2.3 \u57FA\u51C6\u6D4B\u8BD5\u9A71\u52A8\u5F00\u53D1</h4><p>\u6D41\u7A0B\uFF1A</p><ol><li>\u5199\u57FA\u51C6\u6D4B\u8BD5\u3002</li><li>\u5199/\u6539\u4EE3\u7801\u3002</li><li>\u6536\u96C6\u6570\u636E\u3002</li><li>\u627E\u51FA\u95EE\u9898\u3002</li><li>\u56DE\u5230\u7B2C2\u6B65\u3002</li></ol><h4 id="_10-2-4-\u6D4B\u8BD5\u6570\u636E\u4E0E\u4E1A\u52A1\u6570\u636E\u7684\u8F6C\u6362" tabindex="-1"><a class="header-anchor" href="#_10-2-4-\u6D4B\u8BD5\u6570\u636E\u4E0E\u4E1A\u52A1\u6570\u636E\u7684\u8F6C\u6362" aria-hidden="true">#</a> 10.2.4 \u6D4B\u8BD5\u6570\u636E\u4E0E\u4E1A\u52A1\u6570\u636E\u7684\u8F6C\u6362</h4><p>\u6BCF\u5929100\u4E07\u7684\u4E1A\u52A1\u8BBF\u95EE\u91CF\u6362\u7B97\u4E3AQPS\uFF0C\u4E3B\u8981\u8BBF\u95EE\u91CF\u96C6\u4E2D\u572810\u5C0F\u65F6\u4EE5\u5185\uFF0CQPS=PV/10h\uFF0C\u7EA6\u7B49\u4E8E27.7\uFF0C\u5373\u670D\u52A1\u5668\u9700\u8981\u6BCF\u79D2\u5904\u740627.7\u4E2A\u8BF7\u6C42\u624D\u80FD\u80DC\u4EFB\u4E1A\u52A1\u91CF\u3002</p><h2 id="\u7B2C11\u7AE0-\u4EA7\u54C1\u5316" tabindex="-1"><a class="header-anchor" href="#\u7B2C11\u7AE0-\u4EA7\u54C1\u5316" aria-hidden="true">#</a> \u7B2C11\u7AE0 \u4EA7\u54C1\u5316</h2><p>\u5728\u5B9E\u9645\u4EA7\u54C1\u4E2D\uFF0C\u9700\u8981\u5F88\u591A\u975E\u7F16\u7801\u76F8\u5173\u7684\u5DE5\u4F5C\u6BD4\u5982\u5DE5\u7A0B\u5316\u3001\u67B6\u6784\u3001\u5BB9\u707E\u5907\u4EFD\u3001\u90E8\u7F72\u548C\u8FD0\u7EF4\u7B49\u6765\u4FDD\u8BC1\u9879\u76EE\u7684\u8FDB\u5C55\u548C\u4EA7\u54C1\u7684\u6B63\u5E38\u8FD0\u884C\u7B49\u3002</p><h3 id="_11-1-\u9879\u76EE\u5DE5\u7A0B\u5316" tabindex="-1"><a class="header-anchor" href="#_11-1-\u9879\u76EE\u5DE5\u7A0B\u5316" aria-hidden="true">#</a> 11.1 \u9879\u76EE\u5DE5\u7A0B\u5316</h3><p>\u9879\u76EE\u5DE5\u7A0B\u5316\uFF0C\u53EF\u4EE5\u7406\u89E3\u4E3A\u9879\u76EE\u7684\u7EC4\u7EC7\u80FD\u529B\u3002\u5728\u9879\u76EE\u5DE5\u7A0B\u5316\u8FC7\u7A0B\u4E2D\uFF0C\u6700\u57FA\u672C\u7684\u51E0\u90E8\u662F\u76EE\u5F55\u7ED3\u6784\u3001\u6784\u5EFA\u5DE5\u5177\u3001\u7F16\u7801\u89C4\u8303\u548C\u4EE3\u7801\u5BA1\u67E5\u7B49\u3002</p><h4 id="_11-1-1-\u76EE\u5F55\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_11-1-1-\u76EE\u5F55\u7ED3\u6784" aria-hidden="true">#</a> 11.1.1 \u76EE\u5F55\u7ED3\u6784</h4><p>\u9879\u76EE\u4E3B\u8981\u5206\u4E3AWeb\u5E94\u7528\u548C\u6A21\u5757\u5E94\u7528\u3002\u666E\u901A\u7684\u6A21\u5757\u5E94\u7528\u9075\u5FAACommonJS\u7684\u6A21\u5757\u548C\u5305\u89C4\u8303\uFF0CWeb\u5E94\u7528\u53EA\u8981\u9075\u5FAA\u5355\u4E00\u539F\u5219\u5373\u53EF\u3002</p><h4 id="_11-1-2-\u6784\u5EFA\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#_11-1-2-\u6784\u5EFA\u5DE5\u5177" aria-hidden="true">#</a> 11.1.2 \u6784\u5EFA\u5DE5\u5177</h4><h5 id="_1-makefile" tabindex="-1"><a class="header-anchor" href="#_1-makefile" aria-hidden="true">#</a> 1.MakeFile</h5><p>Makefile\u6587\u4EF6\u901A\u5E38\u7528\u6765\u7BA1\u7406\u4E00\u4E9B\u7F16\u8BD1\u76F8\u5173\u7684\u5DE5\u4F5C\u3002</p><h5 id="_2-grunt" tabindex="-1"><a class="header-anchor" href="#_2-grunt" aria-hidden="true">#</a> 2.Grunt</h5><p>Grunt\u7528Node\u5199\u6210\uFF0C\u80FD\u591F\u5728window\u548C*nix\u5E73\u53F0\u4E0B\u8FD0\u884C\u3002</p><p>Makefile\u4F9D\u6258\u5F3A\u5927\u7684bash\u7F16\u7A0B\uFF0CGrunt\u5219\u4F9D\u6258\u5B83\u4E30\u5BCC\u7684\u63D2\u4EF6\uFF0C\u5B83\u81EA\u8EAB\u63D0\u4F9B\u901A\u7528\u63A5\u53E3\u7528\u4E8E\u63D2\u4EF6\u7684\u63D2\u5165\u3002</p><h4 id="_11-1-3-\u7F16\u7801\u89C4\u8303" tabindex="-1"><a class="header-anchor" href="#_11-1-3-\u7F16\u7801\u89C4\u8303" aria-hidden="true">#</a> 11.1.3 \u7F16\u7801\u89C4\u8303</h4><p>\u5236\u5B9A\u826F\u597D\u7684\u7F16\u7801\u89C4\u8303\uFF0C\u6709\u52A9\u4E8E\u9879\u76EE\u540E\u671F\u7684\u7EF4\u62A4\u3002</p><h4 id="_11-1-4-\u4EE3\u7801\u5BA1\u67E5" tabindex="-1"><a class="header-anchor" href="#_11-1-4-\u4EE3\u7801\u5BA1\u67E5" aria-hidden="true">#</a> 11.1.4 \u4EE3\u7801\u5BA1\u67E5</h4><p>\u4EE3\u7801\u5BA1\u67E5\u4E3B\u8981\u662F\u8BF7\u6C42\u5408\u5E76\u7684\u8FC7\u7A0B\u4E2D\u5B8C\u6210\uFF0C\u9700\u8981\u5BA1\u67E5\u7684\u70B9\u6709\u529F\u80FD\u662F\u5426\u6B63\u786E\u5B8C\u6210\u3001\u7F16\u7801\u98CE\u683C\u662F\u5426\u7B26\u5408\u89C4\u8303\u3001\u5355\u5143\u6D4B\u8BD5\u662F\u5426\u6709\u540C\u6B65\u6DFB\u52A0\u7B49\u3002</p><p>\u5982\u679C\u4E0D\u7B26\u5408\u89C4\u8303\uFF0C\u5C31\u9700\u8981\u91CD\u65B0\u66F4\u6539\u4EE3\u7801\uFF0C\u7136\u540E\u518D\u63D0\u4EA4\u5BA1\u67E5\u3002</p><h3 id="_11-2-\u90E8\u7F72\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#_11-2-\u90E8\u7F72\u6D41\u7A0B" aria-hidden="true">#</a> 11.2 \u90E8\u7F72\u6D41\u7A0B</h3><h4 id="_11-2-1-\u90E8\u7F72\u73AF\u5883" tabindex="-1"><a class="header-anchor" href="#_11-2-1-\u90E8\u7F72\u73AF\u5883" aria-hidden="true">#</a> 11.2.1 \u90E8\u7F72\u73AF\u5883</h4><p>\u6D4B\u8BD5\u73AF\u5883(stage)-&gt;\u9884\u53D1\u5E03\u73AF\u5883(pre-release)-&gt;\u751F\u4EA7\u73AF\u5883(product)\u3002</p><h4 id="_11-2-2-\u90E8\u7F72\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_11-2-2-\u90E8\u7F72\u64CD\u4F5C" aria-hidden="true">#</a> 11.2.2 \u90E8\u7F72\u64CD\u4F5C</h4><p>\u901A\u8FC7\u811A\u672C\u5B9E\u73B0\u5E94\u7528\u7684\u542F\u52A8\u3001\u505C\u6B62\u548C\u91CD\u542F\u7B49\u64CD\u4F5C\u3002</p><h3 id="_11-3-\u6027\u80FD" tabindex="-1"><a class="header-anchor" href="#_11-3-\u6027\u80FD" aria-hidden="true">#</a> 11.3 \u6027\u80FD</h3><ul><li>\u505A\u4E13\u4E00\u7684\u4E8B\u3002</li><li>\u8BA9\u64C5\u957F\u7684\u5DE5\u5177\u505A\u64C5\u957F\u7684\u4E8B\u60C5\u3002</li><li>\u5C06\u6A21\u578B\u7B80\u5316\u3002</li><li>\u5C06\u98CE\u9669\u5206\u79BB\u3002</li></ul><h4 id="_11-3-1-\u52A8\u9759\u5206\u79BB" tabindex="-1"><a class="header-anchor" href="#_11-3-1-\u52A8\u9759\u5206\u79BB" aria-hidden="true">#</a> 11.3.1 \u52A8\u9759\u5206\u79BB</h4><p>\u8BA9Node\u53EA\u5904\u7406\u52A8\u6001\u8BF7\u6C42\uFF0C\u9759\u6001\u6587\u4EF6\u5F15\u5BFC\u5230\u4E13\u4E1A\u7684\u9759\u6001\u6587\u4EF6\u670D\u52A1\u5668\u5904\u7406\u3002</p><h4 id="_11-3-2-\u542F\u7528\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#_11-3-2-\u542F\u7528\u7F13\u5B58" aria-hidden="true">#</a> 11.3.2 \u542F\u7528\u7F13\u5B58</h4><p>\u907F\u514D\u4E0D\u5FC5\u8981\u7684\u8BA1\u7B97\u80FD\u5E26\u6765\u6027\u80FD\u7684\u663E\u8457\u63D0\u5347\u3002</p><h4 id="_11-3-3-\u591A\u8FDB\u7A0B\u67B6\u6784" tabindex="-1"><a class="header-anchor" href="#_11-3-3-\u591A\u8FDB\u7A0B\u67B6\u6784" aria-hidden="true">#</a> 11.3.3 \u591A\u8FDB\u7A0B\u67B6\u6784</h4><p>pm\u3001forever\u3001pm2\u6A21\u5757\u7528\u4E8E\u8FDB\u7A0B\u7BA1\u7406\u3002</p><h4 id="_11-3-4-\u8BFB\u5199\u5206\u79BB" tabindex="-1"><a class="header-anchor" href="#_11-3-4-\u8BFB\u5199\u5206\u79BB" aria-hidden="true">#</a> 11.3.4 \u8BFB\u5199\u5206\u79BB</h4><p>\u6570\u636E\u5E93\u8BFB\u5199\u5206\u79BB\uFF0C\u4F7F\u7528\u4E3B\u4ECE\u8BBE\u8BA1\u3002</p><h3 id="_11-4-\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_11-4-\u65E5\u5FD7" aria-hidden="true">#</a> 11.4 \u65E5\u5FD7</h3><h4 id="_11-4-1-\u8BBF\u95EE\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_11-4-1-\u8BBF\u95EE\u65E5\u5FD7" aria-hidden="true">#</a> 11.4.1 \u8BBF\u95EE\u65E5\u5FD7</h4><p>\u901A\u8FC7\u65E5\u5FD7\u4E2D\u95F4\u4EF6\u8BB0\u5F55\u65E5\u5FD7\u3002</p><h4 id="_11-4-2-\u5F02\u5E38\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_11-4-2-\u5F02\u5E38\u65E5\u5FD7" aria-hidden="true">#</a> 11.4.2 \u5F02\u5E38\u65E5\u5FD7</h4><p>console\u5BF9\u8C61\uFF1A</p><ul><li>console.log\uFF1A\u666E\u901A\u65E5\u5FD7\u3002</li><li>console.info\uFF1A\u666E\u901A\u4FE1\u606F\u3002</li><li>console.warn\uFF1A\u8B66\u544A\u4FE1\u606F\u3002</li><li>console.error\uFF1A\u9519\u8BEF\u4FE1\u606F\u3002</li></ul><p>\u5F02\u5E38\u5C3D\u91CF\u7531\u6700\u4E0A\u5C42\u7684\u8C03\u7528\u8005\u6355\u83B7\u8BB0\u5F55\uFF0C\u5E95\u5C42\u8C03\u7528\u6216\u4E2D\u95F4\u5C42\u8C03\u7528\u4E2D\u51FA\u73B0\u7684\u5F02\u5E38\u53EA\u8981\u6B63\u5E38\u4F20\u9012\u7ED9\u4E0A\u5C42\u7684\u8C03\u7528\u65B9\u5373\u53EF\u3002</p><h4 id="_11-4-3-\u65E5\u5FD7\u4E0E\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#_11-4-3-\u65E5\u5FD7\u4E0E\u6570\u636E\u5E93" aria-hidden="true">#</a> 11.4.3 \u65E5\u5FD7\u4E0E\u6570\u636E\u5E93</h4><p>\u4E0D\u8981\u5C06\u65E5\u5FD7\u76F4\u63A5\u5199\u5165\u6570\u636E\u5E93\uFF0C\u5C06\u65E5\u5FD7\u5206\u6790\u548C\u65E5\u5FD7\u8BB0\u5F55\u4E24\u4E2A\u6B65\u9AA4\u5206\u79BB\u662F\u8F83\u597D\u7684\u9009\u62E9\u3002</p><h4 id="_11-4-4-\u5206\u5272\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_11-4-4-\u5206\u5272\u65E5\u5FD7" aria-hidden="true">#</a> 11.4.4 \u5206\u5272\u65E5\u5FD7</h4><p>\u5F53\u8BBF\u95EE\u91CF\u5DE8\u5927\u65F6\uFF0C\u5C06\u4EA7\u751F\u7684\u65E5\u5FD7\u6309\u65E5\u671F\u5206\u5272\u662F\u4E00\u4E2A\u4E0D\u9519\u7684\u4E3B\u610F\u3002</p><h3 id="_11-5-\u76D1\u63A7\u62A5\u8B66" tabindex="-1"><a class="header-anchor" href="#_11-5-\u76D1\u63A7\u62A5\u8B66" aria-hidden="true">#</a> 11.5 \u76D1\u63A7\u62A5\u8B66</h3><p>\u76D1\u63A7\u5206\u4E3A\u4E1A\u52A1\u903B\u8F91\u578B\u7684\u76D1\u63A7\u548C\u786C\u4EF6\u578B\u7684\u76D1\u63A7\u3002</p><h4 id="_11-5-1-\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_11-5-1-\u76D1\u63A7" aria-hidden="true">#</a> 11.5.1 \u76D1\u63A7</h4><h5 id="_1-\u65E5\u5FD7\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_1-\u65E5\u5FD7\u76D1\u63A7" aria-hidden="true">#</a> 1.\u65E5\u5FD7\u76D1\u63A7</h5><p>\u4ECE\u8BBF\u95EE\u65E5\u5FD7\u4E2D\u5B9E\u73B0PV\u548CUV\u7684\u76D1\u63A7\uFF0C\u540CQPS\u503C\u4E00\u6837\uFF0C\u901A\u8FC7\u5BF9PV/UV\u7684\u76D1\u63A7\uFF0C\u53EF\u4EE5\u5F88\u597D\u5730\u77E5\u9053\u5E94\u7528\u7684\u4F7F\u7528\u8005\u4EEC\u7684\u4E60\u60EF\u3001\u9884\u77E5\u8BBF\u95EE\u9AD8\u5CF0\u7B49\u3002</p><h5 id="_2-\u54CD\u5E94\u65F6\u95F4" tabindex="-1"><a class="header-anchor" href="#_2-\u54CD\u5E94\u65F6\u95F4" aria-hidden="true">#</a> 2.\u54CD\u5E94\u65F6\u95F4</h5><p>\u901A\u8FC7Nginx\u7684\u53CD\u5411\u4EE3\u7406\u76D1\u63A7\uFF0C\u4E5F\u53EF\u4EE5\u901A\u8FC7\u5E94\u7528\u81EA\u884C\u4EA7\u751F\u7684\u8BBF\u95EE\u65E5\u5FD7\u6765\u76D1\u63A7\u3002</p><h5 id="_3-\u8FDB\u7A0B\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_3-\u8FDB\u7A0B\u76D1\u63A7" aria-hidden="true">#</a> 3.\u8FDB\u7A0B\u76D1\u63A7</h5><p>\u68C0\u67E5\u5DE5\u4F5C\u8FDB\u7A0B\u7684\u6570\u91CF\uFF0C\u5982\u679C\u4F4E\u4E8E\u9884\u4F30\u503C\uFF0C\u5C31\u5E94\u5F53\u53D1\u51FA\u62A5\u8B66\u58F0\u3002</p><h5 id="_4-\u78C1\u76D8\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_4-\u78C1\u76D8\u76D1\u63A7" aria-hidden="true">#</a> 4.\u78C1\u76D8\u76D1\u63A7</h5><p>\u76D1\u63A7\u78C1\u76D8\u7684\u7528\u91CF\u3002</p><h5 id="_5-\u5185\u5B58\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_5-\u5185\u5B58\u76D1\u63A7" aria-hidden="true">#</a> 5.\u5185\u5B58\u76D1\u63A7</h5><p>\u76D1\u63A7\u670D\u52A1\u5668\u7684\u5185\u5B58\u4F7F\u7528\u72B6\u51B5\uFF0C\u53EF\u4EE5\u68C0\u67E5\u5E94\u7528\u4E2D\u662F\u5426\u5B58\u5728\u5185\u5B58\u6CC4\u6F0F\u7684\u60C5\u51B5\u3002</p><h5 id="_6-cpu\u5360\u7528\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_6-cpu\u5360\u7528\u76D1\u63A7" aria-hidden="true">#</a> 6.CPU\u5360\u7528\u76D1\u63A7</h5><p>CPU\u4F7F\u7528\u5206\u4E3A\u7528\u6237\u6001\uFF08\u670D\u52A1\u5668\u5E94\u7528\u5F00\u9500\uFF09\u3001\u5185\u6838\u6001\uFF08\u670D\u52A1\u5668\u8FDB\u7A0B\u8C03\u5EA6\u548C\u7CFB\u7EDF\u8C03\u7528\uFF09\u3001IOWait\uFF08CPU\u7B49\u5F85\u78C1\u76D8I/O\u64CD\u4F5C\uFF09\u7B49\u3002</p><h5 id="_7-cpu-load\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_7-cpu-load\u76D1\u63A7" aria-hidden="true">#</a> 7.CPU load\u76D1\u63A7</h5><p>CPU load\u7528\u6765\u63CF\u8FF0\u64CD\u4F5C\u7CFB\u7EDF\u5F53\u524D\u7684\u7E41\u5FD9\u7A0B\u5EA6\u3002</p><h5 id="_8-i-o\u8D1F\u8F7D" tabindex="-1"><a class="header-anchor" href="#_8-i-o\u8D1F\u8F7D" aria-hidden="true">#</a> 8.I/O\u8D1F\u8F7D</h5><h5 id="_9-\u7F51\u7EDC\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_9-\u7F51\u7EDC\u76D1\u63A7" aria-hidden="true">#</a> 9.\u7F51\u7EDC\u76D1\u63A7</h5><p>\u7F51\u7EDC\u6D41\u91CF\u76D1\u63A7\u7684\u4E24\u4E2A\u4E3B\u8981\u6307\u6807\u662F\u6D41\u5165\u6D41\u91CF\u548C\u6D41\u51FA\u6D41\u91CF\u3002</p><h5 id="_10-\u5E94\u7528\u72B6\u6001\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_10-\u5E94\u7528\u72B6\u6001\u76D1\u63A7" aria-hidden="true">#</a> 10.\u5E94\u7528\u72B6\u6001\u76D1\u63A7</h5><h5 id="_11-dns\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#_11-dns\u76D1\u63A7" aria-hidden="true">#</a> 11.DNS\u76D1\u63A7</h5><h4 id="_11-5-2-\u62A5\u8B66\u7684\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#_11-5-2-\u62A5\u8B66\u7684\u5B9E\u73B0" aria-hidden="true">#</a> 11.5.2 \u62A5\u8B66\u7684\u5B9E\u73B0</h4><ul><li><p>\u90AE\u4EF6\u62A5\u8B66</p><p>\u901A\u8FC7nodemailer\u6A21\u5757\u5B9E\u73B0\u3002</p></li><li><p>\u77ED\u4FE1\u6216\u7535\u8BDD\u62A5\u8B66</p></li></ul><h3 id="_11-6-\u7A33\u5B9A\u6027" tabindex="-1"><a class="header-anchor" href="#_11-6-\u7A33\u5B9A\u6027" aria-hidden="true">#</a> 11.6 \u7A33\u5B9A\u6027</h3><ul><li>\u591A\u673A\u5668</li><li>\u591A\u673A\u623F</li><li>\u5BB9\u707E\u5907\u4EFD</li></ul><h3 id="_11-7-\u5F02\u6784\u5171\u5B58" tabindex="-1"><a class="header-anchor" href="#_11-7-\u5F02\u6784\u5171\u5B58" aria-hidden="true">#</a> 11.7 \u5F02\u6784\u5171\u5B58</h3><p>\u534F\u8BAE\u51E0\u4E4E\u662F\u89E3\u51B3\u5F02\u6784\u7CFB\u7EDF\u6700\u5B8C\u7F8E\u7684\u65B9\u6848\u3002</p>`,626);function p(l,o){return e}var t=a(n,[["render",p]]);export{t as default};
