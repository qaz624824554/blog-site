<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.36">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/578220.jpg"><title>《TypeScript编程》 | Leon Chen</title><meta name="description" content="">
    <link rel="modulepreload" href="/blog-site/assets/app.c4a25f51.js"><link rel="modulepreload" href="/blog-site/assets/《TypeScript编程》.html.e975f26f.js"><link rel="modulepreload" href="/blog-site/assets/《TypeScript编程》.html.4c903f96.js"><link rel="modulepreload" href="/blog-site/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/blog-site/assets/style.5c2fd74e.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/blog-site/" class=""><img class="logo" src="/blog-site/images/578220.jpg" alt="Leon Chen"><span class="site-name can-hide">Leon Chen</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/blog-site/program" class="router-link-active" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog-site/promote" class="" aria-label="课外提升"><!--[--><!--]--> 课外提升 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog-site/questions" class="" aria-label="疑问清单"><!--[--><!--]--> 疑问清单 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog-site/leetcode" class="" aria-label="LeetCode题解"><!--[--><!--]--> LeetCode题解 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/blog-site/program" class="router-link-active" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog-site/promote" class="" aria-label="课外提升"><!--[--><!--]--> 课外提升 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog-site/questions" class="" aria-label="疑问清单"><!--[--><!--]--> 疑问清单 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog-site/leetcode" class="" aria-label="LeetCode题解"><!--[--><!--]--> LeetCode题解 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">《TypeScript编程》 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第1章-导言" class="router-link-active router-link-exact-active sidebar-item" aria-label="第1章 导言"><!--[--><!--]--> 第1章 导言 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第2章-typescript概述" class="router-link-active router-link-exact-active sidebar-item" aria-label="第2章 TypeScript概述"><!--[--><!--]--> 第2章 TypeScript概述 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_2-1-编译器" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.1 编译器"><!--[--><!--]--> 2.1 编译器 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_2-2-类型系统" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.2 类型系统"><!--[--><!--]--> 2.2 类型系统 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_2-3-代码编辑器设置" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.3 代码编辑器设置"><!--[--><!--]--> 2.3 代码编辑器设置 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第3章-类型全解" class="router-link-active router-link-exact-active sidebar-item" aria-label="第3章 类型全解"><!--[--><!--]--> 第3章 类型全解 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_3-1-类型术语" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.1 类型术语"><!--[--><!--]--> 3.1 类型术语 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_3-2类型浅谈" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.2类型浅谈"><!--[--><!--]--> 3.2类型浅谈 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_3-3-小结" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.3 小结"><!--[--><!--]--> 3.3 小结 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第4章-函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="第4章 函数"><!--[--><!--]--> 第4章 函数 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_4-1-声明和调用函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.1 声明和调用函数"><!--[--><!--]--> 4.1 声明和调用函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_4-2-多态" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.2 多态"><!--[--><!--]--> 4.2 多态 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_4-3-类型驱动开发" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.3 类型驱动开发"><!--[--><!--]--> 4.3 类型驱动开发 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第5章-类和接口" class="router-link-active router-link-exact-active sidebar-item" aria-label="第5章 类和接口"><!--[--><!--]--> 第5章 类和接口 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-1-类和继承" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.1 类和继承"><!--[--><!--]--> 5.1 类和继承 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-2-super" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.2 super"><!--[--><!--]--> 5.2 super <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-3-以this为返回类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.3 以this为返回类型"><!--[--><!--]--> 5.3 以this为返回类型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-5-类是结构化类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.5 类是结构化类型"><!--[--><!--]--> 5.5 类是结构化类型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-6-类既声明值也声明类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.6 类既声明值也声明类型"><!--[--><!--]--> 5.6 类既声明值也声明类型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-7-多态" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.7 多态"><!--[--><!--]--> 5.7 多态 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-8-混入" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.8 混入"><!--[--><!--]--> 5.8 混入 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-9-装饰器" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.9 装饰器"><!--[--><!--]--> 5.9 装饰器 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-10-模拟final类" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.10 模拟final类"><!--[--><!--]--> 5.10 模拟final类 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_5-11-设计模式" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.11 设计模式"><!--[--><!--]--> 5.11 设计模式 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第6章-类型进阶" class="router-link-active router-link-exact-active sidebar-item" aria-label="第6章 类型进阶"><!--[--><!--]--> 第6章 类型进阶 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_6-1-类型之间的关系" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.1 类型之间的关系"><!--[--><!--]--> 6.1 类型之间的关系 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_6-2-全面性检查" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.2 全面性检查"><!--[--><!--]--> 6.2 全面性检查 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_6-3-对象类型进阶" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.3 对象类型进阶"><!--[--><!--]--> 6.3 对象类型进阶 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_6-4-函数类型进阶" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.4 函数类型进阶"><!--[--><!--]--> 6.4 函数类型进阶 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_6-5-条件类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.5 条件类型"><!--[--><!--]--> 6.5 条件类型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_6-6-解决方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.6 解决方法"><!--[--><!--]--> 6.6 解决方法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_6-7-模拟名义类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.7 模拟名义类型"><!--[--><!--]--> 6.7 模拟名义类型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_6-8-安全地扩展原型" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.8 安全地扩展原型"><!--[--><!--]--> 6.8 安全地扩展原型 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第7章-处理错误" class="router-link-active router-link-exact-active sidebar-item" aria-label="第7章 处理错误"><!--[--><!--]--> 第7章 处理错误 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_7-1-返回null" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.1 返回null"><!--[--><!--]--> 7.1 返回null <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_7-2-抛出异常" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.2 抛出异常"><!--[--><!--]--> 7.2 抛出异常 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_7-3-返回异常" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.3 返回异常"><!--[--><!--]--> 7.3 返回异常 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_7-4-option类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.4 Option类型"><!--[--><!--]--> 7.4 Option类型 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第8章-异步编程、并发和并行" class="router-link-active router-link-exact-active sidebar-item" aria-label="第8章 异步编程、并发和并行"><!--[--><!--]--> 第8章 异步编程、并发和并行 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_8-1-javascript的事件循环" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.1 JavaScript的事件循环"><!--[--><!--]--> 8.1 JavaScript的事件循环 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_8-2-处理回调" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.2 处理回调"><!--[--><!--]--> 8.2 处理回调 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_8-3-promise-让一切回到正轨" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.3 promise：让一切回到正轨"><!--[--><!--]--> 8.3 promise：让一切回到正轨 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_8-4-async和await" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.4 async和await"><!--[--><!--]--> 8.4 async和await <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_8-5-异步流" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.5 异步流"><!--[--><!--]--> 8.5 异步流 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_8-6-多线程类型安全" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.6 多线程类型安全"><!--[--><!--]--> 8.6 多线程类型安全 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第9章-前后端框架" class="router-link-active router-link-exact-active sidebar-item" aria-label="第9章 前后端框架"><!--[--><!--]--> 第9章 前后端框架 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_9-1-前端框架" class="router-link-active router-link-exact-active sidebar-item" aria-label="9.1 前端框架"><!--[--><!--]--> 9.1 前端框架 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_9-2-类型安全的api" class="router-link-active router-link-exact-active sidebar-item" aria-label="9.2 类型安全的API"><!--[--><!--]--> 9.2 类型安全的API <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_9-3-后端框架" class="router-link-active router-link-exact-active sidebar-item" aria-label="9.3 后端框架"><!--[--><!--]--> 9.3 后端框架 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第10章-命名空间和模块" class="router-link-active router-link-exact-active sidebar-item" aria-label="第10章 命名空间和模块"><!--[--><!--]--> 第10章 命名空间和模块 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_10-1-javascript模块简史" class="router-link-active router-link-exact-active sidebar-item" aria-label="10.1 JavaScript模块简史"><!--[--><!--]--> 10.1 JavaScript模块简史 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_10-2-import、export" class="router-link-active router-link-exact-active sidebar-item" aria-label="10.2 import、export"><!--[--><!--]--> 10.2 import、export <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_10-3-命名空间" class="router-link-active router-link-exact-active sidebar-item" aria-label="10.3 命名空间"><!--[--><!--]--> 10.3 命名空间 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_10-4-声明合并" class="router-link-active router-link-exact-active sidebar-item" aria-label="10.4 声明合并"><!--[--><!--]--> 10.4 声明合并 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第11章-与javascript互操作" class="router-link-active router-link-exact-active sidebar-item" aria-label="第11章 与JavaScript互操作"><!--[--><!--]--> 第11章 与JavaScript互操作 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_11-1-类型声明" class="router-link-active router-link-exact-active sidebar-item" aria-label="11.1 类型声明"><!--[--><!--]--> 11.1 类型声明 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_11-2-逐步从javascript迁移到typescript" class="router-link-active router-link-exact-active sidebar-item" aria-label="11.2 逐步从JavaScript迁移到TypeScript"><!--[--><!--]--> 11.2 逐步从JavaScript迁移到TypeScript <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_11-3-寻找javascript代码的类型信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="11.3 寻找JavaScript代码的类型信息"><!--[--><!--]--> 11.3 寻找JavaScript代码的类型信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_11-4-使用第三方javascript" class="router-link-active router-link-exact-active sidebar-item" aria-label="11.4 使用第三方JavaScript"><!--[--><!--]--> 11.4 使用第三方JavaScript <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#第12章-构建和运行typescript" class="router-link-active router-link-exact-active sidebar-item" aria-label="第12章 构建和运行TypeScript"><!--[--><!--]--> 第12章 构建和运行TypeScript <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_12-2-在服务器中运行typescript" class="router-link-active router-link-exact-active sidebar-item" aria-label="12.2 在服务器中运行TypeScript"><!--[--><!--]--> 12.2 在服务器中运行TypeScript <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_12-3-在浏览器中运行typescript" class="router-link-active router-link-exact-active sidebar-item" aria-label="12.3 在浏览器中运行TypeScript"><!--[--><!--]--> 12.3 在浏览器中运行TypeScript <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_12-4-把typescript代码发布到npm中" class="router-link-active router-link-exact-active sidebar-item" aria-label="12.4 把TypeScript代码发布到NPM中"><!--[--><!--]--> 12.4 把TypeScript代码发布到NPM中 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#_12-5-三斜线指令" class="router-link-active router-link-exact-active sidebar-item" aria-label="12.5 三斜线指令"><!--[--><!--]--> 12.5 三斜线指令 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#附录a-类型运算符" class="router-link-active router-link-exact-active sidebar-item" aria-label="附录A 类型运算符"><!--[--><!--]--> 附录A 类型运算符 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#附录b-实用类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="附录B 实用类型"><!--[--><!--]--> 附录B 实用类型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#附录c-限定作用范围的声明" class="router-link-active router-link-exact-active sidebar-item" aria-label="附录C 限定作用范围的声明"><!--[--><!--]--> 附录C 限定作用范围的声明 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#附录d-为第三方javascript模块编写声明文件的技巧" class="router-link-active router-link-exact-active sidebar-item" aria-label="附录D 为第三方JavaScript模块编写声明文件的技巧"><!--[--><!--]--> 附录D 为第三方JavaScript模块编写声明文件的技巧 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog-site/program/%E3%80%8ATypeScript%E7%BC%96%E7%A8%8B%E3%80%8B.html#d-1-导出的类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="D.1 导出的类型"><!--[--><!--]--> D.1 导出的类型 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h2 id="第1章-导言" tabindex="-1"><a class="header-anchor" href="#第1章-导言" aria-hidden="true">#</a> 第1章 导言</h2><p>类型安全：借助类型避免程序做无效的事情。</p><h2 id="第2章-typescript概述" tabindex="-1"><a class="header-anchor" href="#第2章-typescript概述" aria-hidden="true">#</a> 第2章 TypeScript概述</h2><h3 id="_2-1-编译器" tabindex="-1"><a class="header-anchor" href="#_2-1-编译器" aria-hidden="true">#</a> 2.1 编译器</h3><p>程序运行过程： 1.把程序解析为AST。 2.AST编译成字节码。 3.运行时计算字节码。</p><p>TypeScript编译器生成AST之后，真正运行代码之前，TypeScript会对代码做类型检查（检查代码是否符合类型安全要求的特殊程序）。</p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/hGPtXR.jpg" alt="hGPtXR.jpg"></p><h3 id="_2-2-类型系统" tabindex="-1"><a class="header-anchor" href="#_2-2-类型系统" aria-hidden="true">#</a> 2.2 类型系统</h3><p>类型系统：类型检查器为程序分配类型时使用的一系列规则。类型系统有两种，一种是通过显式句法告诉编译器所有值的类型，另一种自动推导值的类型。</p><p>TypeScript支持两种类型系统，可以显式注解类型，也可以让TypeScript推导多数类型。</p><p>注解的形式：<code>value: type</code>。</p><blockquote><p>一般来说，最好让TypeScript推导类型，少数情况下才显式注解类型。</p></blockquote><p>JavaScript和TypeScript的类型系统区别</p><table><thead><tr><th>类型系统特性</th><th>JavaScript</th><th>TypeScript</th></tr></thead><tbody><tr><td>类型是如何绑定的？</td><td>动态</td><td>静态</td></tr><tr><td>是否自动转换类型？</td><td>是</td><td>否（多数时候）</td></tr><tr><td>何时检查类型？</td><td>运行时</td><td>编译时</td></tr><tr><td>何时报告错误？</td><td>运行时（多数时候）</td><td>编译时（多数时候）</td></tr></tbody></table><p>JavaScript是动态绑定语言（运行程序才能知道类型），TypeScript是渐进式编译类型语言（编译时对代码做类型检查）。</p><p>JavaScript是弱类型语言，会自动转换类型，而TypeScript发现无效的操作时则报错。如果必须类型转换，请明确表明你的意图。</p><p>TypeScript会对代码做静态分析，找出这类错误，在运行之前反馈给你。</p><h3 id="_2-3-代码编辑器设置" tabindex="-1"><a class="header-anchor" href="#_2-3-代码编辑器设置" aria-hidden="true">#</a> 2.3 代码编辑器设置</h3><h4 id="_2-3-1-tsconfig-json" tabindex="-1"><a class="header-anchor" href="#_2-3-1-tsconfig-json" aria-hidden="true">#</a> 2.3.1 tsconfig.json</h4><p>每个TypeScript项目都应该在根目录放一个名为tsconfig.json的文件，在该文件中定义要编译哪些文件、把文件编译到哪个目录中，以及在使用哪个版本的JavaScript运行。</p><p>可以使用<code>./node_modules/.bin/tsc --init</code>生成tsconfig.json。</p><h4 id="_2-3-2-tslint-json" tabindex="-1"><a class="header-anchor" href="#_2-3-2-tslint-json" aria-hidden="true">#</a> 2.3.2 tslint.json</h4><p>tslint.json为代码制定风格上的约定。</p><p>ts-node，直接编译和运行TypeScript代码。</p><p>typescript-node-starter，快速生成文件夹结构。</p><h2 id="第3章-类型全解" tabindex="-1"><a class="header-anchor" href="#第3章-类型全解" aria-hidden="true">#</a> 第3章 类型全解</h2><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/hGPy1H.jpg" alt="hGPy1H.jpg"></p><h3 id="_3-1-类型术语" tabindex="-1"><a class="header-anchor" href="#_3-1-类型术语" aria-hidden="true">#</a> 3.1 类型术语</h3><h3 id="_3-2类型浅谈" tabindex="-1"><a class="header-anchor" href="#_3-2类型浅谈" aria-hidden="true">#</a> 3.2类型浅谈</h3><p>const和let对TypeScript的推导结果是有影响的。</p><h4 id="_3-2-1-any" tabindex="-1"><a class="header-anchor" href="#_3-2-1-any" aria-hidden="true">#</a> 3.2.1 any</h4><p>这是兜底类型，应该尽量避免使用。</p><h4 id="_3-2-2-unknown" tabindex="-1"><a class="header-anchor" href="#_3-2-2-unknown" aria-hidden="true">#</a> 3.2.2 unknown</h4><p>如果你无法预知一个值的类型，不要使用any，应该使用unknown。unknown也表示任何值，但是TypeScript会再要求你再做检查。</p><p>unknown的用法： 1.unknown类似可以比较，可以否定，可以使用typeof和instanceof运算符。 2.TypeScript不会把任何值推导为unknown类型，必须显式注解。 3.执行操作时不能假定unknown类型的值为某种特定类型，必须先向TypeScript证明一个值确实是某个类型。</p><h4 id="_3-2-3-boolean" tabindex="-1"><a class="header-anchor" href="#_3-2-3-boolean" aria-hidden="true">#</a> 3.2.3 boolean</h4><p>该值的类型可以比较，可以否定。</p><h4 id="_3-2-4-number" tabindex="-1"><a class="header-anchor" href="#_3-2-4-number" aria-hidden="true">#</a> 3.2.4 number</h4><p>number包括所有数字：整数、浮点数、正数、负数、Infinity、NaN等。</p><p>如果没有特殊原因，不要把值的类型显式注解 为number。</p><p>处理较长的数字时，建议使用数字分隔符。<code>let oneMillion = 1_1000_000 // 等同于1000000</code>。</p><h4 id="_3-2-5-bigint" tabindex="-1"><a class="header-anchor" href="#_3-2-5-bigint" aria-hidden="true">#</a> 3.2.5 bigint</h4><p>bigint是JavaScript和TypeScript新引入的类型，在处理较大的整数，不用再担心舍入误差。</p><p>number类型表示的整数最大为2^53，bigint能表示的数比这大得多。</p><p>尽量让TypeScript推导bigint类型。</p><h4 id="_3-2-6-string" tabindex="-1"><a class="header-anchor" href="#_3-2-6-string" aria-hidden="true">#</a> 3.2.6 string</h4><p>尽量让TypeScript推导string类型。</p><h4 id="_3-2-7-symbol" tabindex="-1"><a class="header-anchor" href="#_3-2-7-symbol" aria-hidden="true">#</a> 3.2.7 symbol</h4><p>symbol类型分为symbol和unique symbol。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Symbol</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#616E88;">// symbol</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Symbol</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#616E88;">// typeof b</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>unique symbol类型的值始终与自身相等。</p><h4 id="_3-2-8-对象" tabindex="-1"><a class="header-anchor" href="#_3-2-8-对象" aria-hidden="true">#</a> 3.2.8 对象</h4><p>JavaScript一般采用结构化类型（一种编程设计风格，只关心对象有哪些属性，而不管属性使用什么名称），TypeScript直接沿用。</p><p>使用类型描述对象的方式：</p><h5 id="_1-把一个值声明为object类型-推荐-。" tabindex="-1"><a class="header-anchor" href="#_1-把一个值声明为object类型-推荐-。" aria-hidden="true">#</a> 1.把一个值声明为object类型(推荐)。</h5><p><code>let a: object = {}</code>。</p><p>只能表示该值是一个JavaScript对象（而且不是null）。</p><h5 id="_2-对象字面量句法" tabindex="-1"><a class="header-anchor" href="#_2-对象字面量句法" aria-hidden="true">#</a> 2.对象字面量句法</h5><p>让TypeScript推导对象的结构。<code>let a = { b: &#39;x&#39; }</code>。</p><p>使用const声明对象不会导致TypeScript把推导的类型缩窄。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">n</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">firstName</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">123</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">lastName</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">456</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Person</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">public</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">firstName</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// public是this.firstName = firstName的简写形式</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">public</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">lastName</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9;">n</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">Person</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">czl</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">ltx</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">n</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// [key: T]: U =&gt; 称为索引签名，通过这种方式告知TypeScript指定的对象可能有更多的键。在这个对象中，类型为T的键对应的值为U类型。</span></span>
<span class="line"><span style="color:#616E88;">// 键的类型（T）必须可赋值给number或string。索引签名中键的名称可以是任何词，不一定非得用key。</span></span>
<span class="line"><span style="color:#616E88;">// 推荐！</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  b</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  c</span><span style="color:#81A1C1;">?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  [</span><span style="color:#D8DEE9;">key</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  [</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>可以使用<code>readonly</code>修饰符把字段标记为只读。</p><p>对象字面量法有一个特例：空对象类型（{}）。除了null和undefined之外的任何类型都可以赋值给空对象类型，使用起来比较复杂。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">danger</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"><span style="color:#D8DEE9;">danger</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"><span style="color:#D8DEE9;">danger</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9;">x</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9;">danger</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> []</span></span>
<span class="line"><span style="color:#D8DEE9;">danger</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>请尽量避免使用空对象类型。</p><h5 id="_3-object。" tabindex="-1"><a class="header-anchor" href="#_3-object。" aria-hidden="true">#</a> 3.Object。</h5><p>这与{}的作用基本一样，最好也避免使用。</p><h4 id="_3-2-9-类型别名、并集和交集" tabindex="-1"><a class="header-anchor" href="#_3-2-9-类型别名、并集和交集" aria-hidden="true">#</a> 3.2.9 类型别名、并集和交集</h4><h5 id="类型别名" tabindex="-1"><a class="header-anchor" href="#类型别名" aria-hidden="true">#</a> 类型别名</h5><p>我们可以使用变量声明（let、const和var）为值声明别名，也可以为类型声明别名。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Age</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Person</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  name</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  age</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Age</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">driver</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Person</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">name</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">张三</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">age</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">18</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>与let和const一样的是，类型别名采用块级作用域，每块代码都有自己的作用域。类型别名有助于减少重复输入复制的类型（DRY）。</p><h5 id="并集类型和交集类型" tabindex="-1"><a class="header-anchor" href="#并集类型和交集类型" aria-hidden="true">#</a> 并集类型和交集类型</h5><p>TypeScript提供了特殊的类型运算符：并集使用<code>|</code>，交集使用<code>&amp;</code>。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Cat</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;">name</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> purrs</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Dog</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;">name</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> barks</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> wags</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">CatOrDogOrBoth</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Cat</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Dog</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">CatAndDog</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Cat</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Dog</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">CatOrDogOrBoth</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">name</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">zhangsan</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">purrs</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">name</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">lisi</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">barks</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">wags</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">purrs</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="_3-2-10-数组" tabindex="-1"><a class="header-anchor" href="#_3-2-10-数组" aria-hidden="true">#</a> 3.2.10 数组</h4><p>TypeScript支持两种注解数组类型的句法：<code>T[]</code>和<code>Array&lt;T&gt;</code>。两者的作用和性能无异。</p><p>一般情况下，数组应该保持同质。保证数组中的每个元素都具有相同的类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;">] </span><span style="color:#616E88;">// number[]</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;">)[] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">2</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-2-11-元组" tabindex="-1"><a class="header-anchor" href="#_3-2-11-元组" aria-hidden="true">#</a> 3.2.11 元组</h4><p>元组是array的子类型，是定义数组的一种特殊方式，长度固定，各索引位置上的值具有固定的已知类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;">] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;">] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">3</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">c</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#81A1C1;">?</span><span style="color:#D8DEE9FF;">] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 至少有一个元素</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">friend</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">...</span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;">[]] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">c</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>元组类型能正确定义元素类型不同的列表，还能知晓该种列表的长度。这些特性使得元组比数组安全得多，应该经常使用。</p><h5 id="只读数组和元组" tabindex="-1"><a class="header-anchor" href="#只读数组和元组" aria-hidden="true">#</a> 只读数组和元组</h5><p>若想更改只读数组，使用非变型方法（.concat、.slice），不能使用可变型方法（.push、.splice）。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">as</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">readonly</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;">[] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">bs</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">readonly</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;">] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">2</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-2-12-null、undefined、void和never" tabindex="-1"><a class="header-anchor" href="#_3-2-12-null、undefined、void和never" aria-hidden="true">#</a> 3.2.12 null、undefined、void和never</h4><p>在TypeScript中，undefined类型只有undefined一个值，null类型只有null一个值。</p><p>undefined的意思是尚未定义，而null表示缺少值。</p><p><code>void</code>是函数没有显示返回任何值时的返回类型，<code>never</code>是函数根本不返回（例如函数抛出异常，或者永远运行下去）时使用的类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// 返回void的函数</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">returnVoid</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 返回never的函数</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">returnNever</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TypeError</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">i a error</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 返回undefined的函数</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">returnUndefined</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">undefined</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><code>never</code>是其他每个类型的子类型，是“兜底类型”，这意味着<code>never</code>类型可赋值给其他任何类型。</p><table><thead><tr><th>类型</th><th>含义</th></tr></thead><tbody><tr><td>null</td><td>缺少值</td></tr><tr><td>undefined</td><td>尚未赋值的变量</td></tr><tr><td>void</td><td>没有return语句的函数</td></tr><tr><td>never</td><td>永不返回的函数</td></tr></tbody></table><h4 id="_3-2-13-枚举" tabindex="-1"><a class="header-anchor" href="#_3-2-13-枚举" aria-hidden="true">#</a> 3.2.13 枚举</h4><p>枚举的作用是列举类型中包含的各个值。是一种无序数据结构，把键映射到值上。</p><p>枚举分为两种：字符串到字符串之间的映射和字符串到数字之间的映射。</p><blockquote><p>按约定，枚举名称为大写的单数形式。枚举中的键也为大写。</p></blockquote><p>TypeScript可以自动为枚举中的各个成员推导对应的数字，我们也可以手动设置。</p><p>一个枚举可以分成几次声明，TypeScript将自动把各部分合并在一起。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">enum</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Language</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Engilsh</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Spanish</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Chinese</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">enum</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Language</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Russian</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">200</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">300</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Japan</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 501</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">enum</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Color</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Red</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">#c10000</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Blue</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">#007ac1</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">White</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">255</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">Language</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Chinese</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">] </span><span style="color:#616E88;">// 2</span></span>
<span class="line"><span style="color:#D8DEE9;">Color</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Blue</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// &#39;#007ac1&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>可以通过const enum指定枚举的安全子集</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">enum</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Language</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Engilsh</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Spanish</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Chinese</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">Language</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Chinese</span></span>
<span class="line"><span style="color:#D8DEE9;">Language</span><span style="color:#D8DEE9FF;">[</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">] </span><span style="color:#616E88;">// Error，不允许反向范围</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>由于使用枚举极易导致安全问题，因此笔者建议远离枚举。</p></blockquote><h3 id="_3-3-小结" tabindex="-1"><a class="header-anchor" href="#_3-3-小结" aria-hidden="true">#</a> 3.3 小结</h3><p>多数类型都分一般和具体两种形式，后者是前者的子类型。</p><table><thead><tr><th>类型</th><th>子类型</th></tr></thead><tbody><tr><td>boolean</td><td>Boolean字面量</td></tr><tr><td>bigint</td><td>BigInt字面量</td></tr><tr><td>number</td><td>Number字面量</td></tr><tr><td>string</td><td>String字面量</td></tr><tr><td>symbol</td><td>unique symbol</td></tr><tr><td>object</td><td>Object字面量</td></tr><tr><td>数组</td><td>元组</td></tr><tr><td>enum</td><td>const enum</td></tr></tbody></table><h2 id="第4章-函数" tabindex="-1"><a class="header-anchor" href="#第4章-函数" aria-hidden="true">#</a> 第4章 函数</h2><h3 id="_4-1-声明和调用函数" tabindex="-1"><a class="header-anchor" href="#_4-1-声明和调用函数" aria-hidden="true">#</a> 4.1 声明和调用函数</h3><p>TypeScript能推导出函数体中的类型，但是多数情况下无法推导出参数的类型，只在少数特殊情况下能根据上下文推导出参数的类型。</p><p><strong>通常需要注解参数的类型，而返回类型不要求必须注解</strong>。</p><h4 id="_4-1-1-可选和默认的参数" tabindex="-1"><a class="header-anchor" href="#_4-1-1-可选和默认的参数" aria-hidden="true">#</a> 4.1.1 可选和默认的参数</h4><p>声明函数的参数时，必要的参数在前面，随后才是可选的参数。（带默认值的参数不要求放在参数列表的末尾）。</p><h4 id="_4-1-2-剩余参数" tabindex="-1"><a class="header-anchor" href="#_4-1-2-剩余参数" aria-hidden="true">#</a> 4.1.2 剩余参数</h4><p>一个函数最多只能有一个剩余参数，而且必须位于参数列表的最后。</p><h4 id="_4-1-3-call、apply和bind" tabindex="-1"><a class="header-anchor" href="#_4-1-3-call、apply和bind" aria-hidden="true">#</a> 4.1.3 call、apply和bind</h4><blockquote><p>要在tsconfig.json中启用strictBindCallApply选项。</p></blockquote><h4 id="_4-1-4-注解this的类型" tabindex="-1"><a class="header-anchor" href="#_4-1-4-注解this的类型" aria-hidden="true">#</a> 4.1.4 注解this的类型</h4><blockquote><p>如果需要禁止在类方法以外使用this，启用TSLint的no-invalid-this规则。</p></blockquote><p>如果函数使用this，请在函数的第一个参数中声明this的类型（放在其他参数之前）。this不是常规的参数，而是保留字，是函数签名的一部分。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">fancyDate</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">this:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Date</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getDate</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fancyDate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">call</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Date</span><span style="color:#D8DEE9FF;">())</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_4-1-5-生成器函数" tabindex="-1"><a class="header-anchor" href="#_4-1-5-生成器函数" aria-hidden="true">#</a> 4.1.5 生成器函数</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">function*</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">createFibonacciGennerator</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">IterableIterator</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">while</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">true</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">yield</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        [</span><span style="color:#D8DEE9;">a</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;">] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#D8DEE9;">b</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">iterator</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">createFibonacciGennerator</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">iterator</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">next</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">iterator</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">next</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">iterator</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">next</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">iterator</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">next</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_4-1-6-迭代器" tabindex="-1"><a class="header-anchor" href="#_4-1-6-迭代器" aria-hidden="true">#</a> 4.1.6 迭代器</h4><blockquote><p>可迭代对象，有Symbol.iterator属性的对象，而且该属性的值为一个函数，返回一个迭代器。</p><p>迭代器，定义有next方法的对象，该方法返回一个具有value和done属性的对象。</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// 手动定义迭代器</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">numbers</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">[</span><span style="color:#8FBCBB;">Symbol</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">iterator</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">n</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">n</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&lt;=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">10</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">n</span><span style="color:#81A1C1;">++</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">yield</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">n</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">([</span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">numbers</span><span style="color:#D8DEE9FF;">])</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_4-1-7-调用签名" tabindex="-1"><a class="header-anchor" href="#_4-1-7-调用签名" aria-hidden="true">#</a> 4.1.7 调用签名</h4><p><code>(a: number, b: number) =&gt; number</code>，这是TypeScript表示函数类型的句法，也称调用签名。函数的调用签名只包含类型层面的代码，即只有类型，没有值。</p><p>调用签名没有函数的定义体，无法推导出返回类型，所以必须显式注解。</p><blockquote><p>“类型层面代码”指只有类型和类型运算符的代码。而其他的都是“值层面代码”。</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// function greet(name: string)</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Greet</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">greet</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Greet</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">name</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_4-1-8-上下文类型推导" tabindex="-1"><a class="header-anchor" href="#_4-1-8-上下文类型推导" aria-hidden="true">#</a> 4.1.8 上下文类型推导</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">time</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">index</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">n</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">i</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">i</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">n</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">i</span><span style="color:#81A1C1;">++</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#88C0D0;">f</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">i</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#88C0D0;">time</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">n</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">n</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_4-1-9-函数类型重载" tabindex="-1"><a class="header-anchor" href="#_4-1-9-函数类型重载" aria-hidden="true">#</a> 4.1.9 函数类型重载</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// 简写型调用签名</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Log</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">userId</span><span style="color:#81A1C1;">?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 完整型调用签名</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Log</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">	</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">userId</span><span style="color:#81A1C1;">?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// 函数重载</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Reserve</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">from</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Date</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">to</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Date</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">destination</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Reservation</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">from</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Date</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">destinantion</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Reservation</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 描述函数的属性</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">WarnUser</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">warning</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  wasCalled</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">warnUser</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">WarnUser</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">warning</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">...</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_4-2-多态" tabindex="-1"><a class="header-anchor" href="#_4-2-多态" aria-hidden="true">#</a> 4.2 多态</h3><blockquote><p>泛型参数，在类型层面施加约束的占位类型，也称多态类型参数。</p></blockquote><p>泛型参数使用<code>&lt;&gt;</code>声明。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Filter</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">array</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>T就是一个类型名称，如果愿意，可以使用任何其他名称。</p><p>只要可能就应该使用泛型，这样写出的代码更具一般性，可重复使用，并且简单扼要。</p></blockquote><h4 id="_4-2-1-什么时候绑定泛型" tabindex="-1"><a class="header-anchor" href="#_4-2-1-什么时候绑定泛型" aria-hidden="true">#</a> 4.2.1 什么时候绑定泛型</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Filter</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">array</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Filter</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">array</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_4-2-2-可以在什么地方声明泛型" tabindex="-1"><a class="header-anchor" href="#_4-2-2-可以在什么地方声明泛型" aria-hidden="true">#</a> 4.2.2 可以在什么地方声明泛型</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Filter</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">array</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Filter</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">array</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Filter</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">array</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Filter</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">array</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">filter</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">array</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[] </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="_4-2-3-泛型指导" tabindex="-1"><a class="header-anchor" href="#_4-2-3-泛型指导" aria-hidden="true">#</a> 4.2.3 泛型指导</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">map</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">array</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#D8DEE9FF;">[] </span><span style="color:#ECEFF4;">{</span><span style="color:#81A1C1;">...</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">//隐式注解</span></span>
<span class="line"><span style="color:#88C0D0;">map</span><span style="color:#D8DEE9FF;">([</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">c</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">//显示注解泛型</span></span>
<span class="line"><span style="color:#88C0D0;">map</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;">([</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">c</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_4-2-4-泛型别名" tabindex="-1"><a class="header-anchor" href="#_4-2-4-泛型别名" aria-hidden="true">#</a> 4.2.4 泛型别名</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// 在类型别名中只有这一个地方可以声明泛型</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyEvent</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  target</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  type</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ButtonEvent</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyEvent</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">HTMLButtonElement</span><span style="color:#ECEFF4;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TimedEevent</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  event</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyEvent</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  from</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Date</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  to</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Date</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">triggerEvent</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">event</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyEvent</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#81A1C1;">...</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">triggerEvent</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">target</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">document</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">querySelector</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">#myButton</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">type</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">mouseover</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="_4-2-5-受限的多态" tabindex="-1"><a class="header-anchor" href="#_4-2-5-受限的多态" aria-hidden="true">#</a> 4.2.5 受限的多态</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TreeNode</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    value</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">LeafNode</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TreeNode</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    isLeaf</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">true</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">InnerNode</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TreeNode</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    children</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TreeNode</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">TreeNode</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TreeNode</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">mapNode</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TreeNode</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">node</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">value</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">node</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#D8DEE9;">value</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">node</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">value</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TreeNode</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">value</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">LeafNode</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">value</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">isLeaf</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">c1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">InnerNode</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">value</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">c</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">children</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b1</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#88C0D0;">mapNode</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">a1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toUpperCase</span><span style="color:#D8DEE9FF;">()))</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// { value: &#39;A&#39; }</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#88C0D0;">mapNode</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">b1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toUpperCase</span><span style="color:#D8DEE9FF;">()))</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// { value: &#39;B&#39;, isLeaf: true }</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#88C0D0;">mapNode</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">c1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">_</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toUpperCase</span><span style="color:#D8DEE9FF;">()))</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// { value: &#39;C&#39;, children: { value: &#39;b&#39;, isLeaf: true } }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h5 id="有多个约束的受限多态" tabindex="-1"><a class="header-anchor" href="#有多个约束的受限多态" aria-hidden="true">#</a> 有多个约束的受限多态</h5><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">HasSides</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> numberOfSide</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">SideHaveLength</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> sideLength</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">logPerimeter</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Shape</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">HasSides</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">SideHaveLength</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">s</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Shape</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Shape</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">s</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">numberOfSide</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">s</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">sideLength</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">s</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#88C0D0;">logPerimeter</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">numberOfSide</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">4</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">sideLength</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 12</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h5 id="使用受限的多态模拟变长参数" tabindex="-1"><a class="header-anchor" href="#使用受限的多态模拟变长参数" aria-hidden="true">#</a> 使用受限的多态模拟变长参数</h5><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">call</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">unknown</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">R</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">args</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">R</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">args</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">R</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">args</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_4-2-6-泛型默认类型" tabindex="-1"><a class="header-anchor" href="#_4-2-6-泛型默认类型" aria-hidden="true">#</a> 4.2.6 泛型默认类型</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyEvent</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">HTMLButtonElement</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    target</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    type</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyEvent</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">HTMLElement</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">HTMLButtonElement</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    target</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    type</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">myEvent</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyEvent</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">target</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">document</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createElement</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">button</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">type</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">button</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 有默认类型的泛型要放在没有默认类型的泛型后面</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyEvent2</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">R</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">HTMLElement</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">HTMLElement</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    target</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">R</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    type</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_4-3-类型驱动开发" tabindex="-1"><a class="header-anchor" href="#_4-3-类型驱动开发" aria-hidden="true">#</a> 4.3 类型驱动开发</h3><blockquote><p>类型驱动开发，先草拟类型签名，然后填充值的编程风格。</p></blockquote><p>编程TypeScript程序时，先定义函数的类型签名，即“受类型的指引”，然后再具体实现。</p><h2 id="第5章-类和接口" tabindex="-1"><a class="header-anchor" href="#第5章-类和接口" aria-hidden="true">#</a> 第5章 类和接口</h2><h3 id="_5-1-类和继承" tabindex="-1"><a class="header-anchor" href="#_5-1-类和继承" aria-hidden="true">#</a> 5.1 类和继承</h3><p>访问修饰符会自动把参数赋值给this。<code>readonly</code>在初始化赋值后，这个属性只能读取，不能再赋其他值。</p><p>访问修饰符：</p><ul><li><p><code>public</code></p><p>任何地方都可访问。这是默认的访问级别。</p></li><li><p><code>protected</code></p><p>可由当前类及其子类的实例访问。</p></li><li><p><code>private</code></p><p>只可由当前类的实例访问。</p></li></ul><p><code>abstract</code>关键字表明，不能直接初始化该类。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Color</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Black</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">White</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Files</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">A</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">B</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">C</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">D</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">E</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">F</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">G</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">H</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Rank</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">4</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">5</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">6</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">7</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Position</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">file</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Files</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">rank</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Rank</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">distanceFrom</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">postion</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Position</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#D8DEE9;">rank</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Math</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">abs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">postion</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">rank</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">rank</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Math</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">abs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">postion</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">charCodeAt</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">charCodeAt</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">))</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 表明该类不能直接实例化。</span></span>
<span class="line"><span style="color:#81A1C1;">abstract</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Piece</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">protected</span><span style="color:#D8DEE9FF;"> position</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Position</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">readonly</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">color</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Color</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#D8DEE9;">file</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Files</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">rank</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Rank</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">position</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">Position</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">rank</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    </span><span style="color:#616E88;">// 如果子类愿意，也可以覆盖默认实现。默认修饰符为public</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">moveTo</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">position</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Position</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">position</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">position</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#ECEFF4;">    </span><span style="color:#616E88;">// 子类必须实现一个名为canMoveTo的方法，而且要兼容指定的签名。</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">abstract</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">canMoveTo</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">position</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Position</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 创建一个King类继承Piece</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">King</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">Piece</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">canMoveTo</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">position</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Position</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">distance</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">position</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">distanceFrom</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">position</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">distance</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">rank</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">distance</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">file</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 开始新游戏</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Game</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> pieces </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">Game</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">makePieces</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">static</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">makePieces</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">King</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">White</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">E</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">King</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Black</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">C</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">8</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><ul><li>类使用class关键字声明。扩展类时使用extends关键字。</li><li>类可以是具体的，也可以是抽象的（abstract）。抽象类可以有抽象方法和抽象属性。</li><li>方法的可见性可以是private、protected和public（默认）。方法分为实例方法和静态方法两种。</li><li>类可以有实例属性，可见性也可以是private、protected和public（默认）。实例属性可在构造方法的参数中声明，也可以通过属性初始化语句声明。</li><li>声明实例属性时可以使用readonly把属性标记为只读。</li></ul><h3 id="_5-2-super" tabindex="-1"><a class="header-anchor" href="#_5-2-super" aria-hidden="true">#</a> 5.2 super</h3><p>super有两种调用方式：</p><ul><li>方法调用，例如super.take。</li><li>构造方法调用。使用特殊的形式super()，而且只能在构造方法中调用。如果子类有构造方法，在子类的构造方法中必须调用super()，把父子关系连接起来。</li></ul><h3 id="_5-3-以this为返回类型" tabindex="-1"><a class="header-anchor" href="#_5-3-以this为返回类型" aria-hidden="true">#</a> 5.3 以this为返回类型</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Set</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">has</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">val</span><span style="color:#81A1C1;">?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">        </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">val</span><span style="color:#81A1C1;">?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">this</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">        </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Set</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">has</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_5-4-接口" tabindex="-1"><a class="header-anchor" href="#_5-4-接口" aria-hidden="true">#</a> 5.4 接口</h4><p>接口是一种命名类型的方法。类型别名和接口算是同一概念的两种句法（就像函数表达式和函数声明之间的关系）。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">//类型别名方式</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Food</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    calories</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    tasty</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Sushi</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Food</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    salty</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Cake</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Food</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    sweet</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 接口方式</span></span>
<span class="line"><span style="color:#81A1C1;">interface</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Food</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    calories</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    tasty</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">interface</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Sushi</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">Food</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    salty</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">interface</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Cake</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">Food</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    sweet</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>类型和接口之间的区别：</p><ul><li><p>类型别名更为通用，右边可以是任何类型，包括类型表达式（类型、&amp;或|等类型运算符）；而接口声明右边必须为结构。</p></li><li><p>扩展接口时，TypeScript将检查扩展的接口是否可赋值给被扩展的接口。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">interface</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">A</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    age</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">interface</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">A</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    age</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// error</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li><li><p>同一作用域中的多个同名接口将自动合并；同一作用域中的多个同名类型别名将导致编译时错误。</p></li></ul><h4 id="_5-4-1-声明合并" tabindex="-1"><a class="header-anchor" href="#_5-4-1-声明合并" aria-hidden="true">#</a> 5.4.1 声明合并</h4><p>两个接口不能有冲突。如果声明了泛型，必须使用一样的名称和类型。</p><h4 id="_5-4-2-实现" tabindex="-1"><a class="header-anchor" href="#_5-4-2-实现" aria-hidden="true">#</a> 5.4.2 实现</h4><p>声明类时，可以使用<code>implements</code>关键字指明该类满足某个接口。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">interface</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Person</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    name</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    age</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">say</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">content</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Xiaoming</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">implements</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">Person</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">public</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">public</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">age</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  	</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">say</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">content</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">content</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  	</span></span>
<span class="line"><span style="color:#ECEFF4;">  	</span><span style="color:#616E88;">// 如果需要，在此基础上还可以实现其他方法和属性</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  	</span><span style="color:#88C0D0;">run</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>接口可以声明实例属性，但是不能带有可见性修饰符（private，protected和public），也不能使用static关键字。</p><p>一个类不限于只能实现一个接口，而是想实现多少都可以。</p><h4 id="_5-4-3-实现接口还是扩展抽象类" tabindex="-1"><a class="header-anchor" href="#_5-4-3-实现接口还是扩展抽象类" aria-hidden="true">#</a> 5.4.3 实现接口还是扩展抽象类</h4><p>实现接口更通用、更轻量，而抽象类的作用更具体、功能更丰富。</p><p>接口是对结构建模的方式。在值层面可表示对象、数组、函数、类或类的实例。接口不生成JavaScript代码，只存在于编译时。</p><p>抽象类只能对类建模，而且生成运行时代码，即JavaScript类。抽象类可以有构造方法，可以提供默认实现，还能为属性和方法设置访问修饰符。</p><p>如果多个类公用一个实现，使用抽象类。如果需要一种轻量的方式表示“这个类是T型”，使用接口。</p><h3 id="_5-5-类是结构化类型" tabindex="-1"><a class="header-anchor" href="#_5-5-类是结构化类型" aria-hidden="true">#</a> 5.5 类是结构化类型</h3><p>TypeScript是结构化类型语言。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Zebra</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">trot</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">        </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Poodle</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">trot</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">        </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">ambleAround</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">animal</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Zebra</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">animal</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">trot</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">ambleAround</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">Zebra</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#616E88;">// OK</span></span>
<span class="line"><span style="color:#88C0D0;">ambleAround</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">Poodle</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#616E88;">// OK</span></span>
<span class="line"><span style="color:#88C0D0;">ambleAround</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">trot</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">) </span><span style="color:#616E88;">// OK</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_5-6-类既声明值也声明类型" tabindex="-1"><a class="header-anchor" href="#_5-6-类既声明值也声明类型" aria-hidden="true">#</a> 5.6 类既声明值也声明类型</h3><p>在TypeScript中，多数时候，表达的要么是值要么是类型。类型和值位于不同的命名空间。</p><p>类和枚举比较特殊，它们既在类型命名空间中生成类型，也在值命名空间中生成值。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">C</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">c</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">C</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">C</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">enum</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">E</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">F</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">G</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">e</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">E</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">E</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">F</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_5-7-多态" tabindex="-1"><a class="header-anchor" href="#_5-7-多态" aria-hidden="true">#</a> 5.7 多态</h3><p>类和接口对泛型参数也有深层支持，包括默认类型和限制。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyMap</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;">V</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">public</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">initialKey</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">public</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">initialValue</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 在构造方法中不能声明泛型。应该在类声明中声明泛型。</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">key</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">initialValue</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">merge</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">K1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V1</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">map</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyMap</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">K1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V1</span><span style="color:#ECEFF4;">&gt;)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyMap</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">K</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">K1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V1</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 实例方法可以访问类一级的泛型，也可以自己声明泛型。</span></span>
<span class="line"><span style="color:#ECEFF4;">        </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  	</span><span style="color:#81A1C1;">static</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">of</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">k</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">v</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyMap</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 静态方法不能访问类的泛型，就像值层面不能访问类的实例变量一样。</span></span>
<span class="line"><span style="color:#ECEFF4;">        </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">interface</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyMap</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">key</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">set</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">key</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">value</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">V</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#616E88;">// 可以显式为泛型绑定具体类型，也可以让TypeScript自动推导。</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">MyMap</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">k</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">MyMap</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">v</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_5-8-混入" tabindex="-1"><a class="header-anchor" href="#_5-8-混入" aria-hidden="true">#</a> 5.8 混入</h3><p>混入就是把行为和属性混合到类中。混入有以下特性：</p><ul><li>可以有状态（即实例属性）。</li><li>只能提供具体方法（与抽象方法相反）。</li><li>可以有构造方法，调用的顺序与混入类的顺序一致。</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ClassConstructor</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">args</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">any</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">withEZDegbug</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">C</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ClassConstructor</span><span style="color:#ECEFF4;">&lt;{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">getDebugValue</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">object</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}&gt;&gt;(</span><span style="color:#D8DEE9;">Class</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">C</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">Class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">args</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">any</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">super</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">args</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">Name</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">Class</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constructor</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">value</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getDebugValue</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">Name</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stringify</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">value</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">)</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">HardToDebugUser</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">fristName</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">lastName</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">getDebugValue</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#D8DEE9;">id</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">id</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#D8DEE9;">name</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">fristName</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lastName</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">User</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">withEZDegbug</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">HardToDebugUser</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">user</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">User</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">chen</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">zilin</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">user</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="_5-9-装饰器" tabindex="-1"><a class="header-anchor" href="#_5-9-装饰器" aria-hidden="true">#</a> 5.9 装饰器</h3><p>装饰器为类、类方法、属性和方法参数的元编程提供简洁的句法。装饰器就是在装饰目标上调用函数的一种句法。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ClassConstructor</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">args</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">any</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">serializable</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ClassConstructor</span><span style="color:#ECEFF4;">&lt;{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">getValue</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">PayLoad</span></span>
<span class="line"><span style="color:#ECEFF4;">}&gt;&gt;(</span><span style="color:#D8DEE9;">Constructor</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">Constructor</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#88C0D0;">seialize</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getValue</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_5-10-模拟final类" tabindex="-1"><a class="header-anchor" href="#_5-10-模拟final类" aria-hidden="true">#</a> 5.10 模拟final类</h3><p>final关键字的作用：某些语言使用这个关键字把类标记为不可扩展，或者把方法标记为不可覆盖。</p><p>把constructor标记为private后，不能使用new运算符实例化类，也不能扩展类。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MessageQueue</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">static</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">create</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">MessageQueue</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">BadQueue</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">MessageQueue</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 无法扩展</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">MessageQueue</span><span style="color:#D8DEE9FF;">() </span><span style="color:#616E88;">// 无法直接实例化</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">MessageQueue</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">create</span><span style="color:#D8DEE9FF;">([</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">string</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">])</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_5-11-设计模式" tabindex="-1"><a class="header-anchor" href="#_5-11-设计模式" aria-hidden="true">#</a> 5.11 设计模式</h3><h4 id="_5-11-1-工厂模式" tabindex="-1"><a class="header-anchor" href="#_5-11-1-工厂模式" aria-hidden="true">#</a> 5.11.1 工厂模式</h4><p>创建某种类型的对象的一种方式，这种方式把创建哪种具体对象留给创建该对象的工厂决定。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Shoe</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    purpose</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">BalletFlat</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">implements</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">Shoe</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    purpose </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">dancing</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Boot</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">implements</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">Shoe</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    purpose </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">woodcutting</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Sneaker</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">implements</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;font-weight:bold;">Shoe</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    purpose </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">walking</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">Shoe</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">create</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">type</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">balletFlat</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">boot</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">sneaker</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Shoe</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">switch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">type</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">case</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">balletFlat</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">BalletFlat</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">case</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">boot</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">Boot</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">case</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">sneaker</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">Sneaker</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h4 id="_5-11-2-建造者模式" tabindex="-1"><a class="header-anchor" href="#_5-11-2-建造者模式" aria-hidden="true">#</a> 5.11.2 建造者模式</h4><p>建造者模式把对象的建造方式与具体的实现方式区分开。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">RequestBuilder</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> url</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">null</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">null</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> method</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">get</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">post</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">null</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">null</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">setURL</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">url</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">this</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">url</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">url</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">setMethod</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">method</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">get</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">post</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">this</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">method</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">RequestBuilder</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setMethod</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">get</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setURL</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">/api</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="第6章-类型进阶" tabindex="-1"><a class="header-anchor" href="#第6章-类型进阶" aria-hidden="true">#</a> 第6章 类型进阶</h2><h3 id="_6-1-类型之间的关系" tabindex="-1"><a class="header-anchor" href="#_6-1-类型之间的关系" aria-hidden="true">#</a> 6.1 类型之间的关系</h3><h4 id="_6-1-1-子类型和超类型" tabindex="-1"><a class="header-anchor" href="#_6-1-1-子类型和超类型" aria-hidden="true">#</a> 6.1.1 子类型和超类型</h4><blockquote><p>子类型，给定两个类型A和B，假设B是A的子类型，那么在需要A的地方都可以放心使用B。</p><p>超类型，给定两个类型A和B，假设B是A的超类型，那么在需要B的地方都可以放心使用A。</p></blockquote><h4 id="_6-1-2-型变" tabindex="-1"><a class="header-anchor" href="#_6-1-2-型变" aria-hidden="true">#</a> 6.1.2 型变</h4><p>对预期的结构，可以使用属性的类型&lt;:预期类型的结构，但是不能传入属性的类型是预期类型的超类型的结构。</p><p>型变的四种方式：</p><ol><li><p>不变</p><p>只能是T。</p></li><li><p>斜变</p><p>可以是&lt;:T。</p></li><li><p>逆变</p><p>可以是&gt;:T。</p></li><li><p>双变</p><p>可以是&lt;:T或&gt;:T。</p></li></ol><h5 id="函数型变" tabindex="-1"><a class="header-anchor" href="#函数型变" aria-hidden="true">#</a> 函数型变</h5><p>函数A是函数B的子类型需要满足以下条件：</p><ol><li>函数A的this类型未指定，或者&gt;:函数B的this类型。</li><li>函数A的各个参数类型&gt;:函数B的相应类型。</li><li>函数A的返回类型&lt;:函数B的返回类型。</li></ol><h4 id="_6-1-3-可赋值性" tabindex="-1"><a class="header-anchor" href="#_6-1-3-可赋值性" aria-hidden="true">#</a> 6.1.3 可赋值性</h4><p>可赋值性指在判断需要B类型的地方是否使用A类型时TypeScript采用的规则。</p><p>在满足下述任一条件时，A类型可赋值给B类型（枚举类型例外）：</p><ol><li>A&lt;:B。</li><li>A是any。</li></ol><h4 id="_6-1-4-类型拓宽" tabindex="-1"><a class="header-anchor" href="#_6-1-4-类型拓宽" aria-hidden="true">#</a> 6.1.4 类型拓宽</h4><p>TypeScript在推导类型时会放宽要求，故意推导出一个更宽泛的类型，而不限定为某个具体的类型。</p><p>声明变量时如果允许以后修改变量的值，变量的类型将拓宽，从字面值放大到包含该字面量的基类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">x</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// string</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">x</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// {x: number}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果使用let或var重新为非拓宽类型赋值，TypeScript将自动拓宽。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">x</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// &#39;x&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// string</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 倘若不想让TypeScript拓宽，一开始声明时要显示注解类型；</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">c</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">x</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">x</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// &#39;x&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">d</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">c</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// &#39;x&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 初始化为null或undefined的变量将拓宽为any；</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">null</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// any</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">undefined</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// any</span></span>
<span class="line"><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// any</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 当初始化的null或undefined的变量离开声明时所在的作用域，TypeScript将为其分配一个具体类型</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">x</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">null</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// any</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// any</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// any</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">x</span><span style="color:#D8DEE9FF;">() </span><span style="color:#616E88;">// string</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h5 id="const类型" tabindex="-1"><a class="header-anchor" href="#const类型" aria-hidden="true">#</a> const类型</h5><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// const类型可以禁止拓宽，还可以将递归成员设为readonly</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">x</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// {x: number}</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">x</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// {readonly x: 3}</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">c</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">x</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">y</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// {readonly x: {readonly y: 3}}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="多余属性检查" tabindex="-1"><a class="header-anchor" href="#多余属性检查" aria-hidden="true">#</a> 多余属性检查</h5><p>TypeScript检查一个对象是否可赋值给另一个对象类型时，也涉及到类型拓宽。</p><p>尝试把一个新鲜对象字面量类型T赋值给另一个类型U时，如果T有不在U中的属性，将报错。</p><p>新鲜对象字面量类型指的是TypeScript从对象字面量中推导出来的类型。如果对象字面量有类型断言（as），或者把对象字面量赋值给变量，那么新鲜对象字面量类型将拓宽为常规的对象类型，也就不能称为新鲜对象字面量类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Options</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    baseURL</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    cacheSize</span><span style="color:#81A1C1;">?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    tier</span><span style="color:#81A1C1;">?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">prod</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">dev</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">API</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">options</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Options</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">API</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">baseURL</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">https://chenzilin.com</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">API</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">baseURL</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">https://chenzilin.com</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">badTier</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">123</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Options</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">badOptions</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">baseURL</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">https://chenzilin.com</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">badTier</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">123</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">API</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">badOptions</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="_6-1-5-细化" tabindex="-1"><a class="header-anchor" href="#_6-1-5-细化" aria-hidden="true">#</a> 6.1.5 细化</h4><p>TypeScript采用的是基于流的类型推导。</p><blockquote><p>JavaScript有七个假值：null、undefined、NaN、0、-0、&quot;&quot;和false。</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserEvent</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    value</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">handle</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">event</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserEvent</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">typeof</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">event</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">value</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">string</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 细化</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#D8DEE9;">event</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">value</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// string</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">event</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">value</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// [number, number]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>类型细化的能力有限，只能细化当前作用域中变量的类型，一旦离开这个作用域，类型细化能力不会随之转移到新作用域中。</p><h3 id="_6-2-全面性检查" tabindex="-1"><a class="header-anchor" href="#_6-2-全面性检查" aria-hidden="true">#</a> 6.2 全面性检查</h3><p>全面性检查是类型检查器所做的一项检查，为的是确保所有情况都被覆盖了。</p><h3 id="_6-3-对象类型进阶" tabindex="-1"><a class="header-anchor" href="#_6-3-对象类型进阶" aria-hidden="true">#</a> 6.3 对象类型进阶</h3><h4 id="_6-3-1-对象类型的类型运算符" tabindex="-1"><a class="header-anchor" href="#_6-3-1-对象类型的类型运算符" aria-hidden="true">#</a> 6.3.1 对象类型的类型运算符</h4><h5 id="键入-运算符" tabindex="-1"><a class="header-anchor" href="#键入-运算符" aria-hidden="true">#</a> “键入”运算符</h5><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">APIResponse</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    user</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        userId</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        friendList</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            count</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            friends</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                firstName</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                lastName</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">FriendLst</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">APIResponse</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">user</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">][</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">friendList</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">] </span><span style="color:#616E88;">// 键入</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="keyof运算符" tabindex="-1"><a class="header-anchor" href="#keyof运算符" aria-hidden="true">#</a> keyof运算符</h5><p>获取对象所有键的类型，合并为一个字符串字面量类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserKeys</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">keyof</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">APIResponse</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">user</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">] </span><span style="color:#616E88;">// &quot;userId&quot; | &quot;friendList&quot;</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">FriendListKeys</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">keyof</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">APIResponse</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">user</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">][</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">friendList</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">] </span><span style="color:#616E88;">// &quot;count&quot; | &quot;friends&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 类型安全的读值函数</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">O</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">object</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">K</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">keyof</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">O</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">o</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">O</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">k</span><span style="color:#81A1C1;">:</span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">O</span><span style="color:#D8DEE9FF;">[</span><span style="color:#8FBCBB;">K</span><span style="color:#D8DEE9FF;">] </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">o</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">k</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_6-3-2-record类型" tabindex="-1"><a class="header-anchor" href="#_6-3-2-record类型" aria-hidden="true">#</a> 6.3.2 Record类型</h4><p>Record类型用于描述有映射关系的对象。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Weekday</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Mon</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Tue</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Wed</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Day</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Weekday</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Sat</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Sun</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">nextData</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Record</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Weekday</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Day</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Mon</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Tue</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Tue</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Wed</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Wed</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Sat</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_6-3-3-映射类型" tabindex="-1"><a class="header-anchor" href="#_6-3-3-映射类型" aria-hidden="true">#</a> 6.3.3 映射类型</h4><p>Record类型也是使用映射类型实现的。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">nextDay</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">key</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Weekday</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Day</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Mon</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Tue</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Tue</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Wed</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Wed</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Sat</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// -类型运算符可以把修饰符去掉</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">nextDay</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">key</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Weekday</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">-?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Day</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Mon</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Tue</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Tue</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Wed</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Wed</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">Sun</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="内置的映射类型" tabindex="-1"><a class="header-anchor" href="#内置的映射类型" aria-hidden="true">#</a> 内置的映射类型</h5><ul><li><p><code>Record&lt;Keys, Values&gt;</code></p><p>键的类型为Keys、值的类型为Values的对象。</p></li><li><p><code>Partial&lt;Object&gt;</code></p><p>把Object中的每个字段都标记为可选的。</p></li><li><p><code>Required&lt;Object&gt;</code></p><p>把Object中的每个字段都标记为必须的。</p></li><li><p><code>Readonly&lt;Object&gt;</code></p><p>把Object中的每个字段都标记为只读的。</p></li><li><p><code>Pick&lt;Object, Keys&gt;</code></p><p>返回Object的子类型，只含指定的Keys。</p></li></ul><h4 id="_6-3-4-伴生对象模式" tabindex="-1"><a class="header-anchor" href="#_6-3-4-伴生对象模式" aria-hidden="true">#</a> 6.3.4 伴生对象模式</h4><p>把类型和对象配对在一起，称为伴生对象模式。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Currency</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    unit</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">EUR</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">GBP</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    value</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">Currency</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">DEFAULT</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">USD</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">from</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">value</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">unit</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">Currency</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">DEFAULT</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Currency</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">unit</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">value</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>如果一个类型和一个对象在语义上有关联，就可以使用伴生对象模式，由对象提供操作类型的实用方法。</p><h3 id="_6-4-函数类型进阶" tabindex="-1"><a class="header-anchor" href="#_6-4-函数类型进阶" aria-hidden="true">#</a> 6.4 函数类型进阶</h3><h4 id="_6-4-1-改善元组的类型推导" tabindex="-1"><a class="header-anchor" href="#_6-4-1-改善元组的类型推导" aria-hidden="true">#</a> 6.4.1 改善元组的类型推导</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">tuple</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">unknown</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">ts</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">ts</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">] </span><span style="color:#616E88;">// (number | boolean)[]</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">tuple</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">) </span><span style="color:#616E88;">// [boolean, number]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_6-4-2-用户定义的类型防护措施" tabindex="-1"><a class="header-anchor" href="#_6-4-2-用户定义的类型防护措施" aria-hidden="true">#</a> 6.4.2 用户定义的类型防护措施</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// 函数细化了参数的类型，而且返回一个布尔值，可以使用类型防护措施确保类型的细化能在作用域之间转移，在使用该函数的任何地方都起作用。</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">isString</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">a</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">unknown</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">is</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">typeof</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">string</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_6-5-条件类型" tabindex="-1"><a class="header-anchor" href="#_6-5-条件类型" aria-hidden="true">#</a> 6.5 条件类型</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">IsString</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">?</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">true</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">A</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">IsString</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// true</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">B</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">IsString</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// false</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_6-5-1-条件分配" tabindex="-1"><a class="header-anchor" href="#_6-5-1-条件分配" aria-hidden="true">#</a> 6.5.1 条件分配</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ToArray2</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">unknown</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">?</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[] </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">R</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ToArray2</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// string[] | number[]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 在T中而不再U中的类型</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Without</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">?</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">never</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">O</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Without</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">boolean</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// string | number</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_6-5-2-infer关键字" tabindex="-1"><a class="header-anchor" href="#_6-5-2-infer关键字" aria-hidden="true">#</a> 6.5.2 infer关键字</h4><p>在条件类型中声明泛型使用infer关键字。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ElementType</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">infer</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#D8DEE9FF;">)[] </span><span style="color:#81A1C1;">?</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">G</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ElementType</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// number</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">SecondArg</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">F</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">F</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">a</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">any</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">b</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">infer</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">B</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">any</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">?</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">B</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">never</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">F</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">typeof</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Array</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">prototype</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">][</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">slice</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">SecondArg</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">F</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// number</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_6-5-3-内置的条件类型" tabindex="-1"><a class="header-anchor" href="#_6-5-3-内置的条件类型" aria-hidden="true">#</a> 6.5.3 内置的条件类型</h4><ul><li><p><code>Exclude&lt;T, U&gt;</code></p><p>计算在T中而不在U中的类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">A</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">B</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">C</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Exclude</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">A</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">B</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// number</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p><code>Extract&lt;T, U&gt;</code></p><p>计算T中可赋值给U的类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">A</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">B</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">C</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Extract</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">A</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">B</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// string</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p><code>NonNullable&lt;T&gt;</code></p><p>从T中排除null和undefined。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">N</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> a</span><span style="color:#81A1C1;">?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">null</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">M</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">NonNullable</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">N</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// number</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p><code>ReturnType&lt;F&gt;</code></p><p>计算函数的返回类型（不适用于泛型和重载的函数）。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Fun</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">a</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Re</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ReturnType</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Fun</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// string</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p><code>InstanceType&lt;C&gt;</code></p><p>计算类构造方法的实例类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">A</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">B</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">B</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> b</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">I</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">InstanceType</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">A</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// {b: number}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul><h3 id="_6-6-解决方法" tabindex="-1"><a class="header-anchor" href="#_6-6-解决方法" aria-hidden="true">#</a> 6.6 解决方法</h3><h4 id="_6-6-1-类型断言" tabindex="-1"><a class="header-anchor" href="#_6-6-1-类型断言" aria-hidden="true">#</a> 6.6.1 类型断言</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">formatInput</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">input</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">    </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">getUserInput</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">    </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">input</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">getUserInput</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 优先使用as</span></span>
<span class="line"><span style="color:#88C0D0;">formatInput</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">input</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#616E88;">// 类型断言旧句法</span></span>
<span class="line"><span style="color:#88C0D0;">formatInput</span><span style="color:#D8DEE9FF;">(&lt;</span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;">&gt;</span><span style="color:#D8DEE9;">input</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_6-6-2-非空断言" tabindex="-1"><a class="header-anchor" href="#_6-6-2-非空断言" aria-hidden="true">#</a> 6.6.2 非空断言</h4><p><code>!</code>非空断言运算符。如果频繁使用非空断言，这就表明你的代码需要重构。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Dialog</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    id</span><span style="color:#81A1C1;">?:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">closeDialog</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dialog</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Dialog</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">!</span><span style="color:#D8DEE9;">dialog</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">id</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">return</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#88C0D0;">removeFromDom</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dialog</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">document</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getElementById</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dialog</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;">!</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">!</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">removeFromDom</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dialog</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Dialog</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">element</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Element</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">element</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">parentNode</span><span style="color:#81A1C1;">!</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">removeChild</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">element</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">delete</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">dialog</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">id</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_6-6-3-明确赋值断言" tabindex="-1"><a class="header-anchor" href="#_6-6-3-明确赋值断言" aria-hidden="true">#</a> 6.6.3 明确赋值断言</h4><p>如果频繁使用明确赋值断言，可能表明你的代码有问题。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">userId</span><span style="color:#81A1C1;">!:</span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 明确赋值，告诉TypeScript，在读取userId时，肯定已经为它赋值了。</span></span>
<span class="line"><span style="color:#88C0D0;">fetchUser</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">userId</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toUpperCase</span><span style="color:#D8DEE9FF;">() </span><span style="color:#616E88;">// OK</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">fetchUser</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">userId</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">globalCache</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">userId</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_6-7-模拟名义类型" tabindex="-1"><a class="header-anchor" href="#_6-7-模拟名义类型" aria-hidden="true">#</a> 6.7 模拟名义类型</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// 带烙印的类型能极大地提升安全性，一般的应用用不上。</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">CompanyID</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">readonly</span><span style="color:#D8DEE9FF;"> brand</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">unique</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">symbol</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">OrderID</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">readonly</span><span style="color:#D8DEE9FF;"> brand</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">unique</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">symbol</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">readonly</span><span style="color:#D8DEE9FF;"> brand</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">unique</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">symbol</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ID</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">CompanyID</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">OrderID</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">CompanyID</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">id</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">CompanyID</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">OrderID</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">id</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">OrderID</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">UserID</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">id</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">queryForUser</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">    </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">companId</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">CompanyID</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">8a6076cf</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">orderId</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">OrderID</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">9994acc1</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">userId</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">UserID</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">d21b1bbf</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">queryForUser</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">userId</span><span style="color:#D8DEE9FF;">) </span><span style="color:#616E88;">// OK</span></span>
<span class="line"><span style="color:#88C0D0;">queryForUser</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">companId</span><span style="color:#D8DEE9FF;">) </span><span style="color:#616E88;">// Error</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="_6-8-安全地扩展原型" tabindex="-1"><a class="header-anchor" href="#_6-8-安全地扩展原型" aria-hidden="true">#</a> 6.8 安全地扩展原型</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">interface</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Array</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">zip</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">list</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#D8DEE9FF;">][]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">Array</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">prototype</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">zip</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">function</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#81A1C1;">this:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">list</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">U</span><span style="color:#D8DEE9FF;">][] </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">map</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">v</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">k</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">tuple</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">v</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">list</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">k</span><span style="color:#D8DEE9FF;">]))</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="第7章-处理错误" tabindex="-1"><a class="header-anchor" href="#第7章-处理错误" aria-hidden="true">#</a> 第7章 处理错误</h2><h3 id="_7-1-返回null" tabindex="-1"><a class="header-anchor" href="#_7-1-返回null" aria-hidden="true">#</a> 7.1 返回null</h3><p>考虑到类型安全，返回null是处理错误最为轻量的方式。</p><p>但是返回null不利于程序的编写（不推荐）。</p><h3 id="_7-2-抛出异常" tabindex="-1"><a class="header-anchor" href="#_7-2-抛出异常" aria-hidden="true">#</a> 7.2 抛出异常</h3><p><code>throw error</code>。</p><h3 id="_7-3-返回异常" tabindex="-1"><a class="header-anchor" href="#_7-3-返回异常" aria-hidden="true">#</a> 7.3 返回异常</h3><p><code>function x(): T | Error { // ... }</code></p><h3 id="_7-4-option类型" tabindex="-1"><a class="header-anchor" href="#_7-4-option类型" aria-hidden="true">#</a> 7.4 Option类型</h3><h2 id="第8章-异步编程、并发和并行" tabindex="-1"><a class="header-anchor" href="#第8章-异步编程、并发和并行" aria-hidden="true">#</a> 第8章 异步编程、并发和并行</h2><h3 id="_8-1-javascript的事件循环" tabindex="-1"><a class="header-anchor" href="#_8-1-javascript的事件循环" aria-hidden="true">#</a> 8.1 JavaScript的事件循环</h3><h3 id="_8-2-处理回调" tabindex="-1"><a class="header-anchor" href="#_8-2-处理回调" aria-hidden="true">#</a> 8.2 处理回调</h3><ul><li>使用回调可执行简单的异步任务。</li><li>虽然回调适合处理简单的任务，但是如果异步任务变多，很容易编程一团乱麻。</li></ul><h3 id="_8-3-promise-让一切回到正轨" tabindex="-1"><a class="header-anchor" href="#_8-3-promise-让一切回到正轨" aria-hidden="true">#</a> 8.3 promise：让一切回到正轨</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Executor</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> (</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">resolve</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">result</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">reject</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">error</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">unknown</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span></span>
<span class="line"><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Promise</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">constructor</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Executor</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">then</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#88C0D0;">g</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">result</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Promise</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Promise</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">catch</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#88C0D0;">g</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">error</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">E</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Promise</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Promise</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">U</span><span style="color:#ECEFF4;">&gt;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">readFilePromise</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Promise</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Promise</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">resolve</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">reject</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">result</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                </span><span style="color:#88C0D0;">reject</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">else</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                </span><span style="color:#88C0D0;">resolve</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">result</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_8-4-async和await" tabindex="-1"><a class="header-anchor" href="#_8-4-async和await" aria-hidden="true">#</a> 8.4 async和await</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">async</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">getUser</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">try</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">user</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">await</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">getUserID</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">18</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">info</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">got location</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">user</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">finally</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">info</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">done getting location</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_8-5-异步流" tabindex="-1"><a class="header-anchor" href="#_8-5-异步流" aria-hidden="true">#</a> 8.5 异步流</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Events</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    ready</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    error</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Error</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    reconnecting</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> attempt</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> delay</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">RedisClient</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">on</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">E</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">keyof</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Events</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">event</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">E</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">arg</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Events</span><span style="color:#D8DEE9FF;">[</span><span style="color:#8FBCBB;">E</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_8-6-多线程类型安全" tabindex="-1"><a class="header-anchor" href="#_8-6-多线程类型安全" aria-hidden="true">#</a> 8.6 多线程类型安全</h3><h4 id="_8-6-1-在浏览器中-使用web职程-worker" tabindex="-1"><a class="header-anchor" href="#_8-6-1-在浏览器中-使用web职程-worker" aria-hidden="true">#</a> 8.6.1 在浏览器中：使用Web职程（worker）</h4><p>Promise和setTimeout等异步API是并发运行代码。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Message</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">ThreadID</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Participants</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span><span style="color:#D8DEE9FF;">[]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Commands</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    sendMessageToThread</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">ThreadID</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Message</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    createThread</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">Participants</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    addUserToThread</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">ThreadID</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    removeUserFromThread</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">ThreadID</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Events</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    receivedMessage</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">ThreadID</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Message</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    createdThread</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">ThreadID</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Participants</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    addedUserToThread</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">ThreadID</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    removeUserFromThread</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#8FBCBB;">ThreadID</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">UserID</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">SafeEmitter</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Events</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Record</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">PropertyKey</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">unknown</span><span style="color:#D8DEE9FF;">[]</span><span style="color:#ECEFF4;">&gt;&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">private</span><span style="color:#D8DEE9FF;"> emitter </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">EventEmitter</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">emit</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">K</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">keyof</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Events</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">channel</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">data</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Events</span><span style="color:#D8DEE9FF;">[</span><span style="color:#8FBCBB;">K</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">emitter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">emit</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">channel</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">on</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">K</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">extends</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">keyof</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Events</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">channel</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">K</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">listener</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">data</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Events</span><span style="color:#D8DEE9FF;">[</span><span style="color:#8FBCBB;">K</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">void</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">emitter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">channel</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">listener</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 监听主线程发来的事件</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">commandEmitter</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">SafeEmitter</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Commands</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 把事件发射回主线程</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">eventEmitter</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">new</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">SafeEmitter</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Events</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">onmessage</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">command</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">commandEmitter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">emit</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">command</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">type</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">...</span><span style="color:#D8DEE9;">command</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">eventEmitter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">receivedMessage</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">postMessage</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">type</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">receivedMessage</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h4 id="_8-6-2-在nodejs中-使用子进程" tabindex="-1"><a class="header-anchor" href="#_8-6-2-在nodejs中-使用子进程" aria-hidden="true">#</a> 8.6.2 在NodeJS中：使用子进程</h4><p><code>fork()</code>方法。</p><h2 id="第9章-前后端框架" tabindex="-1"><a class="header-anchor" href="#第9章-前后端框架" aria-hidden="true">#</a> 第9章 前后端框架</h2><h3 id="_9-1-前端框架" tabindex="-1"><a class="header-anchor" href="#_9-1-前端框架" aria-hidden="true">#</a> 9.1 前端框架</h3><p><code>{ &quot;complierOptions&quot;: { &quot;lib&quot;: [&quot;dom&quot;, &quot;es2015&quot;] } }</code>。配置使用DOM API。</p><blockquote><p>lib选项仅仅是让TypeScript在处理项目的代码时引入一组指定的类型声明，不产生额外的代码。</p></blockquote><h4 id="_9-1-1-react" tabindex="-1"><a class="header-anchor" href="#_9-1-1-react" aria-hidden="true">#</a> 9.1.1 React</h4><h4 id="_9-1-2-angular-6-7" tabindex="-1"><a class="header-anchor" href="#_9-1-2-angular-6-7" aria-hidden="true">#</a> 9.1.2 Angular 6/7</h4><h3 id="_9-2-类型安全的api" tabindex="-1"><a class="header-anchor" href="#_9-2-类型安全的api" aria-hidden="true">#</a> 9.2 类型安全的API</h3><p>可以使用由代码生成的带类型信息的API。</p><ul><li>针对REST式API的Swagger。</li><li>针对GraphQL的Apollo。</li><li>针对RPC的gRPC和APache Thrift。</li></ul><h3 id="_9-3-后端框架" tabindex="-1"><a class="header-anchor" href="#_9-3-后端框架" aria-hidden="true">#</a> 9.3 后端框架</h3><p>对象关系器（ORM）根据数据库模式生成代码，提供的是高层API，可以执行查询、更新、删除等操作。</p><p>通过TypeScript访问数据库，建议使用ORM。</p><h2 id="第10章-命名空间和模块" tabindex="-1"><a class="header-anchor" href="#第10章-命名空间和模块" aria-hidden="true">#</a> 第10章 命名空间和模块</h2><h3 id="_10-1-javascript模块简史" tabindex="-1"><a class="header-anchor" href="#_10-1-javascript模块简史" aria-hidden="true">#</a> 10.1 JavaScript模块简史</h3><p>Dojo、YUI和LABjs =&gt; CommonJS、AMD =&gt; ES Module</p><h3 id="_10-2-import、export" tabindex="-1"><a class="header-anchor" href="#_10-2-import、export" aria-hidden="true">#</a> 10.2 import、export</h3><p>在TypeScript中应该使用ES2015的import和export句法。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">X</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span></span>
<span class="line"><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">X</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> t</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_10-2-1-动态导入" tabindex="-1"><a class="header-anchor" href="#_10-2-1-动态导入" aria-hidden="true">#</a> 10.2.1 动态导入</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">locale</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">await</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">import</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">locale_us-en</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>TypeScript仅在esnext模块模式下支持动态导入。配置<code>{&quot;module&quot;: &quot;esnext&quot;}</code>。</p></blockquote><h4 id="_10-2-2-使用commonjs和amd模块" tabindex="-1"><a class="header-anchor" href="#_10-2-2-使用commonjs和amd模块" aria-hidden="true">#</a> 10.2.2 使用CommonJS和AMD模块</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">fs</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">from</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">some/file.txt</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_10-2-3-模块模式与脚本模式" tabindex="-1"><a class="header-anchor" href="#_10-2-3-模块模式与脚本模式" aria-hidden="true">#</a> 10.2.3 模块模式与脚本模式</h4><p>TypeScript采用两种模式编译TypeScript文件：模块模式和脚本模式。如果文件中有import或export语句就是模块模式，否则是脚本模式。</p><p>下述情况使用脚本模式：</p><ul><li>快速验证不打算编译成任何模块系统的浏览器代码（<code>{&quot;module&quot;: &quot;none&quot;}</code>），在HMTL文件中直接使用<code>&lt;script /&gt;</code>标签引入。</li><li>创建类型声明。</li></ul><blockquote><p>建议在使用TypeScript编写代码时始终使用模块模式。</p></blockquote><h3 id="_10-3-命名空间" tabindex="-1"><a class="header-anchor" href="#_10-3-命名空间" aria-hidden="true">#</a> 10.3 命名空间</h3><p>TypeScript提供了另一种封装代码的方式：<code>namespace</code>关键字。</p><blockquote><p>如果不知道使用命名空间还是模块模式，使用模块模式准没错。</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">namespace</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Network</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;(</span><span style="color:#D8DEE9;">url</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">Promise</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">T</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">        </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">namespace</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">HTTP</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">namespace</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">TCP</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">namespace</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">App</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">Network</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">string</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">https://chenzilin.cn/api/v1/login</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_10-3-1-冲突" tabindex="-1"><a class="header-anchor" href="#_10-3-1-冲突" aria-hidden="true">#</a> 10.3.1 冲突</h4><p>导出相同的命名空间会导致冲突。改进函数类型时对外函数声明的重载不导致冲突。</p><h4 id="_10-3-2-编译输出" tabindex="-1"><a class="header-anchor" href="#_10-3-2-编译输出" aria-hidden="true">#</a> 10.3.2 编译输出</h4><p>命名空间不遵守tsconfig.json中的module设置。</p><blockquote><p>模块优于命名空间。</p></blockquote><h3 id="_10-4-声明合并" tabindex="-1"><a class="header-anchor" href="#_10-4-声明合并" aria-hidden="true">#</a> 10.4 声明合并</h3><p>TypeScript的三种合并：</p><ul><li>合并值和类型。</li><li>多个命名空间合并成一个。</li><li>多个接口合并成一个。</li></ul><p><strong>声明可以合并吗？</strong><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/2lyyTg.jpg" alt="2lyyTg.jpg"></p><p>如果导入的文件没有拓展名，会依次寻找.ts、.tsx、.d.ts和.js的文件。</p><h2 id="第11章-与javascript互操作" tabindex="-1"><a class="header-anchor" href="#第11章-与javascript互操作" aria-hidden="true">#</a> 第11章 与JavaScript互操作</h2><h3 id="_11-1-类型声明" tabindex="-1"><a class="header-anchor" href="#_11-1-类型声明" aria-hidden="true">#</a> 11.1 类型声明</h3><p>类型声明文件的扩展名为<code>.d.ts</code>。</p><p>类型声明的句法与常规的TypeScript代码类型类似，但也有几点区别：</p><ul><li>类型声明只能包含类型，不能有值。这意味着，类型声明不能实现函数、类、对象或变量，参数也不能有默认值。</li><li>类型声明虽然不能定义值，但是可以声明JavaScript代码中定义了某个值。使用特殊的<code>declare</code>关键字（<code>declare</code>可以理解为一种断言，“我发誓，我写得JavaScript代码导出了这个类型的类。”）</li><li>类型声明只声明使用方可见的类型。如果某些代码不导出，或者是函数体内的局部变量，则不为其声明类型。</li></ul><p>类型声明文件有以下几个作用：</p><ul><li>其他人在他们的TypeScript应用中使用你提供的编译好的TypeScript代码时，TSC会寻找与生成的JavaScript文件对应的.d.ts文件，让TypeScript知道项目中涉及哪些类型。</li><li>支持TypeScript的代码编辑器会读取.d.ts文件，在输入代码的过程中显示有用的类型提示。</li><li>由于无须重新编译TypeScript代码，能极大地减少编译时间。</li></ul><p>类型声明描述的是外参环境，与包含值的常规声明要区分开。外参变量声明使用<code>declare</code>声明JavaScript文件中定义了某个变量，而常规的变量声明使用let或const关键字声明。</p><p>借助类型声明可以做到以下几件事：</p><ul><li>告诉TypeScript，JavaScript文件中定义了某个全局变量。</li><li>定义在项目中任何地方都可以使用的全局类型，无须导入就能使用（外参类型声明）。</li><li>描述通过NPM安装的第三方模块（外参模块声明）。</li></ul><p>按约定，如果有对应的<code>.js</code>文件，类型声明文件使用<code>.d.ts</code>扩展名；否则，使用<code>.ts</code>拓展名。</p><p><strong>在类型声明文件中，顶层值要使用<code>declare</code>关键字（declare let、declare function、decare class等），而顶层类型和接口则不需要。</strong></p><h4 id="_11-1-1-外参变量声明" tabindex="-1"><a class="header-anchor" href="#_11-1-1-外参变量声明" aria-hidden="true">#</a> 11.1.1 外参变量声明</h4><p>外参变量声明让TypeScript知道全局变量的存在，无须显示导入即可在项目中的任何.ts或.d.ts文件中使用。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">declare</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">process</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    env</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        NODE_ENV</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">development</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">production</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">process</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#D8DEE9;">env</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#D8DEE9;">NODE_ENV</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">development</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>TSC设置： lib</p><p>lib字段可以引入内置的类型声明。</p></blockquote><h4 id="_11-1-2-外参类型声明" tabindex="-1"><a class="header-anchor" href="#_11-1-2-外参类型声明" aria-hidden="true">#</a> 11.1.2 外参类型声明</h4><p>外参类型声明保存在脚本模式下的.ts或.d.ts文件中，无须显式导入即可在项目中的其他文件里全局使用。</p><h4 id="_11-1-3-外参模块声明" tabindex="-1"><a class="header-anchor" href="#_11-1-3-外参模块声明" aria-hidden="true">#</a> 11.1.3 外参模块声明</h4><p>把常规的类型声明放在特殊的句法declare module中：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// &#39;module-name&#39;是import导入的路径</span></span>
<span class="line"><span style="color:#81A1C1;">declare</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">module</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">module-name</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyType</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyDefaultType</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9FF;"> a</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">string</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">myExport</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyType</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">myDefaultType</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">MyDefaultType</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">default</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">myDefaultType</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 声明一个可被导入的模块，但是导入的类型为any</span></span>
<span class="line"><span style="color:#81A1C1;">declare</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">module</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">unsafe-module-name</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 为webpack的style-loader导入的css文件声明类型</span></span>
<span class="line"><span style="color:#81A1C1;">declare</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">module</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">*.css</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">css</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">CSSRuleList</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">default</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">css</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_11-2-逐步从javascript迁移到typescript" tabindex="-1"><a class="header-anchor" href="#_11-2-逐步从javascript迁移到typescript" aria-hidden="true">#</a> 11.2 逐步从JavaScript迁移到TypeScript</h3><h4 id="_11-2-1-第一步-添加tsc" tabindex="-1"><a class="header-anchor" href="#_11-2-1-第一步-添加tsc" aria-hidden="true">#</a> 11.2.1 第一步：添加TSC</h4><div class="language-json ext-json line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">compilerOptions</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">allowJs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>设置之后，TSC就能编译JavaScript文件了。</p><h4 id="_11-2-2-第二步-上-对javascript代码做类型检查-可选" tabindex="-1"><a class="header-anchor" href="#_11-2-2-第二步-上-对javascript代码做类型检查-可选" aria-hidden="true">#</a> 11.2.2 第二步（上）：对JavaScript代码做类型检查（可选）</h4><div class="language-json ext-json line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">compilerOptions</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">checkJs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>设置之后，TypeScript编译JavaScript文件时会尽量推导类型，并做类型检查。</p><p><code>// @ts-check</code>，一次只检查一个JavaScript文件。<code>// ts-nocheck</code>，不进行检测。</p><h4 id="_11-2-3-第二步-下-添加jsdoc注解-可选" tabindex="-1"><a class="header-anchor" href="#_11-2-3-第二步-下-添加jsdoc注解-可选" aria-hidden="true">#</a> 11.2.3 第二步（下）：添加JSDoc注解（可选）</h4><p>TypeScript能读懂JSDoc，会把JSDoc当成类型检查器的输入。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;"> * </span></span>
<span class="line"><span style="color:#616E88;"> * </span><span style="color:#ECEFF4;">@</span><span style="color:#8FBCBB;">param</span><span style="color:#616E88;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#616E88;">string</span><span style="color:#ECEFF4;">}</span><span style="color:#616E88;"> </span><span style="color:#D8DEE9;">word</span><span style="color:#616E88;"> - An input string to convert</span></span>
<span class="line"><span style="color:#616E88;"> * </span><span style="color:#ECEFF4;">@</span><span style="color:#8FBCBB;">returns</span><span style="color:#616E88;"> </span><span style="color:#ECEFF4;">{</span><span style="color:#616E88;">string</span><span style="color:#ECEFF4;">}</span><span style="color:#616E88;"> The string in PascalCase</span></span>
<span class="line"><span style="color:#616E88;"> */</span></span>
<span class="line"><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">function</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">toPascalCase</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">word</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">word</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">replace</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">/</span><span style="color:#EBCB8B;">\w</span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;">/</span><span style="color:#81A1C1;">g</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_11-2-4-第三步-把文件重命名为-ts" tabindex="-1"><a class="header-anchor" href="#_11-2-4-第三步-把文件重命名为-ts" aria-hidden="true">#</a> 11.2.4 第三步：把文件重命名为.ts</h4><ol><li>根治法。</li><li>快速法。</li></ol><h4 id="_11-2-5-第四步-严格要求" tabindex="-1"><a class="header-anchor" href="#_11-2-5-第四步-严格要求" aria-hidden="true">#</a> 11.2.5 第四步：严格要求</h4><p>为所有ts文件开启TSC。</p><h3 id="_11-3-寻找javascript代码的类型信息" tabindex="-1"><a class="header-anchor" href="#_11-3-寻找javascript代码的类型信息" aria-hidden="true">#</a> 11.3 寻找JavaScript代码的类型信息</h3><p>在TypeScript文件中导入JavaScript文件，TypeScript按照下述算法查找JavaScript代码的类型声明：</p><ol><li>在同一级目录中寻找与<code>.js</code>文件同名的<code>.d.ts</code>文件。如果存在则把该文件用作<code>.js</code>文件的类型声明。</li><li>如果不存在这样的文件，而且allowJs和checkJs的值为true，推导<code>.js</code>文件的类型信息（由<code>.js</code>文件中的JSDoc注解得出）。</li><li>如果无法推导，把整个模块视作<code>any</code>。</li></ol><p>导入第三方模块JavaScript模块时，TypeScript使用的算法稍有不同：</p><ol><li>在本地寻找模块的类型声明，找到就用。</li><li>如果在本地找不到，再分析模块的<code>packag.json</code>。如果该文件中定义了名为<code>types</code>或<code>typings</code>的字段，使用字段设置的<code>.d.ts</code>文件做为模块的类型声明源。</li><li>如果没有上述字段，沿着目录结构逐级向上，寻找<code>node_modules/@types</code>文件夹，看看其中有没有模块的类型声明。</li><li>如果依然找不到类型声明，按照前面针对本地算法的1-3步查找。</li></ol><blockquote><p>TSC设置：types和typeRoots</p><p>typeRoots把值设为一个文件夹路径组成的数组，可以让TypeScript在这些文件夹中寻找类型声明，<code>&quot;typeRoots&quot;: [&quot;./typings&quot;, &quot;./node_modules/@types&quot;]</code>。</p><p>如果想更为细致地控制，types选项指定希望TypeScript寻找哪个包的类型。<code>&quot;types&quot;: [&quot;react&quot;]</code>。</p></blockquote><h3 id="_11-4-使用第三方javascript" tabindex="-1"><a class="header-anchor" href="#_11-4-使用第三方javascript" aria-hidden="true">#</a> 11.4 使用第三方JavaScript</h3><h4 id="_11-4-1-自带类型声明的javascript" tabindex="-1"><a class="header-anchor" href="#_11-4-1-自带类型声明的javascript" aria-hidden="true">#</a> 11.4.1 自带类型声明的JavaScript</h4><h4 id="_11-4-2-definitelytyped中有类型声明的javascript" tabindex="-1"><a class="header-anchor" href="#_11-4-2-definitelytyped中有类型声明的javascript" aria-hidden="true">#</a> 11.4.2 DefinitelyTyped中有类型声明的JavaScript</h4><p>可以在TypeSearch中搜索是否有为该模块提供外参模块声明。</p><h4 id="_11-4-3-definitelytyped中没有类型声明的javascript" tabindex="-1"><a class="header-anchor" href="#_11-4-3-definitelytyped中没有类型声明的javascript" aria-hidden="true">#</a> 11.4.3 DefinitelyTyped中没有类型声明的JavaScript</h4><p>解决方案：</p><ol><li>在导入的文件中加上<code>// @ts-ignore</code>指令，把该文件加入白名单。</li><li>把对该模块的使用加入白名单<code>declare module &#39;xxx&#39;</code>。</li><li>自己编写外参模块声明。</li><li>自己编写类型声明，并且发布到NPM中。</li></ol><h2 id="第12章-构建和运行typescript" tabindex="-1"><a class="header-anchor" href="#第12章-构建和运行typescript" aria-hidden="true">#</a> 第12章 构建和运行TypeScript</h2><h4 id="_12-1-1-项目结构" tabindex="-1"><a class="header-anchor" href="#_12-1-1-项目结构" aria-hidden="true">#</a> 12.1.1 项目结构</h4><p>源码放src目录，编译结果放dist目录。</p><h4 id="_12-1-2-构建产物" tabindex="-1"><a class="header-anchor" href="#_12-1-2-构建产物" aria-hidden="true">#</a> 12.1.2 构建产物</h4><p>TSC生成的构建产物</p><table><thead><tr><th>文件种类</th><th>拓展名</th><th>tsconfig.json标志</th><th>默认生成</th></tr></thead><tbody><tr><td>JavaScript</td><td>.js</td><td><code>{&quot;emitDeclarationOnly&quot;: false}</code></td><td>是</td></tr><tr><td>源码映射</td><td>.js.map</td><td><code>{&quot;sourceMap&quot;: true}</code></td><td>否</td></tr><tr><td>类型声明</td><td>.d.ts</td><td><code>{&quot;declaration&quot;: true}</code></td><td>否</td></tr><tr><td>声明映射</td><td>.d.ts.map</td><td><code>{&quot;declarationMap&quot;: true}</code></td><td>否</td></tr></tbody></table><h4 id="_12-1-3-设置编译目标" tabindex="-1"><a class="header-anchor" href="#_12-1-3-设置编译目标" aria-hidden="true">#</a> 12.1.3 设置编译目标</h4><p>TSC能把多数JavaScript特性转译成旧环境支持的版本，但是没有为缺少的特性提供实现。</p><ul><li>target设定把代码转译成哪个JavaScript版本：es5、es2015等。</li><li>module设定想使用的模块系统：es2015模块、commonjs模块、systemjs模块等。</li><li>lib告诉TypeScript，目标环境支持哪些JavaScript特性：es5特性、es2015特性、dom等。</li></ul><blockquote><p>有些JavaScript特性先由TypeScript支持，而后才在某个JavaScript版本中定案，我们把这样的特性称为“ESNext”。</p></blockquote><h5 id="target" tabindex="-1"><a class="header-anchor" href="#target" aria-hidden="true">#</a> target</h5><p>字段值：es3、es5（如不确定使用这个默认值）、es6或es2015、es2016、es2017、es2018、esnext。</p><h5 id="lib" tabindex="-1"><a class="header-anchor" href="#lib" aria-hidden="true">#</a> lib</h5><p>如果目标环境不支持较新的标准库特性，还要借助腻子脚本提供具体实现。</p><p>我们可以从流行的腻子脚本库中安装，例如core-js或者使用Babel运行通过类型检查的TypeScript代码，让@babel/polyfill自动添加腻子脚本。</p><h4 id="_12-1-5-生成源码映射" tabindex="-1"><a class="header-anchor" href="#_12-1-5-生成源码映射" aria-hidden="true">#</a> 12.1.5 生成源码映射</h4><p>建议在开发环境中使用源码映射。</p><h4 id="_12-1-5-项目引用" tabindex="-1"><a class="header-anchor" href="#_12-1-5-项目引用" aria-hidden="true">#</a> 12.1.5 项目引用</h4><p>如果项目中有上百个文件，那就推荐要使用项目引用。</p><p>项目引用的用法如下：</p><ol><li><p>把一个TypeScript项目分成多个子项目。一个子项目放在一个文件夹中，该文件夹中有一个tsconfig.json文件和一些TypeScript文件。拆分项目时，应该把可能一起更新的代码放在同一个文件夹中。</p></li><li><p>在各个子项目的文件夹中创建一个tsconfig.json文件，写入下述内容：</p><div class="language-json ext-json line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">compilerOptions</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">composite</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 告诉TSC，这个文件夹是一个大型TypeScript项目的子项目。</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">declareation</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 为这个子项目生成.d.ts声明文件。子项目可以访问各子项目的声明文件和生成的JavaScript，但是不能访问TypeScript源文件。这个行为是项目引用在重新构建大型项目时用时较少的关键。</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">declarationMap</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 为生产的类型声明构建源码映射。</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">rootDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 指明该子项目应该相对根目录（.)编译。</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">},</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">include</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">[</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./**/*.ts</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">],</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">references</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// 在一个数组中列出该子项目依赖的其他子项目。每个引用的path字段要指向一个内有tsconfig.json文件。</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">../myReferencedProject</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">prepend</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li><li><p>在根文件夹中创建一个tsconfig.json文件，引用没有被其他子项目引用的子项目。</p></li><li><p>使用TSC编译项目时，通过build标志让TSC把项目引用考虑进来：<code>tsc --build # 或者简写为tsc -b </code></p></li></ol><blockquote><p>使用extends减少tsconfig.json中的样板代码量</p><p>使用extends选项扩展：</p><div class="language-json ext-json line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">extend</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">../tsconfig.base</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">include</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">[</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./**/*.ts</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">],</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">references</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9;">...</span><span style="color:#ECEFF4;">]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></blockquote><h4 id="_12-1-6-监控错误" tabindex="-1"><a class="header-anchor" href="#_12-1-6-监控错误" aria-hidden="true">#</a> 12.1.6 监控错误</h4><p>若想报告和整理运行时异常，可以使用Sentry和Bugsnag等错误监控工具。</p><h3 id="_12-2-在服务器中运行typescript" tabindex="-1"><a class="header-anchor" href="#_12-2-在服务器中运行typescript" aria-hidden="true">#</a> 12.2 在服务器中运行TypeScript</h3><p>若想在NodeJS环境中运行TypeScript代码，把代码编译成ES2015 JavaScript，并在tsconfig.json文件中，把module字段设为commonjs：</p><div class="language-json ext-json line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">compilerOptions</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">target</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">es2015</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">module</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">commonjs</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  </span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ES2015中的import和export调用将分别被编译成require和module.exports，无须进一步打包就能在NodeJS中运行。</p><p>如果想使用源码映射，source-map-support包可以把源码映射提供给NodeJS进程。</p><h3 id="_12-3-在浏览器中运行typescript" tabindex="-1"><a class="header-anchor" href="#_12-3-在浏览器中运行typescript" aria-hidden="true">#</a> 12.3 在浏览器中运行TypeScript</h3><p>如果发布一个库，供他人使用，应该始终使用umd，以便最大程度上兼容各人在自己的项目中使用的不同的模块打包工具。</p><ul><li>如果使用webpack或rollup，把module设为<code>es2015</code>或更高的版本。</li><li>如果代码中用到了动态导入，把module设为<code>esnext</code>。</li><li>如果构建供其他项目使用的库，而且经过tsc处理之后没有再通过额外的构建步骤处理，为了最大程度上兼容各种加载器，把module设为<code>umd</code>。</li><li>如果使用CommonJS打包工具，把module设为<code>commonjs</code>。</li><li>如果打算使用RequireJS或其他AMD模块加载器加载代码，把module设为<code>amd</code>。</li><li>如果希望导出的顶级代码可在window对象上全局使用，把module设为<code>none</code>。</li></ul><p>拥有TypeScript插件的构建工具：</p><ul><li>Webpack的ts-loader。</li><li>Browserify的tsify。</li><li>Babel的@babel/preset-typescript。</li><li>Gulp的gulp-typescript。</li><li>Grunt的grunt-ts。</li></ul><h3 id="_12-4-把typescript代码发布到npm中" tabindex="-1"><a class="header-anchor" href="#_12-4-把typescript代码发布到npm中" aria-hidden="true">#</a> 12.4 把TypeScript代码发布到NPM中</h3><p>如果是编译成供他人使用的JavaScript，有几点最佳实践要牢记于心：</p><ul><li>生成源码映射，以便调试自己的代码。</li><li>编译为ES5，让其他人能轻易构建并运行你的代码。</li><li>审慎选择编译为哪种模块格式（UMD、CommonJS、ES2015等）。</li><li>生成类型声明，让其他TypeScript用户知晓你的代码中有哪些类型。</li></ul><blockquote><p>.npmignore 忽略上次到npm的文件。</p></blockquote><h3 id="_12-5-三斜线指令" tabindex="-1"><a class="header-anchor" href="#_12-5-三斜线指令" aria-hidden="true">#</a> 12.5 三斜线指令</h3><p>这种指令是格式特殊的TypeScript注释，作用是为TSC下达命令。</p><h2 id="附录a-类型运算符" tabindex="-1"><a class="header-anchor" href="#附录a-类型运算符" aria-hidden="true">#</a> 附录A 类型运算符</h2><table><thead><tr><th>类型运算符</th><th>句法</th><th>适用于</th></tr></thead><tbody><tr><td>类型查询</td><td>typeof、instanceof</td><td>任何类型</td></tr><tr><td>键</td><td>keyof</td><td>对象类型</td></tr><tr><td>属性查找</td><td>O[K]</td><td>对象类型</td></tr><tr><td>映射类型</td><td>[K in O]</td><td>对象类型</td></tr><tr><td>加修饰符</td><td>+</td><td>对象类型</td></tr><tr><td>减修饰符</td><td>-</td><td>对象类型</td></tr><tr><td>只读修饰符</td><td>readonly</td><td>对象类型、数组类型、元组类型</td></tr><tr><td>可选修饰符</td><td>?</td><td>对象类型、元组类型、函数的参数类型</td></tr><tr><td>条件类型</td><td>?</td><td>泛型、类型别名、函数的参数类型</td></tr><tr><td>非空断言</td><td>!</td><td>可能为空的类型</td></tr><tr><td>泛型参数的默认值</td><td>=</td><td>泛型</td></tr><tr><td>类型断言</td><td>as、&lt;&gt;</td><td>如何类型</td></tr><tr><td>类型防护</td><td>is</td><td>函数的返回类型</td></tr></tbody></table><h2 id="附录b-实用类型" tabindex="-1"><a class="header-anchor" href="#附录b-实用类型" aria-hidden="true">#</a> 附录B 实用类型</h2><p>实用类型列表参见es5.d.ts（http://bit.ly/2IOVe2U）。</p><h2 id="附录c-限定作用范围的声明" tabindex="-1"><a class="header-anchor" href="#附录c-限定作用范围的声明" aria-hidden="true">#</a> 附录C 限定作用范围的声明</h2><table><thead><tr><th>关键字</th><th>生成类型？</th><th>生成值？</th></tr></thead><tbody><tr><td>class</td><td>是</td><td>是</td></tr><tr><td>const、let、var</td><td>否</td><td>是</td></tr><tr><td>enum</td><td>是</td><td>是</td></tr><tr><td>function</td><td>否</td><td>是</td></tr><tr><td>interface</td><td>是</td><td>否</td></tr><tr><td>namespace</td><td>否</td><td>是</td></tr><tr><td>type</td><td>是</td><td>否</td></tr></tbody></table><h2 id="附录d-为第三方javascript模块编写声明文件的技巧" tabindex="-1"><a class="header-anchor" href="#附录d-为第三方javascript模块编写声明文件的技巧" aria-hidden="true">#</a> 附录D 为第三方JavaScript模块编写声明文件的技巧</h2><p>TypeScript声明及相应的类型声明</p><table><thead><tr><th>.ts</th><th>.d.ts</th></tr></thead><tbody><tr><td>var a = 1</td><td>declare var a: number</td></tr><tr><td>let a = 1</td><td>declare let a: number</td></tr><tr><td>const a = 1</td><td>declare const a: 1</td></tr><tr><td>function a(b) { return b.toFixed() }</td><td>declare function a(b:number): string</td></tr><tr><td>class A{ b() { return 3 } }</td><td>declare class A { b(): number }</td></tr><tr><td>namespace A {}</td><td>declare namespace A {}</td></tr><tr><td>type A = number</td><td>type A = number</td></tr><tr><td>Interface A { b?: string }</td><td>Interface A { b?: string }</td></tr></tbody></table><h3 id="d-1-导出的类型" tabindex="-1"><a class="header-anchor" href="#d-1-导出的类型" aria-hidden="true">#</a> D.1 导出的类型</h3><h4 id="d-1-1全局导出" tabindex="-1"><a class="header-anchor" href="#d-1-1全局导出" aria-hidden="true">#</a> D.1.1全局导出</h4><p>在变量、函数和类声明前面加上declare。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// 全局变量</span></span>
<span class="line"><span style="color:#81A1C1;">declare</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">someGlobal</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">GlobalType</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 全局类</span></span>
<span class="line"><span style="color:#81A1C1;">declare</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">GlobalClass</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 全局类型声明</span></span>
<span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">GlobalType</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="d-1-2-es2015导出" tabindex="-1"><a class="header-anchor" href="#d-1-2-es2015导出" aria-hidden="true">#</a> D.1.2 ES2015导出</h4><p>把declare替换为export即可：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#616E88;">// 默认导出</span></span>
<span class="line"><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">default</span><span style="color:#D8DEE9FF;"> </span><span style="color:#D8DEE9;">defaultExport</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 具名导出</span></span>
<span class="line"><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">class</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">SomeExport</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  a</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">SomeOtherType</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 类型导出</span></span>
<span class="line"><span style="color:#81A1C1;">export</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">SomeType</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  a</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">number</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="d-1-3-commonjs导出" tabindex="-1"><a class="header-anchor" href="#d-1-3-commonjs导出" aria-hidden="true">#</a> D.1.3 CommonJS导出</h4><p>第三方CommonJS模块的类型声明中只能有一个导出语句。若想导出更多东西，要利用声明合并行为。</p><h4 id="d-1-4-umd导出" tabindex="-1"><a class="header-anchor" href="#d-1-4-umd导出" aria-hidden="true">#</a> D.1.4 UMD导出</h4><p>UMD模块与ES2015基本一样，唯一区别是若想让模块在脚本模式下的文件中全局可用，要使用特殊的<code>export as namespace</code>句法。</p><p><code>export as namespace MyModule</code>。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: czl624824554@163.com">chenzilin</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/blog-site/assets/app.c4a25f51.js" defer></script>
  </body>
</html>
