<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.36">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/578220.jpg"><title>Leon Chen</title><meta name="description" content="">
    <link rel="modulepreload" href="/blogs/assets/app.7d2acf8d.js"><link rel="modulepreload" href="/blogs/assets/performanceAPI.html.aa9e1985.js"><link rel="modulepreload" href="/blogs/assets/performanceAPI.html.3fe49e1f.js"><link rel="modulepreload" href="/blogs/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/blogs/assets/style.fa95e7d7.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/blogs/" class=""><img class="logo" src="/blogs/images/578220.jpg" alt="Leon Chen"><span class="site-name can-hide">Leon Chen</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/blogs/program" class="" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blogs/promote" class="" aria-label="课外提升"><!--[--><!--]--> 课外提升 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blogs/questions" class="router-link-active" aria-label="疑问清单"><!--[--><!--]--> 疑问清单 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/blogs/program" class="" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blogs/promote" class="" aria-label="课外提升"><!--[--><!--]--> 课外提升 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blogs/questions" class="router-link-active" aria-label="疑问清单"><!--[--><!--]--> 疑问清单 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading"> <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#overview" class="router-link-active router-link-exact-active sidebar-item" aria-label="Overview"><!--[--><!--]--> Overview <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#attributes" class="router-link-active router-link-exact-active sidebar-item" aria-label="Attributes"><!--[--><!--]--> Attributes <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#timing" class="router-link-active router-link-exact-active sidebar-item" aria-label="timing"><!--[--><!--]--> timing <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#navigation" class="router-link-active router-link-exact-active sidebar-item" aria-label="navigation"><!--[--><!--]--> navigation <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#memory" class="router-link-active router-link-exact-active sidebar-item" aria-label="memory"><!--[--><!--]--> memory <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#methods" class="router-link-active router-link-exact-active sidebar-item" aria-label="Methods"><!--[--><!--]--> Methods <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#getentries" class="router-link-active router-link-exact-active sidebar-item" aria-label="getEntries()"><!--[--><!--]--> getEntries() <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#getentriesbyname-name-type-optional-getentriesbytype-type" class="router-link-active router-link-exact-active sidebar-item" aria-label="getEntriesByName(name,type[optional])，getEntriesByType(type)"><!--[--><!--]--> getEntriesByName(name,type[optional])，getEntriesByType(type) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#clearresourcetimings" class="router-link-active router-link-exact-active sidebar-item" aria-label="clearResourceTimings()"><!--[--><!--]--> clearResourceTimings() <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#mark-name-measure-name-startmark-endmark-clearmarks-clearmeasures" class="router-link-active router-link-exact-active sidebar-item" aria-label="mark(name), measure(name, startMark, endMark), clearMarks(), clearMeasures()"><!--[--><!--]--> mark(name), measure(name, startMark, endMark), clearMarks(), clearMeasures() <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blogs/questions/Performance/performanceAPI.html#now" class="router-link-active router-link-exact-active sidebar-item" aria-label="now()"><!--[--><!--]--> now() <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview" aria-hidden="true">#</a> Overview</h2><p><strong><code>Performance</code></strong> 接口可以获取到当前页面中与性能相关的信息。</p><p>该类型的对象可以通过调用只读属性 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/performance_property" target="_blank" rel="noopener noreferrer"><code>Window.performance</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 来获得。</p><h2 id="attributes" tabindex="-1"><a class="header-anchor" href="#attributes" aria-hidden="true">#</a> Attributes</h2><p><em><code>Performance</code> 接口没有继承任何属性。</em></p><h3 id="timing" tabindex="-1"><a class="header-anchor" href="#timing" aria-hidden="true">#</a> timing</h3><p>包含延迟相关的性能信息。从输入url到用户可以使用页面的全过程时间统计，会返回一个PerformanceTiming对象，单位均为毫秒</p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/2022_03_13_xmP1B8.png" alt="2022_03_13_xmP1B8"></p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/2022_03_13_de600p.jpg" alt="2022_03_13_de600p"></p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/2022_03_13_lOGf5n.png" alt="2022_03_13_lOGf5n"></p><p>按触发顺序排列所有属性：</p><ul><li><p><code>navigationStart</code>:在同一个浏览器上下文中，前一个网页（与当前页面不一定同域）unload 的时间戳，如果无前一个网页 unload ，则与 fetchStart 值相等。</p></li><li><p><code>unloadEventStart</code>:前一个网页（与当前页面同域）unload 的时间戳，如果无前一个网页 unload 或者前一个网页与当前页面不同域，则值为 0。</p></li><li><p><code>unloadEventEnd</code>:和 unloadEventStart 相对应，返回前一个网页 unload 事件绑定的回调函数执行完毕的时间戳。</p></li><li><p><code>redirectStart</code>:第一个 HTTP 重定向发生时的时间。有跳转且是同域名内的重定向才算，否则值为 0。</p></li><li><p><code>redirectEnd</code>:最后一个 HTTP 重定向完成时的时间。有跳转且是同域名内的重定向才算，否则值为 0。</p></li><li><p><code>fetchStart</code>:浏览器准备好使用 HTTP 请求抓取文档的时间，这发生在检查本地缓存之前。</p></li><li><p><code>domainLookupStart</code>:DNS 域名查询开始的时间，如果使用了本地缓存（即无 DNS 查询）或持久连接，则与 fetchStart 值相等。</p></li><li><p><code>domainLookupEnd</code>:DNS 域名查询完成的时间，如果使用了本地缓存（即无 DNS 查询）或持久连接，则与 fetchStart 值相等。</p></li><li><p><code>connectStart</code>:HTTP（TCP） 开始建立连接的时间，如果是持久连接，则与 fetchStart 值相等,如果在传输层发生了错误且重新建立连接，则这里显示的是新建立的连接开始的时间。</p></li><li><p><code>connectEnd</code>:HTTP（TCP） 完成建立连接的时间（完成握手），如果是持久连接，则与 fetchStart 值相等,如果在传输层发生了错误且重新建立连接，则这里显示的是新建立的连接完成的时间。</p><p>**注意:**这里握手结束，包括安全连接建立完成、SOCKS 授权通过。</p></li><li><p><code>secureConnectionStart</code>:HTTPS 连接开始的时间，如果不是安全连接，则值为 0。</p></li><li><p><code>requestStart</code>:HTTP 请求读取真实文档开始的时间（完成建立连接），包括从本地读取缓存,连接错误重连时，这里显示的也是新建立连接的时间。</p></li><li><p><code>responseStart</code>:HTTP 开始接收响应的时间（获取到第一个字节），包括从本地读取缓存。</p></li><li><p><code>responseEnd</code>:HTTP 响应全部接收完成的时间（获取到最后一个字节），包括从本地读取缓存。</p></li><li><p><code>domLoading</code>:开始解析渲染 DOM 树的时间，此时 Document.readyState 变为 loading，并将抛出 readystatechange 相关事件。</p></li><li><p><code>domInteractive</code>:完成解析 DOM 树的时间，Document.readyState 变为 interactive，并将抛出 readystatechange 相关事件。</p><p>**注意:**只是 DOM 树解析完成，这时候并没有开始加载网页内的资源。</p></li><li><p><code>domContentLoadedEventStart</code>:DOM 解析完成后，网页内资源加载开始的时间,文档发生 DOMContentLoaded事件的时间。</p></li><li><p><code>domContentLoadedEventEnd</code>:DOM 解析完成后，网页内资源加载完成的时间（如 JS 脚本加载执行完毕），文档的DOMContentLoaded 事件的结束时间。</p></li><li><p><code>domComplete</code>:DOM 树解析完成，且资源也准备就绪的时间，Document.readyState 变为 complete，并将抛出 readystatechange 相关事件。</p></li><li><p><code>loadEventStart</code>:load 事件发送给文档，也即 load 回调函数开始执行的时间。</p></li><li><p><code>loadEventEnd</code>:load 事件的回调函数执行完毕的时间。</p></li></ul><p><strong>常用计算：</strong></p><ul><li>DNS查询耗时 ：domainLookupEnd - domainLookupStart</li><li>TCP链接耗时 ：connectEnd - connectStart</li><li>request请求耗时 ：responseEnd - requestStart</li><li>解析dom树耗时 ： domComplete - domInteractive</li><li>白屏时间 ：responseStart - navigationStart</li><li>domready时间(用户可操作时间节点) ：domContentLoadedEventEnd - navigationStart</li><li>onload时间(总下载时间) ：loadEventEnd - navigationStart</li></ul><h3 id="navigation" tabindex="-1"><a class="header-anchor" href="#navigation" aria-hidden="true">#</a> navigation</h3><p>旨在告诉开发者当前页面是通过什么方式导航过来的，只有两个属性：<code>type</code>，<code>redirectCount</code>。</p><p>**type:**标志页面导航类型,值如下表：</p><table><thead><tr><th>type常数</th><th>枚举值</th><th>描述</th></tr></thead><tbody><tr><td>TYPE_NAVIGATE</td><td>0</td><td>普通进入，包括：点击链接、在地址栏中输入 URL、表单提交、或者通过除下表中 TYPE_RELOAD 和 TYPE_BACK_FORWARD 的方式初始化脚本。</td></tr><tr><td>TYPE_RELOAD</td><td>1</td><td>通过刷新进入，包括：浏览器的刷新按钮、快捷键刷新、location.reload()等方法。</td></tr><tr><td>TYPE_BACK_FORWARD</td><td>2</td><td>通过操作历史记录进入，包括：浏览器的前进后退按钮、快捷键操作、history.forward()、history.back()、history.go(num)。</td></tr><tr><td>TYPE_UNDEFINED</td><td>255</td><td>其他非以上类型的方式进入。</td></tr></tbody></table><p>**redirectCount:**表示到达最终页面前，重定向的次数，但是这个接口有同源策略限制，即仅能检测同源的重定向。</p><blockquote><p>**注意：**所有前端模拟的重定向都无法统计到，因为不属于HTTP重定向</p></blockquote><h3 id="memory" tabindex="-1"><a class="header-anchor" href="#memory" aria-hidden="true">#</a> memory</h3><p>描述内存多少，是在Chrome中添加的一个非标准属性。</p><ul><li><code>jsHeapSizeLimit</code>: 内存大小限制</li><li><code>totalJSHeapSize</code>: 可使用的内存</li><li><code>usedJSHeapSize</code>: JS对象(包括V8引擎内部对象)占用的内存，不能大于totalJSHeapSize，如果大于，有可能出现了内存泄漏。</li></ul><h2 id="methods" tabindex="-1"><a class="header-anchor" href="#methods" aria-hidden="true">#</a> Methods</h2><h3 id="getentries" tabindex="-1"><a class="header-anchor" href="#getentries" aria-hidden="true">#</a> getEntries()</h3><p>获取所有资源请求的时间数据,这个函数返回一个按startTime排序的对象数组，数组成员除了会自动根据所请求资源的变化而改变以外，还可以用mark(),measure()方法自定义添加。</p><p><img src="https://images-1256612942.cos.ap-guangzhou.myqcloud.com/2022_03_13_mEoMw0.png" alt="2022_03_13_mEoMw0"></p><p>该对象的属性中除了包含资源加载时间还有以下五个属性。</p><ul><li><code>name</code>：资源名称，是资源的绝对路径或调用mark方法自定义的名称</li><li><code>startTime</code>:开始时间</li><li><code>duration</code>：加载时间</li><li><code>entryType</code>：资源类型，entryType类型不同数组中的对象结构也不同！具体见下</li><li><code>initiatorType</code>：谁发起的请求，具体见下</li></ul><p><strong>entryType</strong>的值:</p><table><thead><tr><th>值</th><th>该类型对象</th><th>描述</th></tr></thead><tbody><tr><td>mark</td><td>PerformanceMark</td><td>通过mark()方法添加到数组中的对象</td></tr><tr><td>measure</td><td>PerformanceMeasure</td><td>通过measure()方法添加到数组中的对象</td></tr><tr><td>paint</td><td>PerformancePaintTiming</td><td>值为first-paint&#39;首次绘制、&#39;first-contentful-paint&#39;首次内容绘制。</td></tr><tr><td>resource</td><td>PerformanceResourceTiming</td><td>所有资源加载时间，用处最多</td></tr><tr><td>navigation</td><td>PerformanceNavigationTiming</td><td>现除chrome和Opera外均不支持，导航相关信息</td></tr><tr><td>frame</td><td>PerformanceFrameTiming</td><td>现浏览器均未支持</td></tr></tbody></table><p><strong>initiatorType</strong>的值：</p><table><thead><tr><th>发起对象</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>a Element</td><td><code>link</code>/<code>script</code>/<code>img</code>/<code>iframe</code>等</td><td>通过标签形式加载的资源，值是该节点名的小写形式</td></tr><tr><td>a CSS resourc</td><td><code>css</code></td><td>通过css样式加载的资源，比如background的url方式加载资源</td></tr><tr><td>a XMLHttpRequest object</td><td><code>xmlhttprequest</code>/<code>fetch</code></td><td>通过xhr加载的资源</td></tr><tr><td>a PerformanceNavigationTiming object</td><td><code>navigation</code></td><td>当对象是PerformanceNavigationTiming时返回</td></tr></tbody></table><p><strong>请注意：</strong></p><ol><li>目前通过<code>&lt;audio&gt;</code>，<code>&lt;video&gt;</code>加载资源,initiatorType还无法返回&quot;audio&quot;和&quot;video&quot;，chrome中只能返回空字符串,firfox返回&quot;other&quot;。</li><li>如果一个图片在页面内既用img引入，又作为背景图片引入，那么initiatorType返回的&quot;img&quot;。</li><li>使用该方法统计资源信息的时候首先可以合理利用clearResourceTimings清除已统计过的对象避免重复统计，其次要过滤掉因上报统计数据而产生的对象。</li></ol><h3 id="getentriesbyname-name-type-optional-getentriesbytype-type" tabindex="-1"><a class="header-anchor" href="#getentriesbyname-name-type-optional-getentriesbytype-type" aria-hidden="true">#</a> getEntriesByName(name,type[optional])，getEntriesByType(type)</h3><ul><li><code>name</code>:想要筛选出的资源名。</li><li><code>type</code>:entryType的值中一个。</li></ul><p>返回值仍是一个数组，这个数组相当于getEntries()方法经过所填参数筛选后的一个子集</p><h3 id="clearresourcetimings" tabindex="-1"><a class="header-anchor" href="#clearresourcetimings" aria-hidden="true">#</a> clearResourceTimings()</h3><p>该方法无参数无返回值，可以清楚目前所有entryType为&quot;resource&quot;的数据，用于写单页应用的统计脚本非常有用。</p><h3 id="mark-name-measure-name-startmark-endmark-clearmarks-clearmeasures" tabindex="-1"><a class="header-anchor" href="#mark-name-measure-name-startmark-endmark-clearmarks-clearmeasures" aria-hidden="true">#</a> mark(name), measure(name, startMark, endMark), clearMarks(), clearMeasures()</h3><p>用于做标记和清除标记，供用户自定义统计一些数据，比如某函数运行耗时等</p><ul><li><p><code>name</code>:自定义的名称，<strong>不要和getEntries()返回的数组中其他name重复</strong>。</p></li><li><p><code>startMark</code>:作为开始时间的标记名称或PerformanceTiming的一个属性。</p></li><li><p><code>endMark</code>:作为结束时间的标记名称或PerformanceTiming的一个属性。</p></li><li><p>创建标记：mark(name)；</p></li><li><p>记录两个标记的时间间隔：measure(name, startMark, endMark);</p></li><li><p>清除指定标记：window.performance.clearMarks(name);</p></li><li><p>清除所有标记：window.performance.clearMarks();</p></li><li><p>清除指定记录间隔数据：window.performance.clearMeasures(name);</p></li><li><p>清除所有记录间隔数据：window.performance.clearMeasures();</p></li></ul><h3 id="now" tabindex="-1"><a class="header-anchor" href="#now" aria-hidden="true">#</a> now()</h3><p>performance.now()是当前时间与performance.timing.navigationStart的时间差，以微秒（百万分之一秒）为单位的时间，与 Date.now()-performance.timing.navigationStart的区别是不受系统程序执行阻塞的影响，因此更加精准。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: czl624824554@163.com">chenzilin</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/blogs/assets/app.7d2acf8d.js" defer></script>
  </body>
</html>
